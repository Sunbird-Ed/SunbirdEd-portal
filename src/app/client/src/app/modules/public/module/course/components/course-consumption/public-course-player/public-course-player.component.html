<div class="ui container mt-24">
  <div *ngIf="!loader">
    <div class="course-player" [appTelemetryImpression]="telemetryCourseImpression">
      <!-- Header Section-->
      <div class="sb-pageSection course-player--header text-left">
        <div class="sb-pageSection-header">
          <h4 class="sb-pageSection-title sb-pageSection-title-light">
            {{resourceService?.frmelmnts?.lbl?.aboutthecourse}}</h4>
        </div>
        <div class="sb-pageSection-content">
          <div *ngIf="courseHierarchy?.description">
            <p *ngIf="!readMore">
              {{ courseHierarchy?.description | slice:0:200 }}&nbsp;
              <span class="ui cardsKnowMore mouse-pointer"
                *ngIf="courseHierarchy?.description?.length > 200 && readMore === false"
                (click)="readMore = !readMore;">{{resourceService?.frmelmnts?.lbl?.readmore}}</span>
            </p>
            <p *ngIf="readMore">
              {{ courseHierarchy?.description}}&nbsp;
              <span class="ui cardsKnowMore mouse-pointer"
                (click)="readMore = false;">{{resourceService?.frmelmnts?.lbl?.readless}}</span>
            </p>
          </div>
        </div>
      </div>
      <!-- Card Section -->
      <div class="course-player--card text-left">
        <app-public-batch-details [courseId]="courseId" [courseHierarchy]="courseHierarchy"
          (allBatchDetails)="getAllBatchDetails($event)">
        </app-public-batch-details>
      </div>
      <!-- Content Section -->
      <div class="course-player--content text-left">
        <h4 class="sb-pageSection-title sb-pageSection-title-light">
          {{resourceService?.frmelmnts?.lbl?.coursestructure}}</h4>
        <div *ngFor="let item of courseHierarchy?.children; let index = index">
          <div class="d-flex flex-ai-center flex-jc-space-between py-8">
            <h5 class="course-list_title py-8 ellipsis mr-16">{{item?.name}}</h5>
            <button (click)="showJoinTrainingModal = true; logTelemetry('start-course', item)"
              class="sb-btn sb-btn-outline-secondary sb-btn-normal flex-none ml-8">{{resourceService?.frmelmnts?.btn?.start}}</button>
          </div>
          <div class="chapter-box sb-g">
            <section class="sb-g-col-xs-12 sb-g-col-md-12 sb-g-col-lg-12">
              <sb-toc-curriculum
                *ngIf="item?.mimeType === 'application/vnd.ekstep.content-collection' && item?.children?.length; else noContent"
                [tocData]="item" [isAccordion]="true" [type]="cardType"
                (tocCardClick)="navigateToContent($event, 'curriculum-card')">
              </sb-toc-curriculum>
              <sb-toc-card [content]="item" *ngIf="item?.mimeType !== 'application/vnd.ekstep.content-collection'"
                (tocCardClick)="navigateToContent($event, 'toc-card')" [type]="cardType">
              </sb-toc-card>
              <ng-template #noContent>
                <div class="heading">{{resourceService?.messages?.stmsg?.m0121}}</div>
              </ng-template>
            </section>
          </div>
        </div>
      </div>
      <!-- Metadata Section -->
      <div class="course-player--metadata text-left">
        <app-course-info [courseHierarchy]="courseHierarchy"></app-course-info>
      </div>
    </div>

  </div>
  <div *ngIf="loader">
    <app-loader [data]="loaderMessage"></app-loader>
  </div>
</div>

<sui-modal [mustScroll]="true" [isClosable]="true" [transitionDuration]="0" [size]="'small'" class="sb-modal"
  appBodyScroll (dismissed)="showJoinTrainingModal = false; logTelemetry('join-training-popup-close')"
  *ngIf="showJoinTrainingModal" #joinTrainingModal>
  <div class="sb-modal-header">
    {{resourceService?.frmelmnts?.btn?.enroll}}
  </div>
  <div class="sb-modal-content">
    <div class="ui center aligned segment">
      <p>{{resourceService?.frmelmnts?.lbl?.joinTrainingToAcessContent}}</p>
    </div>
  </div>
</sui-modal>

<app-share-link [shareLink]="shareLink" [telemetryShareData]="telemetryShareData" *ngIf="shareLinkModal"
  (close)="closeSharePopup('close-share-link-popup')">
</app-share-link>