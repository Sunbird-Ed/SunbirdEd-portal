
<div *ngIf='programDetails?.userDetails' class="ui pointing secondary menu sb-bg-white">
  <div class="ui container">
    <a class="item active" *ngIf='programDetails?.userDetails?.roles.includes("CONTRIBUTOR")' [class.active]="selectedAttributes.currentRole === 'CONTRIBUTOR'"
      (click)="selectedAttributes.currentRole = 'CONTRIBUTOR';handleRoleChange()">Contribute</a>
    <a class="item" *ngIf='programDetails?.userDetails?.roles.includes("REVIEWER")'
      [class.active]="selectedAttributes.currentRole === 'REVIEWER'" (click)="selectedAttributes.currentRole = 'REVIEWER';handleRoleChange()">Review</a>
    <a class="item" *ngIf='programDetails?.userDetails?.roles.includes("PUBLISHER")'
      [class.active]="selectedAttributes.currentRole === 'PUBLISHER'" (click)="selectedAttributes.currentRole = 'PUBLISHER';handleRoleChange()">Publish</a>
  </div>
</div>

<div *ngIf='programDetails?.userDetails' class="ui segment no-bg m-0 w-300" style="margin-top:2px !important;">

  <div *ngIf="stages[currentStage] === 'chooseClass'">
    <app-select-textbook [selectedAttributes]="selectedAttributes" [config]="programDetails.config"
      (selectedClassSubjectEvent)="selectedClassSubjectHandler($event)"></app-select-textbook>
  </div>

  <div class="ui container" *ngIf="stages[currentStage] === 'chooseTextbook' || stages[currentStage] === 'topicList' ">
      <div class="sb-pageSection">
        <div class="sb-pageSection-header d-flex flex-jc-space-between">
          <div>
              <span class="fs-1-143 font-weight-bold m-0 mr-8">Searched results for </span>
              <span
                class="sb-pageSection-count sb-label sb-label-xs sb-label-warning mr-8">{{selectedAttributes.gradeLevel}}</span>
              <span
                class="sb-pageSection-count sb-label sb-label-xs sb-label-warning">{{selectedAttributes.subject}}</span>
          </div>
          <div *ngIf="stages[currentStage] === 'topicList' && role.currentRole === 'REVIEWER'">
            <div *ngFor="let field of formFieldOptions">
                <div *ngIf="field.inputType ==='select' && field.code === 'school'" class="field d-flex flex-jc-center flex-ai-center">
                  <label class="mr-8 mb-0">Select {{field.label}}</label>
                  <div class="field">
                    <sui-select [isSearchable]="true" id={{field.code}} name={{field.code}} class="selection" 
                      [(ngModel)]="selectedSchoolForReview" labelField="name" valueField="name"
                      [options]="field.range" #select>
                      <sui-select-option *ngFor="let option of select.filteredOptions" [value]="option"></sui-select-option>
                    </sui-select>
                  </div>
                </div>
              </div> 
          </div>      
          <button (click)="navigate('prev')" 
          appTelemetryInteract [telemetryInteractEdata]="{id:'back_btn',type:'click',pageid:stages[currentStage].toLowerCase()}"
          class="sb-btn sb-btn-xs sb-btn-error">Back <i class="chevron circle left icon"></i></button>
        </div>
      </div>
      <div *ngIf="stages[currentStage] === 'chooseTextbook'">
          <app-textbook-list [selectedAttributes]="selectedAttributes" [config]="programDetails.config"
            (selectedTextbookEvent)="selectedTextbookHandler($event)"></app-textbook-list>
        </div>
        <div *ngIf="stages[currentStage] === 'topicList'">
            <app-chapter-list [topicList]="topicList" [selectedAttributes]="selectedAttributes" [selectedSchool]="selectedSchoolForReview" [role]="role"
            (selectedQuestionTypeTopic)="selectedQuestionTypeTopic($event)"></app-chapter-list>
        </div>
    </div>


    <div class="ui container" *ngIf="stages[currentStage] === 'createQuestion'">
        <div class="sb-pageSection">
            <div class="sb-pageSection-header d-flex flex-jc-space-between">
              <div>
                <span class="fs-1-143 font-weight-bold m-0 mr-8">Searched results for</span>
                <span class="sb-pageSection-count sb-label sb-label-xs sb-label-warning">{{selectedAttributes.topic}}</span>
              </div>
              <div *ngIf="stages[currentStage] === 'createQuestion' && role.currentRole === 'REVIEWER' && selectedSchoolForReview !== undefined" 
              class="field d-flex flex-jc-center flex-ai-center">
                <span><b>Selected School:</b> <span style="font-style: italic">{{selectedSchoolForReview}}</span></span>
              </div>
              <button (click)="navigate('prev')" 
              appTelemetryInteract [telemetryInteractEdata]="{id:'back_btn',type:'click',pageid:stages[currentStage].toLowerCase()}"
              class="sb-btn sb-btn-xs sb-btn-error">Back <i class="chevron circle left icon"></i></button>
            </div>
        </div>
      <app-question-list (statusEmitter)="handleRefresEvent($event)" [selectedAttributes]="selectedAttributes" [role]="role" (changeStage)="changeStageOnDiscard($event)"></app-question-list>
    </div>
