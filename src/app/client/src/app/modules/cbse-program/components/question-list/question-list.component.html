<div>
  <sui-modal *ngIf="!selectedAttributes.questionType" [mustScroll]="true" [isClosable]="true" [transitionDuration]="0" [size]="'small'" class="sb-modal"
    appBodyScroll (dismissed)="selectedAttributes.questionType; dismissPublishModal();" #modal>
    <div class="sb-modal-header">
      Select Question Category
    </div>
    <div class="sb-modal-content">
      <ul>
        <li (click)="selectQuestionCategory(contentType)" *ngFor="let contentType of templateDetails.questionCategories">
          {{contentType}}
        </li>
      </ul>
    </div>
  </sui-modal>
</div>


<div *ngIf="selectedAttributes?.questionType" class="ui twelve column grid p-0 m-0">
  <div class="three wide column p-0 pr-16">
    <div class="ui questionsMenu">
      <button *ngIf="role.currentRole === 'CONTRIBUTOR'" [disabled]="questionMetaData && questionMetaData.mode === 'create'"
        (click)="createNewQuestion()" appTelemetryInteract
        [telemetryInteractEdata]="{id:'create_btn',type:'click',pageid:'questionlist',extra:{type:'reference',category:selectedAttributes.questionType.toUpperCase(),topic:selectedAttributes.topic}}"
        class="sb-btn sb-btn-primary sb-btn-normal width-100">Create</button>

        <div class="d-flex flex-ai-center" *ngIf="role.currentRole === 'PUBLISHER'">
          <div class="sb-checkbox sb-checkbox-primary">
            <input type="checkbox" [(ngModel)]="selectedAll" appTelemetryInteract [telemetryInteractEdata]="{id:'select_all_questions',type:'click',pageid:'questionlist'}"
            (change)="selectAll();">
            <label for="check1">Select All</label>
          </div>
        </div>
      <div class="ui vertical segments" style="max-height:50vh;overflow-y:auto;">
        <div class="questionTab ui center tertiary header aligned segment p-8"
          [class.tertiary]="selectedQuestionId === question.identifier"
          (click)="handleQuestionTabChange(question.identifier)" *ngFor="let question of questionList; let i = index"
          appTelemetryInteract
          [telemetryInteractEdata]="{id:'question_tab',type:'click',pageid:'questionlist',extra:{type:'reference',identifier:question.identifier}}">
          <div class="item d-flex flex-ai-center">
            <ng-container *ngIf="role.currentRole === 'PUBLISHER' else nonPublisher">
              <div class="sb-checkbox sb-checkbox-primary">
                <input class="checking" [(ngModel)]="question.isSelected" (change)="checkIfAllSelected(question);" (click)="$event.stopPropagation()" type="checkbox">
                <label for="check1" class="mb-0"> Question {{i + 1}}</label>
              </div>
            </ng-container>
            <ng-template #nonPublisher>
              <div>
                <label for="check1" class="mb-0 fs-0-92 font-weight-normal"> Question {{i + 1}}</label>
              </div>
            </ng-template>
            <!-- <i class="trash alternate outline icon ml-auto d-flex flex-ai-center"></i> -->
            <span class="sb-status-label sb-bg-warning sb-shape-circle ml-auto"
              *ngIf="question.status === 'Draft' || question.status === 'Review'"></span>
            <!-- <span class="sb-status-label sb-bg-success sb-shape-circle ml-auto"
              *ngIf="question.status === 'Live'"></span> -->
            <span class="sb-status-label sb-bg-error sb-shape-circle ml-auto"
              *ngIf="question.status === 'Reject'"></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="nine wide column bg-white p-0">
    <div *ngIf="!questionList.length && questionMetaData?.mode !== 'create' && role.currentRole === 'CONTRIBUTOR'"
      class="ui segment">No Question - Click
      Create</div>
    <div *ngIf="!questionList.length && role.currentRole === 'REVIEWER'" class="ui segment">No Questions for Review
    </div>
    <div *ngIf="(questionList.length || questionMetaData?.mode === 'create')&& refresh">
      <div *ngIf="selectedAttributes.questionType === 'mcq'" class="ui segment">
          <div [hidden]="showLoader">
        <app-mcq-creation [selectedAttributes]="selectedAttributes" [questionMetaData]="questionMetaData" [questionSelectionStatus]="questionSelectionStatus"
        [role]="role" (questionStatus)="questionStatusHandler($event)" (questionQueueStatus)="questionQueueStatusHandler($event)"></app-mcq-creation>
          </div>
      </div>
      <div *ngIf="selectedAttributes.questionType !== 'mcq'" class="ui segment">
        <div [hidden]="showLoader">
        <app-question-creation [selectedAttributes]="selectedAttributes" [questionMetaData]="questionMetaData" [questionSelectionStatus]="questionSelectionStatus"
          [role]="role" (questionStatus)="questionStatusHandler($event)" (questionQueueStatus)="questionQueueStatusHandler($event)">
        </app-question-creation>
        </div>
      </div>
    </div>
    <app-loader *ngIf='showLoader'></app-loader>
  </div>
</div>

<sui-modal
  *ngIf="showSuccessModal"
  [mustScroll]="true"
  [isClosable]="true"
  [transitionDuration]="0"
  [size]="'small'"
  class="sb-modal"
  appBodyScroll
  (dismissed)="showSuccessModal = !showSuccessModal; dismissPublishModal();"
  #modal>
  <div class="sb-modal-header">
    Practice Set Successfully Published
  </div>
  <div class="sb-modal-content">
    <p>Name : {{resourceName}} </p>
    <p>Board : {{selectedAttributes.board}} </p>
    <p>Medium : {{selectedAttributes.medium}} </p>
    <p>Class : {{selectedAttributes.gradeLevel}} </p>
    <p>Subject : {{selectedAttributes.subject}} </p>
    <p>ResourceID : {{publishedResourceId}} </p>
    Preview Link : <a target="_blank" href="https://diksha.gov.in/play/content/{{publishedResourceId}}">Click here</a>
  </div>

  <div class="sb-modal-actions">
    <button class="sb-btn sb-btn-normal sb-btn-outline-primary" (click)="showSuccessModal = !showSuccessModal; dismissPublishModal();">
      Close
    </button>
  </div>
  </sui-modal>
