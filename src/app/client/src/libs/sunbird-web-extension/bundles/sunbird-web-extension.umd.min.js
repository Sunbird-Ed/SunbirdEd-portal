!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("sunbird-web-extension",["exports","@angular/core","rxjs","@angular/common"],t):t(n["sunbird-web-extension"]={},n.ng.core,n.rxjs,n.ng.common)}(this,function(n,c,t,e){"use strict";var i=function(n){this.name=n.name,this.priority=n.priority,this.component=n.component},s=function(n,t){this.plugin=n,this.placement=t};var o=function(){function n(){this.plugins=[],this.change=new t.ReplaySubject(1)}return n.prototype.loadPlugins=function(n){if(!n||!Array.isArray(n.plugins))throw new Error("invalid framework configuration! Failed to load plugins!");var t,e,i=n.plugins.map(function(n){return n.main});try{for(var o=function(n){var t="function"==typeof Symbol&&n[Symbol.iterator],e=0;return t?t.call(n):{next:function(){return n&&e>=n.length&&(n=void 0),{value:n&&n[e++],done:!n}}}}(i),r=o.next();!r.done;r=o.next()){var u=r.value;this.loadPlugin(u)}}catch(c){t={error:c}}finally{try{r&&!r.done&&(e=o["return"])&&e.call(o)}finally{if(t)throw t.error}}},n.prototype.loadPlugin=function(n){var t={type:n,config:n._pluginConfig,instance:new n};this.plugins=this.plugins.concat([t]),this.change.next(this.plugins)},n.prototype.removePlugin=function(t){var n=this.plugins.find(function(n){return n.config.name===t});if(n){var e=this.plugins.slice();e.splice(e.indexOf(n),1),this.plugins=e,this.change.next(this.plugins)}},n.prototype.getPluginData=function(e){return this.plugins.reduce(function(n,t){return n.concat(t.config.placements.filter(function(n){return n.name===e}).map(function(n){return new s(t,n)}))},[])},n.decorators=[{type:c.Injectable}],n.ctorParameters=function(){return[]},n}(),r=function(){function n(n,t,e){var i=this;this.override=!1,this.output=new c.EventEmitter,this.componentRefs=[],this.viewContainerRef=n,this.componentResolver=t,this.pluginService=e,this.pluginChangeSubscription=this.pluginService.change.subscribe(function(n){return i.initialize()})}return n.prototype.ngOnInit=function(){this.initialize()},n.prototype.initialize=function(){var t=this;if(this.name){var n=this.pluginService.getPluginData(this.name);return this.override?(n.sort(function(n,t){return n.placement.priority>t.placement.priority?1:n.placement.priority<t.placement.priority?-1:0}),this.instantiatePluginComponent(n.shift())):(n.sort(function(n,t){return n.placement.priority>t.placement.priority?1:n.placement.priority<t.placement.priority?-1:0}),Promise.all(n.map(function(n){return t.instantiatePluginComponent(n)})))}},n.prototype.instantiatePluginComponent=function(n){var t=this;if(n){var e=this.componentResolver.resolveComponentFactory(n.placement.component),i=this.viewContainerRef.parentInjector,o=[{provide:s,useValue:n}],r=c.ReflectiveInjector.resolveAndCreate(o,i),u=this.viewContainerRef.createComponent(e,this.viewContainerRef.length,r);return u.instance.input=this.input,u.instance.output=u.instance.output||new c.EventEmitter,u.instance.output.subscribe(function(n){return t.output.emit(n)}),this.componentRefs.push(u),u.changeDetectorRef.markForCheck(),u.changeDetectorRef.detectChanges(),u}},n.prototype.ngOnChanges=function(){var t=this;0<this.componentRefs.length&&this.componentRefs.forEach(function(n){return n.instance.input=t.input,n.instance.ngOnChanges?n.instance.ngOnChanges():undefined})},n.prototype.ngOnDestroy=function(){0<this.componentRefs.length&&(this.componentRefs.forEach(function(n){return n.destroy()}),this.componentRefs=[]),this.pluginChangeSubscription.unsubscribe()},n.decorators=[{type:c.Directive,args:[{selector:"extension-point"}]}],n.ctorParameters=function(){return[{type:c.ViewContainerRef},{type:c.ComponentFactoryResolver},{type:o}]},n.propDecorators={name:[{type:c.Input}],override:[{type:c.Input}],input:[{type:c.Input}],output:[{type:c.Output}]},n}(),u=function(){function n(n){this.pluginService=n}return n.prototype.initialize=function(n){this.config=n,this.pluginService.loadPlugins(this.config)},n.decorators=[{type:c.Injectable}],n.ctorParameters=function(){return[{type:o}]},n}(),a=function(){function n(){}return n.forRoot=function(){return{ngModule:n,providers:[o,u]}},n.decorators=[{type:c.NgModule,args:[{declarations:[r],imports:[e.CommonModule],exports:[r]}]}],n}();n.WebExtensionModule=a,n.BootstrapFramework=u,n.ExtensionPointDirective=r,n.PluginConfig=function(t){return function(n){n._pluginConfig=t}},n.PluginPlacement=i,n.PluginData=s,n.PluginService=o,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=sunbird-web-extension.umd.min.js.map