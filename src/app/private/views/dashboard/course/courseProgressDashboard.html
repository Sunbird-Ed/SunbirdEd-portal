<div ng-controller="courseDashboardCtrl as courseDashboard" ng-init="courseDashboard.loadData()">
  <div ng-include="'views/dashboard/course/courseDashboardFilters.html'"></div>
  <div class="table-data-holder" ng-hide="courseDashboard.showLoader || courseDashboard.isMultipleCourses || courseDashboard.showWarningMsg" ng-if="!courseDashboard.showError">
    <div class="ui raised segment">
      <div class="eight wide column right floated dashBoardCardText">
        <h3>{{courseDashboard.filterQueryTextMsg}}</h3>
      </div>
      <table class="ui very basic courseDashBoardTable table">
        <thead>
          <tr>
            <th class="table-headerDashboard">
              <a href="Javascript:void(0);" ng-click="courseDashboard.orderByField='progress'; courseDashboard.reverseSort = !courseDashboard.reverseSort">{{$root.labels.DASHBOARD.COMMON.SORT_BY.STATUS}}
                <span ng-show="courseDashboard.orderByField == 'progress'">
                  <span ng-show="!courseDashboard.reverseSort">^</span>
                  <span ng-show="courseDashboard.reverseSort">v</span>
                </span>
              </a>
            </th>
            <th>
              <a href="Javascript:void(0);" ng-click="courseDashboard.orderByField='user'; courseDashboard.reverseSort = !courseDashboard.reverseSort">
              {{$root.labels.DASHBOARD.COMMON.SORT_BY.USER_NAME}}
                <span ng-show="courseDashboard.orderByField == 'user'">
                  <span ng-show="!courseDashboard.reverseSort">^</span>
                  <span ng-show="courseDashboard.reverseSort">v</span>
                </span>
              </a>
            </th>
            <th>
              <a href="Javascript:void(0);" ng-click="courseDashboard.orderByField='batchEndsOn'; courseDashboard.reverseSort = !courseDashboard.reverseSort">{{$root.labels.DASHBOARD.COMMON.SORT_BY.BATCH_END}}
                <span ng-show="courseDashboard.orderByField == 'batchEndsOn'">
                  <span ng-show="!courseDashboard.reverseSort">^</span>
                  <span ng-show="courseDashboard.reverseSort">v</span>
                </span>
              </a>
            </th>
            <th>
              <a href="Javascript:void(0);" ng-click="courseDashboard.orderByField='org'; courseDashboard.reverseSort = !courseDashboard.reverseSort">{{$root.labels.DASHBOARD.COMMON.SORT_BY.ORG}}
                <span ng-show="courseDashboard.orderByField == 'org'">
                  <span ng-show="!courseDashboard.reverseSort">^</span>
                  <span ng-show="courseDashboard.reverseSort">v</span>
                </span>
              </a>
            </th>
            <th>
              <a href="Javascript:void(0);" ng-click="courseDashboard.orderByField='enrolledOn'; courseDashboard.reverseSort = !courseDashboard.reverseSort">{{$root.labels.DASHBOARD.COMMON.SORT_BY.ENROLLED_ON}}
                <span ng-show="courseDashboard.orderByField == 'enrolledOn'">
                  <span ng-show="!courseDashboard.reverseSort">^</span>
                  <span ng-show="courseDashboard.reverseSort">v</span>
                </span>
              </a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="student in courseDashboard.courseProgressArray|orderBy:courseDashboard.orderByField:courseDashboard.reverseSort | filter:courseDashboard.searchUser">
            <!-- If course progress is 100%-->
            <td ng-if="student.progress === 100">{{$root.labels.DASHBOARD.COURSE.PROGRESS_DASHBOARD.BATCH_DONE_STATUS}}</td>
            <td class="ui green header text-font" ng-if="(student.progress !== 100 && student.progress > 90)">{{student.progress}}%</td>
            <td class="ui orange header text-font" ng-if="(student.progress !== 100 && student.progress > 30)">{{student.progress}}%</td>
            <td class="ui red header text-font" ng-if="(student.progress !== 100 && student.progress < 30)">{{student.progress}}%</td>
            <td>{{student.userName}}
              <br>Last login: {{student.lastAccessTime | dateFilterWithMDY}}
            </td>
            <td>{{student.batchEndsOn | dateFilterWithMDY}}</td>
            <td>{{student.org}}</td>
            <td>{{student.enrolledOn | dateFilterWithMDY}}</td>
          </tr>
          <tr ng-show="courseDashboard.courseProgressArray.length == 0">
            <td id="noRecordsFound">{{$root.labels.DASHBOARD.COURSE.PROGRESS_DASHBOARD.NO_DATA_MSG}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <!--<div class="ui grid margin-top-20" ng-hide="courseDashboard.courseProgressArray.length == 0">
        <div class="twelve wide column right floated">
            <p class="text-align-right dashBoardCardText">Download this view as:
              <a href="Javascript:void(0);" class="item text-decoration-underline padding-left-10 cursor-pointer">CSV</a>
            </p>
        </div>
    </div>-->
  </div>
  <!-- Show loader-->
  <div class="tweleve wide column" ng-if="courseDashboard.showLoader">
    <app-loader></app-loader>
  </div>
  <div class="ui negative message" ng-hide="courseDashboard.showWarningMsg" ng-if="courseDashboard.showError && !courseDashboard.showLoader">
    <div class="header">{{courseDashboard.errorLbl}}</div>
    <p>{{courseDashboard.errorMsg}}</p>
  </div>
  <div class="ui info message tweleve wide column" ng-show="courseDashboard.isMultipleCourses">
    <div class="header">{{$root.labels.DASHBOARD.COURSE.PROGRESS_DASHBOARD.BATCH_NOT_SELECTED}}</div>
    {{$root.labels.DASHBOARD.COURSE.PROGRESS_DASHBOARD.BATCH_NOT_SELECTED_MSG}}
  </div>
  <div class="ui grid" ng-if="courseDashboard.showWarningMsg">
    <div class="twelve wide column">
      <a class="ui item basic icon circular float-ContentRight" href="Javascript:void(0);" data-tooltip="Close the dashboard"><i class="ui remove icon CloseButtonFont" ng-click="toc.showCourseDashboard = false;courseDashboard.resetDropdown();"></i>
      </a>
    </div>
    <div class="twelve wide column">
      <div class="ui info message">
        <div class="header">{{$root.labels.DASHBOARD.COURSE.LIST_EMPTY_LBL}}</div>
        <ul class="list">
          <li>{{$root.labels.DASHBOARD.COURSE.PROGRESS_DASHBOARD.LIST_EMPTY_MSG}}</li>
        </ul>
      </div>
    </div>
  </div>
</div>
