!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=28)}([function(t,e){t.exports=require("util")},function(t,e,n){"use strict";const r=n(0),o=n(3),i=Object.freeze({});function s(){}const a=Buffer.alloc||function(t){const e=l(t);return e.fill(0),e},c=Buffer.allocUnsafe||l,u=Int8Array.from!==Buffer.from&&Buffer.from||function(t,e){if("string"!=typeof t)throw new TypeError("Expected string, obtained "+r.inspect(t));return new Buffer(t,e)},h=Int8Array.from!==Buffer.from&&Buffer.from||function(t){if(!Array.isArray(t))throw new TypeError("Expected Array, obtained "+r.inspect(t));return new Buffer(t)};function l(t){return new Buffer(t)}function p(t,e,n){let r=0,o=t.length-1;for(;r<=o;){const i=r+o>>>1,s=n(t[i],e);if(s<0)r=i+1;else{if(!(s>0))return i;o=i-1}}return~r}function f(t){return new Promise(function(e,n){t(function(t,r){if(t)return n(t);e(r)})})}function d(){this.length=0,this.items={}}function m(t,e,n,r){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");r=r||s;const o=t.length;if(0===o)return r(null,[]);const i=new Array(o);let a=0;const c=n?function(n){e(t[n],n,function(t,e){i[n]=e,u(t)})}:function(n){e(t[n],function(t,e){i[n]=e,u(t)})};for(let t=0;t<o;t++)c(t);function u(t){if(t){const e=r;return r=s,void e(t)}++a===o&&r(null,i)}}d.prototype.add=function(t){return!this.items[t]&&(this.items[t]=!0,this.length++,!0)},d.prototype.contains=function(t){return!0===this.items[t]},d.prototype.toArray=function(){return Object.keys(this.items)},e.adaptNamedParamsPrepared=function(t,e){if(!t||r.isArray(t)||!e||0===e.length)return t;const n=new Array(e.length);t=function(t){const e=Object.keys(t),n={};for(let r=0;r<e.length;r++){const o=e[r];n[o.toLowerCase()]=t[o]}return n}(t);const i={};for(let s=0;s<e.length;s++){const a=e[s].name;if(!t.hasOwnProperty(a))throw new o.ArgumentError(r.format('Parameter "%s" not defined',a));n[s]=t[a],i[a]=s}return n},e.adaptNamedParamsWithHints=function(t,e){if(!t||r.isArray(t))return{params:t,namedParameters:!1,keyIndexes:null};const n=Object.keys(t),o=new Array(n.length),s=new Array(n.length),a=e.hints||i,c={};for(let e=0;e<n.length;e++){const r=n[e];o[e]={name:r.toLowerCase(),value:t[r]},s[e]=a[r],c[r]=e}return e.hints=s,{params:o,namedParameters:!0,keyIndexes:c}},e.allocBuffer=a,e.allocBufferUnsafe=c,e.allocBufferFromArray=h,e.allocBufferFromString=u,e.arrayIterator=function(t){let e=0;return{next:function(){return e>=t.length?{done:!0}:{value:t[e++],done:!1}}}},e.binarySearch=p,e.copyBuffer=function(t){const e=c(t.length);return t.copy(e),e},e.deepExtend=function t(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){for(const o in n){if(!n.hasOwnProperty(o))continue;const i=e[o],s=typeof i;!i||"number"===s||"string"===s||r.isArray(i)||r.isDate(i)||"Object"!==i.constructor.name?e[o]=n[o]:e[o]=t({},i,n[o])}}),e},e.each=function(t,e,n){if(!Array.isArray(t))throw new TypeError("First parameter is not an Array");n=n||s;const r=t.length;if(0===r)return n();let o=0;for(let n=0;n<r;n++)e(t[n],i);function i(t){if(t){const e=n;return n=s,void e(t)}++o===r&&n()}},e.eachSeries=function(t,e,n){if(!Array.isArray(t))throw new TypeError("First parameter is not an Array");n=n||s;const r=t.length;if(0===r)return n();let o,i=1;e(t[0],function s(a){return a?n(a):i>=r?n():(void 0===o&&(o=!0),o?process.nextTick(function(){e(t[i++],s)}):void e(t[i++],s))}),void 0===o&&(o=!1)},e.emptyArray=Object.freeze([]),e.emptyObject=i,e.extend=function(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){if(!e)return;const n=Object.keys(e);for(let r=0;r<n.length;r++){const o=n[r],i=e[o];void 0!==i&&(t[o]=i)}}),t},e.fixStack=function(t,e){return t&&(e.stack+="\n  (event loop)\n"+t.substr(t.indexOf("\n")+1)),e},e.forEachOf=function(t,e,n){return m(t,e,!0,n)},e.funcCompare=function(t,e){return function(n,r){if(void 0===n[t])return 0;const o=n[t].apply(n,e),i=r[t].apply(r,e);return o>i?1:o<i?-1:0}},e.insertSorted=function(t,e,n){if(0===t.length)return t.push(e);let r=p(t,e,n);r<0&&(r=~r),t.splice(r,0,e)},e.iteratorToArray=function(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e},e.log=function(t,e,n){if(!this.logEmitter){if(!this.options||!this.options.logEmitter)throw new Error("Log emitter not defined");this.logEmitter=this.options.logEmitter}this.logEmitter("log",t,this.constructor.name,e,n||"")},e.map=function(t,e,n){return m(t,e,!1,n)},e.mapSeries=function(t,e,n){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");n=n||s;const r=t.length;if(0===r)return n(null,[]);const o=new Array(r);let i,a=0;function c(s){e(t[s],function(t,e){o[s]=e,function(t){if(t)return n(t);if(++a===r)return n(null,o);void 0===i&&(i=!0);const e=a;if(i)return process.nextTick(function(){c(e)});c(a)}(t)})}c(0),void 0===i&&(i=!1)},e.maxInt=9007199254740992,e.noop=s,e.objectValues=function(t){if(!t)return e.emptyArray;const n=Object.keys(t),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=t[n[e]];return r},e.parallel=function(t,e){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");e=e||s;const n=t.length;let r=0;for(let e=0;e<n;e++)t[e](o);function o(t){if(t){const n=e;return e=s,n(t)}++r===n&&e()}},e.promiseWrapper=function(t,e,n){if("function"==typeof e)return void n.call(this,e);const r=this;return(t.promiseFactory||f)(function(t){n.call(r,t)})},e.propCompare=function(t){return function(e,n){return e[t]>n[t]?1:e[t]<n[t]?-1:0}},e.series=function(t,e){if(!Array.isArray(t))throw new TypeError("First parameter must be an Array");e=e||s;let n,r=0;!function o(i,s){return i?e(i):r===t.length?e(null,s):n?process.nextTick(function(){n=!0,t[r++](o),n=!1}):(n=!0,t[r++](o),void(n=!1))}()},e.stringRepeat=function(t,e){return!e||e<0?null:1===e?t:new Array(e+1).join(t)},e.times=function(t,e,n){if(n=n||s,t=+t,isNaN(t)||0===t)return n();let r=0;for(let n=0;n<t;n++)e(n,o);function o(e){if(e){const t=n;return n=s,t(e)}++r===t&&n()}},e.timesLimit=function(t,e,n,r){let o=void 0;r=r||s;let i,a=(e=Math.min(e,t))-1,c=0;for(i=0;i<e;i++)n(i,u);function u(e){if(e){const t=r;return r=s,void t(e)}if(++c===t)return r();if(!(++a>=t)){if(void 0===o&&(o=i>=0),o){const t=a;return process.nextTick(function(){n(t,u)})}n(a,u)}}i=-1},e.timesSeries=function(t,e,n){if(t=+t,isNaN(t)||t<1)return n();let r,o=1;e(0,function i(s){if(s)return n(s);if(o===t)return n();void 0===r&&(r=!0);const a=o++;if(r)return process.nextTick(function(){e(a,i)});e(a,i)}),void 0===r&&(r=!1)},e.totalLength=function(t){if(1===t.length)return t[0].length;let e=0;return t.forEach(function(t){let n=t.length;e+=n=n||0}),e},e.validateFn=function(t,e){if("function"!=typeof t)throw new o.ArgumentError(r.format("%s is not a function",e||"callback"));return t},e.whilst=function(t,e,n){let r=0;!function o(i){return i?n(i):t()?0===r?(r=1,e(function(t){1===r&&(r=4),o(t)}),void(1===r&&(r=2))):4===r?process.nextTick(function(){e(o)}):void e(o):n()}()},e.HashSet=d},function(t,e,n){"use strict";const r=n(0),o=n(3),i=n(33),s=n(13),a=n(34),c=n(1),u=n(6),h={any:0,one:1,two:2,three:3,quorum:4,all:5,localQuorum:6,eachQuorum:7,serial:8,localSerial:9,localOne:10},l={};l[h.any]="ANY",l[h.one]="ONE",l[h.two]="TWO",l[h.three]="THREE",l[h.quorum]="QUORUM",l[h.all]="ALL",l[h.localQuorum]="LOCAL_QUORUM",l[h.eachQuorum]="EACH_QUORUM",l[h.serial]="SERIAL",l[h.localSerial]="LOCAL_SERIAL",l[h.localOne]="LOCAL_ONE";const p={custom:0,ascii:1,bigint:2,blob:3,boolean:4,counter:5,decimal:6,double:7,float:8,int:9,text:10,timestamp:11,uuid:12,varchar:13,varint:14,timeuuid:15,inet:16,date:17,time:18,smallint:19,tinyint:20,list:32,map:33,set:34,udt:48,tuple:49,getByName:function(t){if((t=t.toLowerCase()).indexOf("<")>0){const e=/^(list|set)<(.+)>$/.exec(t);if(e)return{code:this[e[1]],info:this.getByName(e[2])};const n=/^(map)< *(.+) *, *(.+)>$/.exec(t);if(n)return{code:this[n[1]],info:[this.getByName(n[2]),this.getByName(n[3])]};const r=/^(udt)<(.+)>$/.exec(t);if(r)return{code:this[r[1]],info:r[2]};const o=/^(tuple)<(.+)>$/.exec(t);if(o)return{code:this[o[1]],info:o[2].split(",").map(function(t){return this.getByName(t.trim())},this)}}const e={code:this[t],info:null};if("number"!=typeof e.code)throw new TypeError("Data type with name "+t+" not valid");return e}},f=function(){const t={};for(const e in p){if(!p.hasOwnProperty(e))continue;const n=p[e];"number"==typeof n&&(t[n]=e)}return t}(),d=Object.freeze({unset:!0}),m=u.fromInt(1e3);let g=0;function y(t,e,n,r,o){this.version=t,this.flags=e,this.streamId=n,this.opcode=r,this.bodyLength=o}function w(t){w.super_.call(this,t,this.constructor),this.info="Represents an error that happens when the maximum amount of time for an operation passed."}y.size=function(t){return a.uses2BytesStreamIds(t)?9:8},y.getProtocolVersion=function(t){return 127&t[0]},y.fromBuffer=function(t,e){let n=0;e||(e=0);const r=127&t[e++],o=t.readUInt8(e++);return a.uses2BytesStreamIds(r)?(n=t.readInt16BE(e),e+=2):n=t.readInt8(e++),new y(r,o,n,t.readUInt8(e++),t.readUInt32BE(e))},y.prototype.toBuffer=function(){const t=c.allocBufferUnsafe(y.size(this.version));t.writeUInt8(this.version,0),t.writeUInt8(this.flags,1);let e=3;return a.uses2BytesStreamIds(this.version)?(t.writeInt16BE(this.streamId,2),e=4):t.writeInt8(this.streamId,2),t.writeUInt8(this.opcode,e++),t.writeUInt32BE(this.bodyLength,e),t},u.fromBuffer=function(t){if(!(t instanceof Buffer))throw new TypeError("Expected Buffer, obtained "+r.inspect(t));return new u(t.readInt32BE(4),t.readInt32BE(0))},u.toBuffer=function(t){if(!(t instanceof u))throw new TypeError("Expected Long, obtained "+r.inspect(t));const e=c.allocBufferUnsafe(8);return e.writeUInt32BE(t.getHighBitsUnsigned(),0),e.writeUInt32BE(t.getLowBitsUnsigned(),4),e},u.prototype.inspect=function(){return"Long: "+this.toString()},u.prototype.toJSON=function(){return this.toString()},r.inherits(function t(e){t.super_.call(this,e.message,this.constructor),this.internalError=e},o.DriverError),r.inherits(w,o.DriverError),e.opcodes={error:0,startup:1,ready:2,authenticate:3,credentials:4,options:5,supported:6,query:7,result:8,prepare:9,execute:10,register:11,event:12,batch:13,authChallenge:14,authResponse:15,authSuccess:16,isInRange:function(t){return t>this.error&&t>this.event}},e.consistencies=h,e.consistencyToString=l,e.dataTypes=p,e.getDataTypeNameByCode=function t(e){if(!e||"number"!=typeof e.code)throw new o.ArgumentError("Invalid signature type definition");const n=f[e.code];if(!n)throw new o.ArgumentError(r.format("Type with code %d not found",e.code));return e.info?r.isArray(e.info)?n+"<"+e.info.map(function(e){return t(e)}).join(", ")+">":"number"==typeof e.info.code?n+"<"+t(e.info)+">":n:n},e.distance={local:0,remote:1,ignored:2},e.frameFlags={compression:1,tracing:2,customPayload:4,warning:8},e.protocolEvents={topologyChange:"TOPOLOGY_CHANGE",statusChange:"STATUS_CHANGE",schemaChange:"SCHEMA_CHANGE"},e.protocolVersion=a,e.responseErrorCodes={serverError:0,protocolError:10,badCredentials:256,unavailableException:4096,overloaded:4097,isBootstrapping:4098,truncateError:4099,writeTimeout:4352,readTimeout:4608,readFailure:4864,functionFailure:5120,writeFailure:5376,syntaxError:8192,unauthorized:8448,invalid:8704,configError:8960,alreadyExists:9216,unprepared:9472},e.resultKind={voidResult:1,rows:2,setKeyspace:3,prepared:4,schemaChange:5},e.timeuuid=function(t,e,n){let o,s,a,u;t&&("number"==typeof t.msecs&&(o=new Date(t.msecs)),t.msecs instanceof Date&&(o=t.msecs),r.isArray(t.node)&&(a=c.allocBufferFromArray(t.node)),"number"==typeof t.clockseq&&(u=c.allocBufferUnsafe(2)).writeUInt16BE(t.clockseq,0),"number"==typeof t.nsecs&&(s=t.nsecs));const h=new i(o,s,a,u);return e instanceof Buffer?(h.getBuffer().copy(e,n||0),e):h.toString()},e.uuid=function(t,e,n){let o;return t&&r.isArray(t.random)&&(o=new s(c.allocBufferFromArray(t.random))),o||(o=s.random()),e instanceof Buffer?(o.getBuffer().copy(e,n||0),e):o.toString()},e.BigDecimal=n(36),e.Duration=n(37),e.FrameHeader=y,e.InetAddress=n(38),e.Integer=n(14),e.LocalDate=n(39),e.LocalTime=n(40),e.Long=u,e.ResultSet=n(41),e.ResultStream=n(42),e.Row=n(43),e.DriverError=o.DriverError,e.TimeoutError=w,e.TimeUuid=i,e.Tuple=n(44),e.Uuid=s,e.unset=d,e.generateTimestamp=function(t,e){t||(t=new Date);let n=u.ZERO;return"number"==typeof e&&e>=0&&e<1e3?n=u.fromInt(e):(g>999&&(g=0),n=u.fromInt(g),g++),u.fromNumber(t.getTime()).multiply(m).add(n)}},function(t,e,n){"use strict";const r=n(0);function o(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.info="Cassandra Driver Error",this.message=t}function i(t,e){if(o.call(this,e),this.innerErrors=t,this.info="Represents an error when a query cannot be performed because no host is available or could be reached by the driver.",!e&&(this.message="All host(s) tried for query failed.",t)){const e=Object.keys(t);if(e.length>0){const n=e[0];this.message+=r.format(" First host tried, %s: %s. See innerErrors.",n,t[n])}}}function s(t,e){o.call(this,e),this.code=t,this.info="Represents an error message from the server"}function a(t){o.call(this,t),this.info="Represents a bug inside the driver or in a Cassandra host."}function c(t){o.call(this,t),this.info="Represents an authentication error from the driver or from a Cassandra node."}function u(t){o.call(this,t),this.info="Represents an error that is raised when one of the arguments provided to a method is not valid."}function h(t){o.call(this,t,this.constructor),this.info="Represents a client-side error that is raised when the client did not hear back from the server within socketOptions.readTimeout"}function l(t){o.call(this,t,this.constructor),this.info="Represents a feature that is not supported in the driver or in the Cassandra version."}function p(t,e,n){const i=r.format("All connections to host %s are busy, %d requests are in-flight on %s",t,e,1===n?"a single connection":"each connection");o.call(this,i,this.constructor),this.info="Represents a client-side error indicating that all connections to a certain host have reached the maximum amount of in-flight requests supported (pooling.maxRequestsPerConnection)"}r.inherits(o,Error),r.inherits(i,o),r.inherits(s,o),r.inherits(a,o),r.inherits(c,o),r.inherits(u,o),r.inherits(h,o),r.inherits(l,o),r.inherits(p,o),e.ArgumentError=u,e.AuthenticationError=c,e.BusyConnectionError=p,e.DriverError=o,e.OperationTimedOutError=h,e.DriverInternalError=a,e.NoHostAvailableError=i,e.NotSupportedError=l,e.ResponseError=s},function(t,e){t.exports=require("events")},function(t,e,n){"use strict";const r=n(0),o=n(18).FrameWriter,i=n(2),s=n(1),a={values:1,skipMetadata:2,pageSize:4,withPagingState:8,withSerialConsistency:16,withDefaultTimestamp:32,withNameForValues:64},c={withSerialConsistency:16,withDefaultTimestamp:32,withNameForValues:64};class u{constructor(){}write(t,e){throw new Error("Method must be implemented")}clone(){const t=new this.constructor,e=Object.keys(this);for(let n=0;n<e.length;n++){const r=e[n];t[r]=this[r]}return t}}class h extends u{constructor(t,e,n,r,o){super(),this.query=t,this.queryId=e,this.params=n,this.meta=o,this.options=r||s.emptyObject,this.consistency=this.options.consistency||i.consistencies.one,this.namedParameters=!1}getParamType(t){const e=this.meta.columns[t];return e?e.type:null}write(t,e){const n=new o(i.opcodes.execute);let r=this.options.traceQuery?i.frameFlags.tracing:0;return this.options.customPayload&&(r|=i.frameFlags.customPayload,n.writeCustomPayload(this.options.customPayload)),n.writeShortBytes(this.queryId),this.writeQueryParameters(n,t),n.write(t.protocolVersion,e,r)}writeQueryParameters(t,e){let n=0;if(i.protocolVersion.supportsPaging(e.protocolVersion)&&(n|=this.params&&this.params.length?a.values:0,n|=this.options.fetchSize>0?a.pageSize:0,n|=this.options.pageState?a.withPagingState:0,n|=this.options.serialConsistency?a.withSerialConsistency:0,n|=this.options.timestamp?a.withDefaultTimestamp:0,n|=this.namedParameters?a.withNameForValues:0,t.writeShort(this.consistency),t.writeByte(n)),this.params&&this.params.length){t.writeShort(this.params.length);for(let r=0;r<this.params.length;r++){let o=this.params[r];n&a.withNameForValues&&(t.writeString(o.name),o=o.value),t.writeBytes(e.encode(o,this.getParamType(r)))}}if(!i.protocolVersion.supportsPaging(e.protocolVersion))return this.params&&this.params.length||t.writeShort(0),void t.writeShort(this.consistency);if(n&a.pageSize&&t.writeInt(this.options.fetchSize),n&a.withPagingState&&t.writeBytes(this.options.pageState),n&a.withSerialConsistency&&t.writeShort(this.options.serialConsistency),n&a.withDefaultTimestamp){let e=this.options.timestamp;"number"==typeof e&&(e=i.Long.fromNumber(e)),t.writeLong(e)}}}class l extends u{constructor(t,e){super(),this.queries=t,this.options=e,this.type=e.logged?0:1,this.type=e.counter?2:this.type,this.hints=e.hints||s.emptyArray}write(t,e){if(!(this.queries&&this.queries.length>0))throw new TypeError(r.format("Invalid queries provided %s",this.queries));const n=new o(i.opcodes.batch);let a=this.options.traceQuery?i.frameFlags.tracing:0;this.options.customPayload&&(a|=i.frameFlags.customPayload,n.writeCustomPayload(this.options.customPayload)),n.writeByte(this.type),n.writeShort(this.queries.length);const u=this;if(this.queries.forEach(function(e,r){const o=u.hints[r],i=e.params||s.emptyArray;let a;e.queryId?(n.writeByte(1),n.writeShortBytes(e.queryId),a=(t=>e.meta.columns[t].type)):(n.writeByte(0),n.writeLString(e.query),a=o?t=>o[t]:()=>null),n.writeShort(i.length),i.forEach((e,r)=>n.writeBytes(t.encode(e,a(r))))},this),n.writeShort(this.options.consistency),i.protocolVersion.supportsTimestamp(t.protocolVersion)){let t=this.options.serialConsistency?c.withSerialConsistency:0;if(t|=this.options.timestamp?c.withDefaultTimestamp:0,n.writeByte(t),this.options.serialConsistency&&n.writeShort(this.options.serialConsistency),this.options.timestamp){let t=this.options.timestamp;"number"==typeof t&&(t=i.Long.fromNumber(t)),n.writeLong(t)}}return n.write(t.protocolVersion,e,a)}clone(){return new l(this.queries,this.options)}}const p=new class extends u{write(t,e){return new o(i.opcodes.options).write(t.protocolVersion,e,0)}clone(){return this}};e.AuthResponseRequest=class extends u{constructor(t){super(),this.token=t}write(t,e){const n=new o(i.opcodes.authResponse);return n.writeBytes(this.token),n.write(t.protocolVersion,e)}},e.BatchRequest=l,e.CredentialsRequest=class extends u{constructor(t,e){super(),this.username=t,this.password=e}write(t,e){const n=new o(i.opcodes.credentials);return n.writeStringMap({username:this.username,password:this.password}),n.write(t.protocolVersion,e)}},e.ExecuteRequest=h,e.PrepareRequest=class extends u{constructor(t){super(),this.query=t}write(t,e){const n=new o(i.opcodes.prepare);return n.writeLString(this.query),n.write(t.protocolVersion,e)}},e.QueryRequest=class extends h{constructor(t,e,n,r){super(t,null,e,n,null),this.hints=this.options.hints||s.emptyArray,this.namedParameters=r}getParamType(t){return this.hints[t]}write(t,e){const n=new o(i.opcodes.query);let r=this.options.traceQuery?i.frameFlags.tracing:0;return this.options.customPayload&&(r|=i.frameFlags.customPayload,n.writeCustomPayload(this.options.customPayload)),n.writeLString(this.query),i.protocolVersion.supportsPaging(t.protocolVersion)?this.writeQueryParameters(n,t):n.writeShort(this.consistency),n.write(t.protocolVersion,e,r)}},e.Request=u,e.RegisterRequest=class extends u{constructor(t){super(),this.events=t}write(t,e){const n=new o(i.opcodes.register);return n.writeStringList(this.events),n.write(t.protocolVersion,e)}},e.StartupRequest=class extends u{constructor(t,e){super(),this.cqlVersion=t||"3.0.0",this.noCompact=e}write(t,e){const n=new o(i.opcodes.startup),r={CQL_VERSION:this.cqlVersion};return this.noCompact&&(r.NO_COMPACT="true"),n.writeStringMap(r),n.write(t.protocolVersion,e)}},e.options=p},function(t,e,n){var r,o,i;
/**
 * @license Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/Long.js for details
 */o=[],void 0===(i="function"==typeof(r=function(){"use strict";function t(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}t.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=function(t){return!0===(t&&t.__isLong__)};var e={},n={};t.fromInt=function(r,o){var i,s;return o?0<=(r>>>=0)&&r<256&&(s=n[r])?s:(i=new t(r,(0|r)<0?-1:0,!0),0<=r&&r<256&&(n[r]=i),i):-128<=(r|=0)&&r<128&&(s=e[r])?s:(i=new t(r,r<0?-1:0,!1),-128<=r&&r<128&&(e[r]=i),i)},t.fromNumber=function(e,n){return n=!!n,isNaN(e)||!isFinite(e)?t.ZERO:!n&&e<=-i?t.MIN_VALUE:!n&&e+1>=i?t.MAX_VALUE:n&&e>=o?t.MAX_UNSIGNED_VALUE:e<0?t.fromNumber(-e,n).negate():new t(e%r|0,e/r|0,n)},t.fromBits=function(e,n,r){return new t(e,n,r)},t.fromString=function(e,n,r){if(0===e.length)throw Error("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t.ZERO;if("number"==typeof n&&(r=n,n=!1),(r=r||10)<2||36<r)throw Error("radix out of range: "+r);var o;if((o=e.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+e);if(0===o)return t.fromString(e.substring(1),n,r).negate();for(var i=t.fromNumber(Math.pow(r,8)),s=t.ZERO,a=0;a<e.length;a+=8){var c=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+c),r);if(c<8){var h=t.fromNumber(Math.pow(r,c));s=s.multiply(h).add(t.fromNumber(u))}else s=(s=s.multiply(i)).add(t.fromNumber(u))}return s.unsigned=n,s},t.fromValue=function(e){return e instanceof t?e:"number"==typeof e?t.fromNumber(e):"string"==typeof e?t.fromString(e):new t(e.low,e.high,e.unsigned)};var r=4294967296,o=r*r,i=o/2,s=t.fromInt(1<<24);return t.ZERO=t.fromInt(0),t.UZERO=t.fromInt(0,!0),t.ONE=t.fromInt(1),t.UONE=t.fromInt(1,!0),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(-1,2147483647,!1),t.MAX_UNSIGNED_VALUE=t.fromBits(-1,-1,!0),t.MIN_VALUE=t.fromBits(0,-2147483648,!1),t.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*r+(this.low>>>0):this.high*r+(this.low>>>0)},t.prototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix out of range: "+e);if(this.isZero())return"0";var n;if(this.isNegative()){if(this.equals(t.MIN_VALUE)){var r=t.fromNumber(e),o=this.divide(r);return n=o.multiply(r).subtract(this),o.toString(e)+n.toInt().toString(e)}return"-"+this.negate().toString(e)}var i=t.fromNumber(Math.pow(e,6),this.unsigned);n=this;for(var s="";;){var a=n.divide(i),c=(n.subtract(a.multiply(i)).toInt()>>>0).toString(e);if((n=a).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},t.prototype.getHighBits=function(){return this.high},t.prototype.getHighBitsUnsigned=function(){return this.high>>>0},t.prototype.getLowBits=function(){return this.low},t.prototype.getLowBitsUnsigned=function(){return this.low>>>0},t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(t.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,n=31;n>0&&0==(e&1<<n);n--);return 0!=this.high?n+33:n+1},t.prototype.isZero=function(){return 0===this.high&&0===this.low},t.prototype.isNegative=function(){return!this.unsigned&&this.high<0},t.prototype.isPositive=function(){return this.unsigned||this.high>=0},t.prototype.isOdd=function(){return 1==(1&this.low)},t.prototype.isEven=function(){return 0==(1&this.low)},t.prototype.equals=function(e){return t.isLong(e)||(e=t.fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},t.eq=t.prototype.equals,t.prototype.notEquals=function(t){return!this.equals(t)},t.neq=t.prototype.notEquals,t.prototype.lessThan=function(t){return this.compare(t)<0},t.prototype.lt=t.prototype.lessThan,t.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},t.prototype.lte=t.prototype.lessThanOrEqual,t.prototype.greaterThan=function(t){return this.compare(t)>0},t.prototype.gt=t.prototype.greaterThan,t.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},t.prototype.gte=t.prototype.greaterThanOrEqual,t.prototype.compare=function(e){if(t.isLong(e)||(e=t.fromValue(e)),this.equals(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.subtract(e).isNegative()?-1:1},t.prototype.negate=function(){return!this.unsigned&&this.equals(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.neg=t.prototype.negate,t.prototype.add=function(e){t.isLong(e)||(e=t.fromValue(e));var n=this.high>>>16,r=65535&this.high,o=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,u=0,h=0,l=0,p=0;return l+=(p+=i+(65535&e.low))>>>16,p&=65535,h+=(l+=o+c)>>>16,l&=65535,u+=(h+=r+a)>>>16,h&=65535,u+=n+s,u&=65535,t.fromBits(l<<16|p,u<<16|h,this.unsigned)},t.prototype.subtract=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.negate())},t.prototype.sub=t.prototype.subtract,t.prototype.multiply=function(e){if(this.isZero())return t.ZERO;if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())return t.ZERO;if(this.equals(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.equals(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(s)&&e.lessThan(s))return t.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,o=this.low>>>16,i=65535&this.low,a=e.high>>>16,c=65535&e.high,u=e.low>>>16,h=65535&e.low,l=0,p=0,f=0,d=0;return f+=(d+=i*h)>>>16,d&=65535,p+=(f+=o*h)>>>16,f&=65535,p+=(f+=i*u)>>>16,f&=65535,l+=(p+=r*h)>>>16,p&=65535,l+=(p+=o*u)>>>16,p&=65535,l+=(p+=i*c)>>>16,p&=65535,l+=n*h+r*u+o*c+i*a,l&=65535,t.fromBits(f<<16|d,l<<16|p,this.unsigned)},t.prototype.mul=t.prototype.multiply,t.prototype.divide=function(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?t.UZERO:t.ZERO;var n,r,o;if(this.equals(t.MIN_VALUE))return e.equals(t.ONE)||e.equals(t.NEG_ONE)?t.MIN_VALUE:e.equals(t.MIN_VALUE)?t.ONE:(n=this.shiftRight(1).divide(e).shiftLeft(1)).equals(t.ZERO)?e.isNegative()?t.ONE:t.NEG_ONE:(r=this.subtract(e.multiply(n)),o=n.add(r.divide(e)));if(e.equals(t.MIN_VALUE))return this.unsigned?t.UZERO:t.ZERO;if(this.isNegative())return e.isNegative()?this.negate().divide(e.negate()):this.negate().divide(e).negate();if(e.isNegative())return this.divide(e.negate()).negate();for(o=t.ZERO,r=this;r.greaterThanOrEqual(e);){n=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),s=i<=48?1:Math.pow(2,i-48),a=t.fromNumber(n),c=a.multiply(e);c.isNegative()||c.greaterThan(r);)n-=s,c=(a=t.fromNumber(n,this.unsigned)).multiply(e);a.isZero()&&(a=t.ONE),o=o.add(a),r=r.subtract(c)}return o},t.prototype.div=t.prototype.divide,t.prototype.modulo=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.subtract(this.divide(e).multiply(e))},t.prototype.mod=t.prototype.modulo,t.prototype.not=function(){return t.fromBits(~this.low,~this.high,this.unsigned)},t.prototype.and=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},t.prototype.or=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},t.prototype.xor=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},t.prototype.shiftLeft=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):t.fromBits(0,this.low<<e-32,this.unsigned)},t.prototype.shl=t.prototype.shiftLeft,t.prototype.shiftRight=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):t.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},t.prototype.shr=t.prototype.shiftRight,t.prototype.shiftRightUnsigned=function(e){if(t.isLong(e)&&(e=e.toInt()),0==(e&=63))return this;var n=this.high;if(e<32){var r=this.low;return t.fromBits(r>>>e|n<<32-e,n>>>e,this.unsigned)}return 32===e?t.fromBits(n,0,this.unsigned):t.fromBits(n>>>e-32,0,this.unsigned)},t.prototype.shru=t.prototype.shiftRightUnsigned,t.prototype.toSigned=function(){return this.unsigned?new t(this.low,this.high,!1):this},t.prototype.toUnsigned=function(){return this.unsigned?this:new t(this.low,this.high,!0)},t})?r.apply(e,o):r)||(t.exports=i)},function(t,e,n){"use strict";const r=n(2),o=n(0),i=r.dataTypes.getByName("bigint"),s=r.dataTypes.getByName("varint"),a=r.dataTypes.getByName("blob");class c{constructor(t){this._value=t}getType(){throw new Error("You must implement a getType function for this Token instance")}getValue(){return this._value}toString(){return this._value.toString()}compare(t){return this._value.compare(t._value)}equals(t){return 0===this.compare(t)}inspect(){return this.constructor.name+" { "+this.toString()+" }"}}class u{constructor(t,e,n){this.start=t,this.end=e,Object.defineProperty(this,"_tokenizer",{value:n,enumerable:!1})}splitEvenly(t){if(t<1)throw new Error(o.format("numberOfSplits (%d) must be greater than 0.",t));if(this.isEmpty())throw new Error("Can't split empty range "+this.toString());const e=[],n=this._tokenizer.split(this.start,this.end,t);let r,i=this.start;for(let t=0;t<n.length;t++)r=n[t],e.push(new u(i,r,this._tokenizer)),i=r;return e.push(new u(i,this.end,this._tokenizer)),e}isEmpty(){return this.start.equals(this.end)&&!this.start.equals(this._tokenizer.minToken())}isWrappedAround(){return this.start.compare(this.end)>0&&!this.end.equals(this._tokenizer.minToken())}unwrap(){return this.isWrappedAround()?[new u(this.start,this._tokenizer.minToken(),this._tokenizer),new u(this._tokenizer.minToken(),this.end,this._tokenizer)]:[this]}contains(t){if(this.isEmpty())return!1;const e=this._tokenizer.minToken();if(this.end.equals(e))return!!this.start.equals(e)||(!!t.equals(e)||t.compare(this.start)>0);const n=t.compare(this.start)>0,r=t.compare(this.end)<=0;return this.isWrappedAround()?n||r:n&&r}equals(t){return t===this||t instanceof u&&0===this.compare(t)}compare(t){const e=this.start.compare(t.start);return 0!==e?e:this.end.compare(t.end)}toString(){return o.format("]%s, %s]",this.start.toString(),this.end.toString())}}e.Token=c,e.TokenRange=u,e.ByteOrderedToken=class extends c{constructor(t){super(t)}getType(){return a}toString(){return this._value.toString("hex").toUpperCase()}},e.Murmur3Token=class extends c{constructor(t){super(t)}getType(){return i}},e.RandomToken=class extends c{constructor(t){super(t)}getType(){return s}}},function(t,e,n){"use strict";const r=n(0),o=n(11),i=n(2),s=n(1),a=n(3),c={[i.distance.local]:2,[i.distance.remote]:1,[i.distance.ignored]:0},u={[i.distance.local]:1,[i.distance.remote]:1,[i.distance.ignored]:0},h=128,l=2048;function p(){return{policies:{addressResolution:o.defaultAddressTranslator(),loadBalancing:o.defaultLoadBalancingPolicy(),reconnection:o.defaultReconnectionPolicy(),retry:o.defaultRetryPolicy(),speculativeExecution:o.defaultSpeculativeExecutionPolicy(),timestampGeneration:o.defaultTimestampGenerator()},queryOptions:{consistency:i.consistencies.localOne,fetchSize:5e3,prepare:!1,retryOnTimeout:!0,captureStackTrace:!1},protocolOptions:{port:9042,maxSchemaAgreementWaitSeconds:10,maxVersion:0,noCompact:!1},pooling:{heartBeatInterval:3e4,warmup:!0},socketOptions:{connectTimeout:5e3,defunctReadTimeoutThreshold:64,keepAlive:!0,keepAliveDelay:0,readTimeout:12e3,tcpNoDelay:!0,coalescingThreshold:65536},authProvider:null,maxPrepared:500,refreshSchemaDelay:1e3,isMetadataSyncEnabled:!0,prepareOnAllHosts:!0,rePrepareOnUp:!0,encoding:{copyBuffer:!0,useUndefinedAsUnset:!0}}}function f(t,e){return void 0!==t?t:e}function d(t,e,n){return void 0!==t?t:void 0!==e?e:n}e.extend=function(t,e){1===arguments.length&&(e=arguments[0],t={});const n=s.deepExtend(t,p(),e);if(!r.isArray(n.contactPoints)||0===n.contactPoints.length)throw new TypeError("Contacts points are not defined.");for(let t=0;t<n.contactPoints.length;t++){const e=n.contactPoints[t];if(!e)throw new TypeError(r.format("Contact point %s (%s) is not a valid host name, the following values are valid contact points: ipAddress, hostName or ipAddress:port",t,e))}if(n.logEmitter||(n.logEmitter=function(){}),!n.queryOptions)throw new TypeError("queryOptions not defined in options");if(function(t){if(!t)throw new TypeError("policies not defined in options");if(!(t.loadBalancing instanceof o.loadBalancing.LoadBalancingPolicy))throw new TypeError("Load balancing policy must be an instance of LoadBalancingPolicy");if(!(t.reconnection instanceof o.reconnection.ReconnectionPolicy))throw new TypeError("Reconnection policy must be an instance of ReconnectionPolicy");if(!(t.retry instanceof o.retry.RetryPolicy))throw new TypeError("Retry policy must be an instance of RetryPolicy");if(!(t.addressResolution instanceof o.addressResolution.AddressTranslator))throw new TypeError("Address resolution policy must be an instance of AddressTranslator");if(null!==t.timestampGeneration&&!(t.timestampGeneration instanceof o.timestampGeneration.TimestampGenerator))throw new TypeError("Timestamp generation policy must be an instance of TimestampGenerator")}(n.policies),function(t){if(!t)throw new TypeError("protocolOptions not defined in options");const e=t.maxVersion;if(e&&("number"!=typeof e||!i.protocolVersion.isSupported(e)))throw new TypeError(r.format("protocolOptions.maxVersion provided (%s) is invalid",e))}(n.protocolOptions),function(t){if(!t)throw new TypeError("socketOptions not defined in options");if("number"!=typeof t.readTimeout)throw new TypeError("socketOptions.readTimeout must be a Number");if("number"!=typeof t.coalescingThreshold||t.coalescingThreshold<=0)throw new TypeError("socketOptions.coalescingThreshold must be a positive Number")}(n.socketOptions),n.encoding=n.encoding||{},function(t){if(t.map){const e=t.map;if("function"!=typeof e||"function"!=typeof e.prototype.forEach||"function"!=typeof e.prototype.set)throw new TypeError("Map constructor not valid")}if(t.set){const e=t.set;if("function"!=typeof e||"function"!=typeof e.prototype.forEach||"function"!=typeof e.prototype.add)throw new TypeError("Set constructor not valid")}}(n.encoding),n.profiles&&!r.isArray(n.profiles))throw new TypeError("profiles must be an Array of ExecutionProfile instances");return n},e.defaultOptions=p,e.coreConnectionsPerHostV2=c,e.coreConnectionsPerHostV3=u,e.createQueryOptions=function(t,e,n,o){const c=t.profileManager.getProfile(e&&e.executionProfile);if(!c)return new a.ArgumentError(r.format('Execution profile "%s" not found',e.executionProfile));e=e&&"function"!=typeof e?e:s.emptyObject;const u=t.options.queryOptions,h={autoPage:f(e.autoPage,u.autoPage),captureStackTrace:f(e.captureStackTrace,u.captureStackTrace),consistency:d(e.consistency,c.consistency,u.consistency),customPayload:f(e.customPayload,u.customPayload),executionProfile:c,fetchSize:f(e.fetchSize,u.fetchSize),hints:e.hints,isIdempotent:f(e.isIdempotent,u.isIdempotent),keyspace:e.keyspace,logged:f(e.logged,o),pageState:"string"==typeof e.pageState?s.allocBufferFromString(e.pageState,"hex"):e.pageState,prepare:f(e.prepare,u.prepare),readTimeout:d(e.readTimeout,c.readTimeout,t.options.socketOptions.readTimeout),retry:d(e.retry,c.retry,t.options.policies.retry),retryOnTimeout:d(e.retryOnTimeout,c.retryOnTimeout,u.retryOnTimeout),routingIndexes:e.routingIndexes,routingKey:e.routingKey,routingNames:e.routingNames,serialConsistency:d(e.serialConsistency,c.serialConsistency,u.serialConsistency),timestamp:function(t,e,n){if(void 0!==e.timestamp)return e.timestamp;const r=t.options.policies.timestampGeneration;return i.protocolVersion.supportsTimestamp(t.controlConnection.protocolVersion)&&r?r.next(t):n}(t,e,u.timestamp),traceQuery:f(e.traceQuery,u.traceQuery),rowCallback:n};if(e===s.emptyObject)return h;const l=Object.keys(e);let p,m,g=l.length;for(;g--;)"executionProfile"!==(p=l[g])&&(void 0===(m=e[p])||h.hasOwnProperty(p)||(h[p]=m));return h},e.maxRequestsPerConnectionV2=h,e.maxRequestsPerConnectionV3=l,e.setProtocolDependentDefaults=function(t,e){let n=u,r=l;i.protocolVersion.uses2BytesStreamIds(e)||(n=c,r=h),t.pooling=s.deepExtend({},{coreConnectionsPerHost:n,maxRequestsPerConnection:r},t.pooling)}},function(t,e){t.exports=require("crypto")},function(t){t.exports={_args:[["cassandra-driver@3.5.0","/Users/harishkumargangula/Documents/Workspace/Sunbird/Portal/src/app/cassandra_migration/release-1.11/form-plugin-migration"]],_from:"cassandra-driver@3.5.0",_id:"cassandra-driver@3.5.0",_inBundle:!1,_integrity:"sha512-CBdXA5roCZOvXElO+jTVWsa8W231fpYcGU+R1QQ1yO9O9dpXdZ7vkPpUfc+LO47Dyp67FNWYS+mm/q2ZMPJrZQ==",_location:"/cassandra-driver",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"cassandra-driver@3.5.0",name:"cassandra-driver",escapedName:"cassandra-driver",rawSpec:"3.5.0",saveSpec:null,fetchSpec:"3.5.0"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/cassandra-driver/-/cassandra-driver-3.5.0.tgz",_spec:"3.5.0",_where:"/Users/harishkumargangula/Documents/Workspace/Sunbird/Portal/src/app/cassandra_migration/release-1.11/form-plugin-migration",author:{name:"DataStax"},bugs:{url:"https://groups.google.com/a/lists.datastax.com/forum/#!forum/nodejs-driver-user"},dependencies:{long:"^2.2.0"},description:"DataStax Node.js Driver for Apache Cassandra",devDependencies:{mocha:"~2.5.3","mocha-appveyor-reporter":">= 0.2.1","mocha-jenkins-reporter":">= 0.1.9","mocha-multi":"~0.11.0",rewire:">= 2.1.0"},engines:{node:">=4"},homepage:"https://github.com/datastax/nodejs-driver#readme",keywords:["cassandra","cql","cql3","connection","pool","datastax","nosql","driver","database"],license:"Apache-2.0",name:"cassandra-driver",repository:{type:"git",url:"git+https://github.com/datastax/nodejs-driver.git"},scripts:{ci:"mocha test/unit test/integration/short -R mocha-multi",ci_unit:"mocha test/unit -R mocha-multi",eslint:"eslint lib test --ignore-pattern '/lib/types/integer.js'",test:"mocha test/unit -R spec -t 5000"},version:"3.5.0"}},function(t,e,n){"use strict";const r=e.addressResolution=n(31),o=e.loadBalancing=n(32),i=e.reconnection=n(45),s=e.retry=n(16),a=e.speculativeExecution=n(46),c=e.timestampGeneration=n(47);e.defaultAddressTranslator=function(){return new r.AddressTranslator},e.defaultLoadBalancingPolicy=function(){return new o.TokenAwarePolicy(new o.DCAwareRoundRobinPolicy)},e.defaultRetryPolicy=function(){return new s.RetryPolicy},e.defaultReconnectionPolicy=function(){return new i.ExponentialReconnectionPolicy(1e3,6e5,!1)},e.defaultSpeculativeExecutionPolicy=function(){return new a.NoSpeculativeExecutionPolicy},e.defaultTimestampGenerator=function(){return new c.MonotonicTimestampGenerator}},function(t,e){t.exports=require("dns")},function(t,e,n){"use strict";const r=n(9),o=n(1);function i(t){if(!t||16!==t.length)throw new Error("You must provide a buffer containing 16 bytes");this.buffer=t}function s(t){return t[6]&=15,t[6]|=64,t[8]&=63,t[8]|=128,new i(t)}function a(t){return r.randomBytes(16,t)}i.fromString=function(t){if("string"!=typeof t||36!==t.length)throw new Error("Invalid string representation of Uuid, it should be in the 00000000-0000-0000-0000-000000000000");return new i(o.allocBufferFromString(t.replace(/-/g,""),"hex"))},i.random=function(t){if(!t){return s(a())}a(function(e,n){return e?t(e):t(null,s(n))})},i.prototype.getBuffer=function(){return this.buffer},i.prototype.equals=function(t){return!!(t instanceof i&&this.buffer.toString("hex")===t.buffer.toString("hex"))},i.prototype.toString=function(){const t=function(t){return t.buffer.toString("hex")}(this);return t.substr(0,8)+"-"+t.substr(8,4)+"-"+t.substr(12,4)+"-"+t.substr(16,4)+"-"+t.substr(20,12)},i.prototype.inspect=function(){return this.constructor.name+": "+this.toString()},i.prototype.toJSON=function(){return this.toString()},t.exports=i},function(t,e,n){var r=n(1);function o(t,e){this.bits_=[],this.sign_=e;for(var n=!0,r=t.length-1;r>=0;r--){var o=0|t[r];n&&o==e||(this.bits_[r]=o,n=!1)}}o.IntCache_={},o.fromInt=function(t){if(-128<=t&&t<128){var e=o.IntCache_[t];if(e)return e}var n=new o([0|t],t<0?-1:0);return-128<=t&&t<128&&(o.IntCache_[t]=n),n},o.fromNumber=function(t){if(isNaN(t)||!isFinite(t))return o.ZERO;if(t<0)return o.fromNumber(-t).negate();for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=o.TWO_PWR_32_DBL_;return new o(e,0)},o.fromBits=function(t){return new o(t,t[t.length-1]&1<<31?-1:0)},o.fromString=function(t,e){if(0==t.length)throw TypeError("number format error: empty string");var n=e||10;if(n<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return o.fromString(t.substring(1),n).negate();if(t.indexOf("-")>=0)throw TypeError('number format error: interior "-" character');for(var r=o.fromNumber(Math.pow(n,8)),i=o.ZERO,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+a),n);if(a<8){var u=o.fromNumber(Math.pow(n,a));i=i.multiply(u).add(o.fromNumber(c))}else i=(i=i.multiply(r)).add(o.fromNumber(c))}return i},o.fromBuffer=function(t){for(var e=new Array(Math.ceil(t.length/4)),n=128&t[0]?-1:0,r=0;r<e.length;r++){var i,s=t.length-4*(r+1);if(s<0){s+=4,i=0;for(var a=0;a<s;a++){var c=t[a];-1===n&&(c=255&~c),i|=c<<8*(s-a-1)}-1===n&&(i=~i)}else i=t.readInt32BE(s);e[r]=i}return new o(e,n)},o.toBuffer=function(t){var e=t.sign_,n=t.bits_;if(0===n.length)return r.allocBufferFromArray([t.sign_]);var o=n[n.length-1];-1===e&&(o=~o);var i=[];o>>>24>0&&i.push(o>>24&255),o>>>16>0&&i.push(o>>16&255),o>>>8>0&&i.push(o>>8&255),i.push(255&o),i[0]>>7!=0&&i.unshift(0);for(var s=r.allocBufferUnsafe(i.length+4*(n.length-1)),a=0;a<i.length;a++){var c=i[a];s[a]=-1===e?~c:c}for(var u=0;u<n.length-1;u++){var h=n[n.length-2-u],l=i.length+4*u;s.writeInt32BE(h,l)}return s},o.TWO_PWR_32_DBL_=4294967296,o.ZERO=o.fromInt(0),o.ONE=o.fromInt(1),o.TWO_PWR_24_=o.fromInt(1<<24),o.prototype.toInt=function(){return this.bits_.length>0?this.bits_[0]:this.sign_},o.prototype.toNumber=function(){if(this.isNegative())return-this.negate().toNumber();for(var t=0,e=1,n=0;n<this.bits_.length;n++)t+=this.getBitsUnsigned(n)*e,e*=o.TWO_PWR_32_DBL_;return t},o.prototype.toString=function(t){var e=t||10;if(e<2||36<e)throw Error("radix out of range: "+e);if(this.isZero())return"0";if(this.isNegative())return"-"+this.negate().toString(e);for(var n=o.fromNumber(Math.pow(e,6)),r=this,i="";;){var s=r.divide(n),a=r.subtract(s.multiply(n)).toInt().toString(e);if((r=s).isZero())return a+i;for(;a.length<6;)a="0"+a;i=""+a+i}},o.prototype.getBits=function(t){return t<0?0:t<this.bits_.length?this.bits_[t]:this.sign_},o.prototype.getBitsUnsigned=function(t){var e=this.getBits(t);return e>=0?e:o.TWO_PWR_32_DBL_+e},o.prototype.getSign=function(){return this.sign_},o.prototype.isZero=function(){if(0!=this.sign_)return!1;for(var t=0;t<this.bits_.length;t++)if(0!=this.bits_[t])return!1;return!0},o.prototype.isNegative=function(){return-1==this.sign_},o.prototype.isOdd=function(){return 0==this.bits_.length&&-1==this.sign_||this.bits_.length>0&&0!=(1&this.bits_[0])},o.prototype.equals=function(t){if(this.sign_!=t.sign_)return!1;for(var e=Math.max(this.bits_.length,t.bits_.length),n=0;n<e;n++)if(this.getBits(n)!=t.getBits(n))return!1;return!0},o.prototype.notEquals=function(t){return!this.equals(t)},o.prototype.greaterThan=function(t){return this.compare(t)>0},o.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},o.prototype.lessThan=function(t){return this.compare(t)<0},o.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},o.prototype.compare=function(t){var e=this.subtract(t);return e.isNegative()?-1:e.isZero()?0:1},o.prototype.shorten=function(t){for(var e=t-1>>5,n=(t-1)%32,r=[],i=0;i<e;i++)r[i]=this.getBits(i);var s=31==n?4294967295:(1<<n+1)-1,a=this.getBits(e)&s;return a&1<<n?(a|=4294967295-s,r[e]=a,new o(r,-1)):(r[e]=a,new o(r,0))},o.prototype.negate=function(){return this.not().add(o.ONE)},o.prototype.add=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),n=[],r=0,i=0;i<=e;i++){var s=this.getBits(i)>>>16,a=65535&this.getBits(i),c=t.getBits(i)>>>16,u=r+a+(65535&t.getBits(i)),h=(u>>>16)+s+c;r=h>>>16,u&=65535,h&=65535,n[i]=h<<16|u}return o.fromBits(n)},o.prototype.subtract=function(t){return this.add(t.negate())},o.prototype.multiply=function(t){if(this.isZero())return o.ZERO;if(t.isZero())return o.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(o.TWO_PWR_24_)&&t.lessThan(o.TWO_PWR_24_))return o.fromNumber(this.toNumber()*t.toNumber());for(var e=this.bits_.length+t.bits_.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.bits_.length;r++)for(var i=0;i<t.bits_.length;i++){var s=this.getBits(r)>>>16,a=65535&this.getBits(r),c=t.getBits(i)>>>16,u=65535&t.getBits(i);n[2*r+2*i]+=a*u,o.carry16_(n,2*r+2*i),n[2*r+2*i+1]+=s*u,o.carry16_(n,2*r+2*i+1),n[2*r+2*i+1]+=a*c,o.carry16_(n,2*r+2*i+1),n[2*r+2*i+2]+=s*c,o.carry16_(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new o(n,0)},o.carry16_=function(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535},o.prototype.divide=function(t){if(t.isZero())throw Error("division by zero");if(this.isZero())return o.ZERO;if(this.isNegative())return t.isNegative()?this.negate().divide(t.negate()):this.negate().divide(t).negate();if(t.isNegative())return this.divide(t.negate()).negate();for(var e=o.ZERO,n=this;n.greaterThanOrEqual(t);){for(var r=Math.max(1,Math.floor(n.toNumber()/t.toNumber())),i=Math.ceil(Math.log(r)/Math.LN2),s=i<=48?1:Math.pow(2,i-48),a=o.fromNumber(r),c=a.multiply(t);c.isNegative()||c.greaterThan(n);)r-=s,c=(a=o.fromNumber(r)).multiply(t);a.isZero()&&(a=o.ONE),e=e.add(a),n=n.subtract(c)}return e},o.prototype.modulo=function(t){return this.subtract(this.divide(t).multiply(t))},o.prototype.not=function(){for(var t=this.bits_.length,e=[],n=0;n<t;n++)e[n]=~this.bits_[n];return new o(e,~this.sign_)},o.prototype.and=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),n=[],r=0;r<e;r++)n[r]=this.getBits(r)&t.getBits(r);return new o(n,this.sign_&t.sign_)},o.prototype.or=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),n=[],r=0;r<e;r++)n[r]=this.getBits(r)|t.getBits(r);return new o(n,this.sign_|t.sign_)},o.prototype.xor=function(t){for(var e=Math.max(this.bits_.length,t.bits_.length),n=[],r=0;r<e;r++)n[r]=this.getBits(r)^t.getBits(r);return new o(n,this.sign_^t.sign_)},o.prototype.shiftLeft=function(t){for(var e=t>>5,n=t%32,r=this.bits_.length+e+(n>0?1:0),i=[],s=0;s<r;s++)i[s]=n>0?this.getBits(s-e)<<n|this.getBits(s-e-1)>>>32-n:this.getBits(s-e);return new o(i,this.sign_)},o.prototype.shiftRight=function(t){for(var e=t>>5,n=t%32,r=this.bits_.length-e,i=[],s=0;s<r;s++)i[s]=n>0?this.getBits(s+e)>>>n|this.getBits(s+e+1)<<32-n:this.getBits(s+e);return new o(i,this.sign_)},o.prototype.inspect=function(){return this.constructor.name+": "+this.toString()},o.prototype.abs=function(){return 0===this.sign_?this:this.negate()},o.prototype.toJSON=function(){return this.toString()},t.exports=o},function(t,e){t.exports=require("stream")},function(t,e,n){"use strict";const r=n(0),o=n(3);function i(){}function s(t){this._childPolicy=t||new i}i.prototype.onUnavailable=function(t,e,n,r){return t.nbRetry>0?this.rethrowResult():this.retryResult(void 0,!1)},i.prototype.onReadTimeout=function(t,e,n,r,o){return t.nbRetry>0?this.rethrowResult():n>=r&&!o?this.retryResult():this.rethrowResult()},i.prototype.onWriteTimeout=function(t,e,n,r,o){return t.nbRetry>0?this.rethrowResult():"BATCH_LOG"===o?this.retryResult():this.rethrowResult()},i.prototype.onRequestError=function(t,e,n){return n instanceof o.OperationTimedOutError&&!t.options.retryOnTimeout?this.rethrowResult():this.retryResult(void 0,!1)},i.prototype.retryResult=function(t,e){return{decision:i.retryDecision.retry,consistency:t,useCurrentHost:!1!==e}},i.prototype.rethrowResult=function(){return{decision:i.retryDecision.rethrow}},i.retryDecision={rethrow:0,retry:1,ignore:2},r.inherits(s,i),s.prototype.onReadTimeout=function(t,e,n,r,o){return this._childPolicy.onReadTimeout(t,e,n,r,o)},s.prototype.onRequestError=function(t,e,n){return t.options.isIdempotent?this._childPolicy.onRequestError(t,e,n):this.rethrowResult()},s.prototype.onUnavailable=function(t,e,n,r){return this._childPolicy.onUnavailable(t,e,n,r)},s.prototype.onWriteTimeout=function(t,e,n,r,o){return t.options.isIdempotent?this._childPolicy.onWriteTimeout(t,e,n,r,o):this.rethrowResult()},e.RetryPolicy=i,e.IdempotenceAwareRetryPolicy=s},function(t,e,n){"use strict";const r=n(1),o=n(2);function i(t,e){if("string"!=typeof t)throw new TypeError("Execution profile name must be a string");e=e||r.emptyObject,this.name=t,this.consistency=e.consistency,this.loadBalancing=e.loadBalancing,this.readTimeout=e.readTimeout,this.retry=e.retry,this.serialConsistency=e.serialConsistency}function s(t){this._profiles=t.profiles||[],this._setDefault(t),this._loadBalancingPolicies=[],this._profilesMap={},this._profiles.forEach(function(t){return this._profilesMap[t.name]=t,t.loadBalancing=t.loadBalancing||this._defaultProfile.loadBalancing,-1===this._loadBalancingPolicies.indexOf(t.loadBalancing)&&this._loadBalancingPolicies.push(t.loadBalancing),t},this)}s.prototype.init=function(t,e,n){r.eachSeries(this._loadBalancingPolicies,function(n,r){n.init(t,e,r)},n)},s.prototype.getDistance=function(t){let e=o.distance.ignored;for(let n=0;n<this._loadBalancingPolicies.length;n++){const r=this._loadBalancingPolicies[n].getDistance(t);if(r<e&&(e=r)===o.distance.local)break}return t.setDistance(e),e},s.prototype.getProfile=function(t){return t instanceof i?t:this._profilesMap[t||"default"]},s.prototype.getDefault=function(){return this._defaultProfile},s.prototype.getDefaultLoadBalancing=function(){return this._defaultProfile.loadBalancing},s.prototype._setDefault=function(t){this._defaultProfile=this._profiles.filter(function(t){return"default"===t.name})[0],this._defaultProfile||this._profiles.push(this._defaultProfile=new i("default")),this._defaultProfile.loadBalancing=this._defaultProfile.loadBalancing||t.policies.loadBalancing,this._defaultProfile.retry=this._defaultProfile.retry||t.policies.retry},e.ProfileManager=s,e.ExecutionProfile=i},function(t,e,n){"use strict";const r=n(4),o=n(2),i=n(1),s=o.FrameHeader;e.WriteQueue=class extends r.EventEmitter{constructor(t,e,n){super(),this.netClient=t,this.encoder=e,this.isRunning=!1,this.queue=[],this.coalescingThreshold=n.socketOptions.coalescingThreshold,this.error=null}push(t,e){const n=this;if(this.error)return process.nextTick(function(){e(n.error)});this.queue.push({operation:t,callback:e}),this.run()}run(){this.isRunning||(this.isRunning=!0,process.nextTick(()=>this.process()))}process(){if(this.error)return;const t=[],e=[];let n=0;for(;this.queue.length>0&&n<this.coalescingThreshold;){const r=this.queue.shift();if(!r.operation.canBeWritten()){r.callback(new Error("The operation was already cancelled or timeout elapsed"));continue}let o;try{o=r.operation.request.write(this.encoder,r.operation.streamId)}catch(t){r.callback(t);continue}n+=o.length,t.push(o),e.push(r.callback)}if(0!==n){for(let t=0;t<e.length;t++)e[t]();this.netClient.write(Buffer.concat(t,n),t=>{t?this.setWriteError(t):0!==this.queue.length?setImmediate(()=>this.process()):this.isRunning=!1})}else this.isRunning=!1}setWriteError(t){t.isSocketError=!0,this.error=new o.DriverError("Socket was closed"),this.error.isSocketError=!0,this.error.requestNotWritten=!0,this.error.innerError=t;const e=this.queue;this.queue=i.emptyArray;for(let t=0;t<e.length;t++)e[t].callback(this.error)}},e.FrameWriter=class{constructor(t){if(!t)throw new Error("Opcode not provided");this.buffers=[],this.opcode=t,this.bodyLength=0}add(t){this.buffers.push(t),this.bodyLength+=t.length}writeShort(t){const e=i.allocBufferUnsafe(2);e.writeUInt16BE(t,0),this.add(e)}writeInt(t){const e=i.allocBufferUnsafe(4);e.writeInt32BE(t,0),this.add(e)}writeLong(t){this.add(o.Long.toBuffer(t))}writeBytes(t){null!==t?t!==o.unset?(this.writeInt(t.length),this.add(t)):this.writeInt(-2):this.writeInt(-1)}writeShortBytes(t){null!==t?(this.writeShort(t.length),this.add(t)):this.writeShort(-1)}writeByte(t){this.add(i.allocBufferFromArray([t]))}writeString(t){if(void 0===t)throw new Error("can not write undefined");const e=Buffer.byteLength(t,"utf8"),n=i.allocBufferUnsafe(2+e);n.writeUInt16BE(e,0),n.write(t,2,n.length-2,"utf8"),this.add(n)}writeLString(t){const e=Buffer.byteLength(t,"utf8"),n=i.allocBufferUnsafe(4+e);n.writeInt32BE(e,0),n.write(t,4,n.length-4,"utf8"),this.add(n)}writeStringList(t){this.writeShort(t.length),t.forEach(this.writeString,this)}writeCustomPayload(t){const e=Object.keys(t);this.writeShort(e.length),e.forEach(function(e){this.writeString(e),this.writeBytes(t[e])},this)}writeStringMap(t){const e=[];for(const n in t)t.hasOwnProperty(n)&&e.push(n);this.writeShort(e.length);for(let n=0;n<e.length;n++){const r=e[n];this.writeString(r),this.writeString(t[r])}}write(t,e,n){const r=new s(t,n||0,e,this.opcode,this.bodyLength).toBuffer();return this.buffers.unshift(r),Buffer.concat(this.buffers,r.length+this.bodyLength)}}},function(t,e){t.exports=require("net")},function(t,e,n){"use strict";const r=n(0),o=n(4),i=n(1),s=n(2),a=n(51),c=n(23);function u(t,e,n,r){o.EventEmitter.call(this),this.address=t,this.setDownAt=0,Object.defineProperty(this,"options",{value:n,enumerable:!1,writable:!1}),Object.defineProperty(this,"pool",{value:new a(this,e),enumerable:!1});const i=this;this.pool.on("open",this._onNewConnectionOpen.bind(this)),this.pool.on("remove",function(){i._checkPoolState()}),this.cassandraVersion=null,this.datacenter=null,this.rack=null,this.tokens=null,this._distance=s.distance.ignored,Object.defineProperty(this,"_metadata",{value:r,enumerable:!1}),this.reconnectionSchedule=this.options.policies.reconnection.newSchedule()}function h(){o.EventEmitter.call(this),this._items={},this._values=null,Object.defineProperty(this,"length",{get:function(){return this.values().length},enumerable:!0})}r.inherits(u,o.EventEmitter),u.prototype.setDown=function(){0===this.setDownAt&&(this.pool.isClosing()||(this.setDownAt=Date.now(),this._distance!==s.distance.ignored?this.log("warning",r.format("Host %s considered as DOWN. Reconnection delay %dms.",this.address,this.reconnectionDelay)):this.log("info",r.format("Host %s considered as DOWN.",this.address)),this.emit("down"),this._checkPoolState()))},u.prototype.setUp=function(t){this.setDownAt&&(this.log("info",r.format("Setting host %s as UP",this.address)),this.setDownAt=0,this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),t&&this.pool.clearNewConnectionAttempt(),this.emit("up"))},u.prototype.checkIsUp=function(){this.isUp()||(this.reconnectionSchedule=this.options.policies.reconnection.newSchedule(),this.reconnectionDelay=0,this.pool.attemptNewConnectionImmediate())},u.prototype.shutdown=function(t,e){if(e=e||i.noop,t)return this.pool.drainAndShutdown(),e();this.pool.shutdown(e)},u.prototype.isUp=function(){return!this.setDownAt},u.prototype.canBeConsideredAsUp=function(){const t=this;return!this.setDownAt||(new Date).getTime()-t.setDownAt>=t.reconnectionDelay},u.prototype.setDistance=function(t){const e=this._distance;return this._distance=t||s.distance.local,this.options.pooling.coreConnectionsPerHost?this.pool.coreConnectionsLength=this.options.pooling.coreConnectionsPerHost[this._distance]||0:this.pool.coreConnectionsLength=1,this._distance===e?this._distance:(this._distance===s.distance.ignored?(this.emit("ignore"),this.pool.drainAndShutdown()):this.isUp()||this.checkIsUp(),this._distance)},u.prototype.setProtocolVersion=function(t){this.pool.protocolVersion=t},u.prototype.borrowConnection=function(t){this.pool.borrowConnection(t)},u.prototype.warmupPool=function(t){this.pool.create(!0,t)},u.prototype.getActiveConnection=function(){return this.isUp()&&this.pool.connections.length?this.pool.connections[0]:null},u.prototype.checkHealth=function(t){t.timedOutOperations<=this.options.socketOptions.defunctReadTimeoutThreshold||this.removeFromPool(t)},u.prototype.removeFromPool=function(t){this.pool.remove(t),this._checkPoolState()},u.prototype._checkPoolState=function(){this.pool.isClosing()||(this.pool.connections.length<this.pool.coreConnectionsLength&&(this.pool.hasScheduledNewConnection()||(this.reconnectionDelay=this.reconnectionSchedule.next().value,this.pool.scheduleNewConnectionAttempt(this.reconnectionDelay))),this._distance!==s.distance.ignored&&0===this.pool.connections.length&&this.pool.coreConnectionsLength>0&&this.setDown())},u.prototype._onNewConnectionOpen=function(t){if(t)return void this._checkPoolState();const e=this;function n(t){t&&e.log("warning",r.format("Failed re-preparing on host %s: %s",e.address,t),t),e.setUp(),e.pool.increaseSize()}if(this.isUp()||!this.options.rePrepareOnUp)return n();this.log("info",r.format("Re-preparing all queries on host %s before setting it as UP",this.address));const o=this._metadata.getAllPrepared();c.prepareAllQueries(this,o,n)},u.prototype.getCassandraVersion=function(){return this.cassandraVersion?this.cassandraVersion.split("-")[0].split(".").map(t=>parseInt(t,10)):i.emptyArray},u.prototype.log=i.log,r.inherits(h,o.EventEmitter),h.prototype.forEach=function(t){const e=this._items;for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)},h.prototype.get=function(t){return this._items[t]},h.prototype.keys=function(){return Object.keys(this._items)},h.prototype.remove=function(t){if(!this._items.hasOwnProperty(t))return;this._values=null;const e=i.extend({},this._items),n=e[t];delete e[t],this._items=e,this.emit("remove",n)},h.prototype.removeMultiple=function(t){this._values=null;const e=i.extend({},this._items),n=[];for(let r=0;r<t.length;r++){const o=e[t[r]];o&&(n.push(o),delete e[t[r]])}this._items=e,n.forEach(function(t){this.emit("remove",t)},this)},h.prototype.set=function(t,e){this._values=null;const n=this._items[t];if(n)return this._items[t]=e,this.emit("remove",n),void this.emit("add",e);const r=i.extend({},this._items);return r[t]=e,this._items=r,this.emit("add",e),e},h.prototype.slice=function(t,e){return t||e?(t=t||0,this.values().slice(t,e)):this.values()},h.prototype.push=h.prototype.set,h.prototype.values=function(){if(!this._values){const t=[];for(const e in this._items)this._items.hasOwnProperty(e)&&t.push(this._items[e]);this._values=Object.freeze(t)}return this._values},h.prototype.clear=function(){const t=this.values();this._values=null,this._items={};for(let e=0;e<t.length;e++)this.emit("remove",t[e]);return t},h.prototype.inspect=function(){return this._items},h.prototype.toJSON=function(){return this._items},e.Host=u,e.HostMap=h},function(t,e,n){"use strict";const r=n(0),o=n(2),i=o.dataTypes,s=o.Long,a=o.Integer,c=o.BigDecimal,u=n(22),h=n(1),l=n(7),p=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,f=h.allocBufferFromArray([0,0]),d=h.allocBufferFromArray([0,0,0,0]),m=Object.freeze({list:"org.apache.cassandra.db.marshal.ListType",set:"org.apache.cassandra.db.marshal.SetType",map:"org.apache.cassandra.db.marshal.MapType",udt:"org.apache.cassandra.db.marshal.UserType",tuple:"org.apache.cassandra.db.marshal.TupleType",frozen:"org.apache.cassandra.db.marshal.FrozenType",reversed:"org.apache.cassandra.db.marshal.ReversedType",composite:"org.apache.cassandra.db.marshal.CompositeType",empty:"org.apache.cassandra.db.marshal.EmptyType",collection:"org.apache.cassandra.db.marshal.ColumnToCollectionType"}),g=Object.freeze({frozen:"frozen",list:"list",set:"set",map:"map",tuple:"tuple",empty:"empty",duration:"duration"}),y=Object.freeze({"org.apache.cassandra.db.marshal.UTF8Type":i.varchar,"org.apache.cassandra.db.marshal.AsciiType":i.ascii,"org.apache.cassandra.db.marshal.UUIDType":i.uuid,"org.apache.cassandra.db.marshal.TimeUUIDType":i.timeuuid,"org.apache.cassandra.db.marshal.Int32Type":i.int,"org.apache.cassandra.db.marshal.BytesType":i.blob,"org.apache.cassandra.db.marshal.FloatType":i.float,"org.apache.cassandra.db.marshal.DoubleType":i.double,"org.apache.cassandra.db.marshal.BooleanType":i.boolean,"org.apache.cassandra.db.marshal.InetAddressType":i.inet,"org.apache.cassandra.db.marshal.SimpleDateType":i.date,"org.apache.cassandra.db.marshal.TimeType":i.time,"org.apache.cassandra.db.marshal.ShortType":i.smallint,"org.apache.cassandra.db.marshal.ByteType":i.tinyint,"org.apache.cassandra.db.marshal.DateType":i.timestamp,"org.apache.cassandra.db.marshal.TimestampType":i.timestamp,"org.apache.cassandra.db.marshal.LongType":i.bigint,"org.apache.cassandra.db.marshal.DecimalType":i.decimal,"org.apache.cassandra.db.marshal.IntegerType":i.varint,"org.apache.cassandra.db.marshal.CounterColumnType":i.counter}),w=Object.keys(y).reduce(function(t,e){return e.length>t?e.length:t},0),_="org.apache.cassandra.db.marshal.DurationType",b=h.allocBufferFromArray([255,255,255,255]),v=h.allocBufferFromArray([255,255,255,254]);function E(t,e){this.encodingOptions=e.encoding||h.emptyObject,function(){this.setProtocolVersion=function(t){this.protocolVersion=t,this.decodeCollectionLength=C,this.getLengthBuffer=S,this.collectionLengthSize=4,o.protocolVersion.uses4BytesCollectionLength(this.protocolVersion)||(this.decodeCollectionLength=B,this.getLengthBuffer=T,this.collectionLengthSize=2)};const t={},e={};this.decodeBlob=function(t){return this.handleBuffer(t)},this.decodeCustom=function(e,n){const r=t[n];return r?r.call(this,e):this.handleBuffer(e)},this.decodeDuration=function(t){return o.Duration.fromBuffer(t)},this.decodeUtf8String=function(t){return t.toString("utf8")},this.decodeAsciiString=function(t){return t.toString("ascii")},this.decodeBoolean=function(t){return!!t.readUInt8(0)},this.decodeDouble=function(t){return t.readDoubleBE(0)},this.decodeFloat=function(t){return t.readFloatBE(0)},this.decodeInt=function(t){return t.readInt32BE(0)},this.decodeSmallint=function(t){return t.readInt16BE(0)},this.decodeTinyint=function(t){return t.readInt8(0)},this.decodeLong=function(t){return s.fromBuffer(t)},this.decodeVarint=function(t){return a.fromBuffer(t)},this.decodeDecimal=function(t){return c.fromBuffer(t)},this.decodeTimestamp=function(t){return new Date(this.decodeLong(t).toNumber())},this.decodeDate=function(t){return o.LocalDate.fromBuffer(t)},this.decodeTime=function(t){return o.LocalTime.fromBuffer(t)},this.decodeList=function(t,e){const n=this.decodeCollectionLength(t,0);let r=this.collectionLengthSize;const o=new Array(n);for(let i=0;i<n;i++){const n=this.decodeCollectionLength(t,r);r+=this.collectionLengthSize,o[i]=this.decode(t.slice(r,r+n),e),r+=n}return o},this.decodeSet=function(t,e){const n=this.decodeList(t,e);if(this.encodingOptions.set){const t=this.encodingOptions.set;return new t(n)}return n},this.decodeMap=function(t,e){let n;const r=this.decodeCollectionLength(t,0);let o=this.collectionLengthSize;const i=this;function s(n,s){for(let a=0;a<r;a++){const r=i.decodeCollectionLength(t,o);o+=i.collectionLengthSize;const a=i.decode(t.slice(o,o+r),e[0]);o+=r;const c=i.decodeCollectionLength(t,o);if(o+=i.collectionLengthSize,c<0){n.call(s,a,null);continue}const u=i.decode(t.slice(o,o+c),e[1]);o+=c,n.call(s,a,u)}}if(this.encodingOptions.map){const t=this.encodingOptions.map;s((n=new t).set,n)}else n={},s(function(t,e){n[t]=e});return n},this.decodeUuid=function(t){return new o.Uuid(this.handleBuffer(t))},this.decodeTimeUuid=function(t){return new o.TimeUuid(this.handleBuffer(t))},this.decodeInet=function(t){return new o.InetAddress(this.handleBuffer(t))},this.decodeUdt=function(t,e){const n={};let r=0;for(let o=0;o<e.fields.length&&r<t.length;o++){const i=t.readInt32BE(r);r+=4;const s=e.fields[o];i<0?n[s.name]=null:(n[s.name]=this.decode(t.slice(r,r+i),s.type),r+=i)}return n},this.decodeTuple=function(t,e){const n=new Array(e.length);let r=0;for(let o=0;o<e.length;o++){const i=t.readInt32BE(r);r+=4,i<0?n[o]=null:(n[o]=this.decode(t.slice(r,r+i),e[o]),r+=i)}return new o.Tuple(n)},this.encodeFloat=function(t){if("number"!=typeof t)throw new TypeError("Expected Number, obtained "+r.inspect(t));const e=h.allocBufferUnsafe(4);return e.writeFloatBE(t,0),e},this.encodeDouble=function(t){if("number"!=typeof t)throw new TypeError("Expected Number, obtained "+r.inspect(t));const e=h.allocBufferUnsafe(8);return e.writeDoubleBE(t,0),e},this.encodeTimestamp=function(t){const e=t;if("string"==typeof t&&(t=new Date(t)),t instanceof Date&&(t=t.getTime(),isNaN(t)))throw new TypeError("Invalid date: "+e);return this.encodeLong(t)},this.encodeDate=function(t){const e=t;try{"string"==typeof t&&(t=o.LocalDate.fromString(t)),t instanceof Date&&(t=o.LocalDate.fromDate(t))}catch(t){throw new TypeError("LocalDate could not be parsed "+t)}if(!(t instanceof o.LocalDate))throw new TypeError("Expected Date/String/LocalDate, obtained "+r.inspect(e));return t.toBuffer()},this.encodeTime=function(t){const e=t;try{"string"==typeof t&&(t=o.LocalTime.fromString(t))}catch(t){throw new TypeError("LocalTime could not be parsed "+t)}if(!(t instanceof o.LocalTime))throw new TypeError("Expected String/LocalTime, obtained "+r.inspect(e));return t.toBuffer()},this.encodeUuid=function(t){if("string"==typeof t)try{t=o.Uuid.fromString(t)}catch(t){throw new TypeError(t.message)}if(t instanceof o.Uuid&&(t=t.getBuffer()),!(t instanceof Buffer))throw new TypeError("Not a valid Uuid, expected Uuid/String/Buffer, obtained "+r.inspect(t));return t},this.encodeInet=function(t){if("string"==typeof t&&(t=o.InetAddress.fromString(t)),t instanceof o.InetAddress&&(t=t.getBuffer()),!(t instanceof Buffer))throw new TypeError("Not a valid Inet, expected InetAddress/Buffer, obtained "+r.inspect(t));return t},this.encodeLong=function(t){"number"==typeof t&&(t=s.fromNumber(t)),"string"==typeof t&&(t=s.fromString(t));let e=null;if(t instanceof Buffer&&(e=t),t instanceof s&&(e=s.toBuffer(t)),t instanceof u&&(e=s.toBuffer(t.toImmutable())),null===e)throw new TypeError("Not a valid bigint, expected Long/Number/String/Buffer, obtained "+r.inspect(t));return e},this.encodeVarint=function(t){"number"==typeof t&&(t=a.fromNumber(t)),"string"==typeof t&&(t=a.fromString(t));let e=null;if(t instanceof Buffer&&(e=t),t instanceof a&&(e=a.toBuffer(t)),null===e)throw new TypeError("Not a valid varint, expected Integer/Number/String/Buffer, obtained "+r.inspect(t));return e},this.encodeDecimal=function(t){"number"==typeof t&&(t=c.fromNumber(t)),"string"==typeof t&&(t=c.fromString(t));let e=null;if(t instanceof Buffer&&(e=t),t instanceof c&&(e=c.toBuffer(t)),null===e)throw new TypeError("Not a valid varint, expected BigDecimal/Number/String/Buffer, obtained "+r.inspect(t));return e},this.encodeString=function(t,e){if("string"!=typeof t)throw new TypeError("Not a valid text value, expected String obtained "+r.inspect(t));return h.allocBufferFromString(t,e)},this.encodeUtf8String=function(t){return this.encodeString(t,"utf8")},this.encodeAsciiString=function(t){return this.encodeString(t,"ascii")},this.encodeBlob=function(t){if(!(t instanceof Buffer))throw new TypeError("Not a valid blob, expected Buffer obtained "+r.inspect(t));return t},this.encodeCustom=function(t,n){if(t instanceof Buffer)return t;const r=e[n];if(r)return r.call(this,t);throw new TypeError("No encoding handler found for type "+n)},this.encodeDuration=function(t){if(!(t instanceof o.Duration))throw new TypeError("Not a valid duration, expected Duration/Buffer obtained "+r.inspect(t));return t.toBuffer()},this.encodeBoolean=function(t){return h.allocBufferFromArray([t?1:0])},this.encodeInt=function(t){if(isNaN(t))throw new TypeError("Expected Number, obtained "+r.inspect(t));const e=h.allocBufferUnsafe(4);return e.writeInt32BE(t,0),e},this.encodeSmallint=function(t){if(isNaN(t))throw new TypeError("Expected Number, obtained "+r.inspect(t));const e=h.allocBufferUnsafe(2);return e.writeInt16BE(t,0),e},this.encodeTinyint=function(t){if(isNaN(t))throw new TypeError("Expected Number, obtained "+r.inspect(t));const e=h.allocBufferUnsafe(1);return e.writeInt8(t,0),e},this.encodeList=function(t,e){if(!r.isArray(t))throw new TypeError("Not a valid list value, expected Array obtained "+r.inspect(t));if(0===t.length)return null;const n=[];n.push(this.getLengthBuffer(t));for(let r=0;r<t.length;r++){const i=t[r];if(null===i||void 0===i||i===o.unset)throw new TypeError("A collection can't contain null or unset values");const s=this.encode(i,e);n.push(this.getLengthBuffer(s)),n.push(s)}return Buffer.concat(n)},this.encodeSet=function(t,e){if(this.encodingOptions.set&&t instanceof this.encodingOptions.set){const n=[];return t.forEach(function(t){n.push(t)}),this.encodeList(n,e)}return this.encodeList(t,e)},this.encodeMap=function(t,e){const n=[];let r=0,i=null,s=null;const a=this;function c(t,e){if(null===e||void 0===e||e===o.unset)throw new TypeError("A map can't contain null or unset keys");if(null===t||void 0===t||t===o.unset)throw new TypeError("A map can't contain null or unset values");const c=a.encode(e,i);n.push(a.getLengthBuffer(c)),n.push(c);const u=a.encode(t,s);n.push(a.getLengthBuffer(u)),null!==u&&n.push(u),r++}if(e&&(i=e[0],s=e[1]),this.encodingOptions.map&&t instanceof this.encodingOptions.map)t.forEach(c);else for(const e in t){if(!t.hasOwnProperty(e))continue;const n=t[e];c(n,e)}return n.unshift(this.getLengthBuffer(r)),Buffer.concat(n)},this.encodeUdt=function(t,e){const n=[];let r=0;for(let i=0;i<e.fields.length;i++){const s=e.fields[i],a=this.encode(t[s.name],s.type);if(!a){n.push(b),r+=4;continue}if(a===o.unset){n.push(v),r+=4;continue}const c=h.allocBufferUnsafe(4);c.writeInt32BE(a.length,0),n.push(c),n.push(a),r+=a.length+4}return Buffer.concat(n,r)},this.encodeTuple=function(t,e){const n=[];let r=0;for(let i=0;i<e.length;i++){const s=e[i],a=this.encode(t.get(i),s);if(!a){n.push(b),r+=4;continue}if(a===o.unset){n.push(v),r+=4;continue}const c=h.allocBufferUnsafe(4);c.writeInt32BE(a.length,0),n.push(c),n.push(a),r+=a.length+4}return Buffer.concat(n,r)},this.setRoutingKeyFromUser=function(t,e,n){let o=0;if(r.isArray(e.routingKey)){if(1===e.routingKey.length)return void(e.routingKey=e.routingKey[0]);o=0;for(let t=0;t<e.routingKey.length;t++){const n=e.routingKey[t];if(!n)return void(e.routingKey=null);o+=n.length+3}return void(e.routingKey=I(e.routingKey,o))}if(e.routingKey){if(e.routingKey instanceof Buffer||e.routingKey instanceof l.Token||e.routingKey instanceof l.TokenRange)return;throw new TypeError("Unexpected routingKey '"+r.inspect(e.routingKey)+"' provided.  Expected Buffer, Array<Buffer>, Token, or TokenRange.")}if(!t||0===t.length)return;let i=e.routingIndexes;if(e.routingNames&&(i=e.routingNames.map(t=>n[t])),!i)return;const s=[],a=e.hints||h.emptyArray,c=n?e=>this.encode(t[e].value,a[e]):e=>this.encode(t[e],a[e]);0!==(o=this._encodeRoutingKeyParts(s,i,c))&&(e.routingKey=I(s,o))},this.setRoutingKeyFromMeta=function(t,e,n){if(!n.routingIndexes)return;const r=new Array(n.routingIndexes.length),o=this._encodeRoutingKeyParts(r,n.routingIndexes,n=>{const r=t.columns[n];return this.encode(e[n],r?r.type:null)});0!==o&&(n.routingKey=I(r,o))},this._encodeRoutingKeyParts=function(t,e,n){let r=0;for(let i=0;i<e.length;i++){const s=e[i];if(void 0===s)return 0;const a=n(s);if(null===a||void 0===a||a===o.unset)return 0;r+=a.length+3,t[i]=a}return r},this.parseTypeName=function(t,e,n,r,o,s){n=n||0,r||(r=e.length);const a={code:0,info:null,options:{frozen:!1}};let c;if(e.indexOf("'",n)===n)return a.info=e.substr(n+1,r-2),s(null,a);if(r||(r=e.length),e.indexOf(g.frozen,n)===n&&(n+=g.frozen.length+1,r-=g.frozen.length+2,a.options.frozen=!0),e.indexOf(g.list,n)===n)return n+=g.list.length+1,r-=g.list.length+2,1!==(c=N(e,n,r,"<",">")).length?s(new TypeError("Not a valid type "+e)):(a.code=i.list,this.parseTypeName(t,c[0],0,null,o,function(t,e){if(t)return s(t);a.info=e,s(null,a)}));if(e.indexOf(g.set,n)===n)return n+=g.set.length+1,r-=g.set.length+2,1!==(c=N(e,n,r,"<",">")).length?s(new TypeError("Not a valid type "+e)):(a.code=i.set,this.parseTypeName(t,c[0],0,null,o,function(t,e){if(t)return s(t);a.info=e,s(null,a)}));if(e.indexOf(g.map,n)===n)return n+=g.map.length+1,r-=g.map.length+2,2!==(c=N(e,n,r,"<",">")).length?s(new TypeError("Not a valid type "+e)):(a.code=i.map,this._parseChildTypes(t,a,c,o,s));if(e.indexOf(g.tuple,n)===n){if(n+=g.tuple.length+1,r-=g.tuple.length+2,(c=N(e,n,r,"<",">")).length<1)throw new TypeError("Not a valid type "+e);return a.code=i.tuple,this._parseChildTypes(t,a,c,o,s)}const u=e.indexOf('"',n)===n;u&&(n++,r-=2),n>0&&(e=e.substr(n,r)),u&&(e=e.replace('""','"'));const h=i[e];return"number"==typeof h?(a.code=h,s(null,a)):e===g.duration?(a.info=_,s(null,a)):e===g.empty?(a.info="empty",s(null,a)):void o(t,e,function(t,n){return t?s(t):n?(a.code=i.udt,a.info=n,s(null,a)):void s(new TypeError('Not a valid type "'+e+'"'))})},this._parseChildTypes=function(t,e,n,r,o){const i=this;h.mapSeries(n,function(e,n){i.parseTypeName(t,e.trim(),0,null,r,n)},function(t,n){if(t)return o(t);e.info=n,o(null,e)})},this.parseFqTypeName=function(t,e,n){const r={code:0,info:null,options:{reversed:!1,frozen:!1}};let o;if(e=e||0,n||(n=t.length),n>m.reversed.length&&t.indexOf(m.reversed)===e&&(e+=m.reversed.length+1,n-=m.reversed.length+2,r.options.reversed=!0),n>m.frozen.length&&t.indexOf(m.frozen,e)===e&&(e+=m.frozen.length+1,n-=m.frozen.length+2,r.options.frozen=!0),t===m.empty)return r.info="empty",r;if(n<=w){e>0&&(t=t.substr(e,n));const o=y[t];if("number"==typeof o)return r.code=o,r;throw new TypeError('Not a valid type "'+t+'"')}if(t.indexOf(m.list,e)===e){if(e+=m.list.length+1,n-=m.list.length+2,1!==(o=N(t,e,n)).length)throw new TypeError("Not a valid type "+t);return r.code=i.list,r.info=this.parseFqTypeName(o[0]),r}if(t.indexOf(m.set,e)===e){if(e+=m.set.length+1,n-=m.set.length+2,1!==(o=N(t,e,n)).length)throw new TypeError("Not a valid type "+t);return r.code=i.set,r.info=this.parseFqTypeName(o[0]),r}if(t.indexOf(m.map,e)===e){if(e+=m.map.length+1,n-=m.map.length+2,2!==(o=N(t,e,n)).length)throw new TypeError("Not a valid type "+t);return r.code=i.map,r.info=[this.parseFqTypeName(o[0]),this.parseFqTypeName(o[1])],r}if(t.indexOf(m.udt,e)===e)return e+=m.udt.length+1,n-=m.udt.length+2,this._parseUdtName(t,e,n);if(t.indexOf(m.tuple,e)===e){if(e+=m.tuple.length+1,n-=m.tuple.length+2,(o=N(t,e,n)).length<1)throw new TypeError("Not a valid type "+t);return r.code=i.tuple,r.info=o.map(t=>this.parseFqTypeName(t)),r}return r.info=t.substr(e,n),r},this.parseKeyTypes=function(t){let e=0,n=t.length;const r=0===t.indexOf(m.composite);r&&(e=m.composite.length+1,n--);const o=[];let i=e,s=0,a=!1,c=!1;for(;++e<n;)switch(t[e]){case",":if(s>0)break;a&&(i=t.indexOf(":",i)+1),o.push(t.substring(i,e)),i=e+1;break;case"(":if(0===s&&t.indexOf(m.collection,i)===i){a=!0,c=!0,i=++e;break}s++;break;case")":if(a&&0===s){o.push(t.substring(t.indexOf(":",i)+1,e)),i=e+1;break}s--}return i<n&&o.push(t.substring(i,n)),{types:o.map(t=>this.parseFqTypeName(t)),hasCollections:c,isComposite:r}},this._parseUdtName=function(t,e,n){const r=N(t,e,n);if(r.length<2)throw new TypeError("Not a valid type "+t);const o={code:i.udt,info:null},s={keyspace:r[0],name:h.allocBufferFromString(r[1],"hex").toString(),fields:[]};for(let t=2;t<r.length;t++){const e=r[t],n=e.indexOf(":"),o=this.parseFqTypeName(e,n+1,e.length-(n+1));s.fields.push({name:h.allocBufferFromString(e.substr(0,n),"hex").toString(),type:o})}return o.info=s,o},t[_]=this.decodeDuration,e[_]=this.encodeDuration}.call(this),this.setProtocolVersion(t),function(){this.decoders={[i.custom]:this.decodeCustom,[i.ascii]:this.decodeAsciiString,[i.bigint]:this.decodeLong,[i.blob]:this.decodeBlob,[i.boolean]:this.decodeBoolean,[i.counter]:this.decodeLong,[i.decimal]:this.decodeDecimal,[i.double]:this.decodeDouble,[i.float]:this.decodeFloat,[i.int]:this.decodeInt,[i.text]:this.decodeUtf8String,[i.timestamp]:this.decodeTimestamp,[i.uuid]:this.decodeUuid,[i.varchar]:this.decodeUtf8String,[i.varint]:this.decodeVarint,[i.timeuuid]:this.decodeTimeUuid,[i.inet]:this.decodeInet,[i.date]:this.decodeDate,[i.time]:this.decodeTime,[i.smallint]:this.decodeSmallint,[i.tinyint]:this.decodeTinyint,[i.list]:this.decodeList,[i.map]:this.decodeMap,[i.set]:this.decodeSet,[i.udt]:this.decodeUdt,[i.tuple]:this.decodeTuple},this.encoders={[i.custom]:this.encodeCustom,[i.ascii]:this.encodeAsciiString,[i.bigint]:this.encodeLong,[i.blob]:this.encodeBlob,[i.boolean]:this.encodeBoolean,[i.counter]:this.encodeLong,[i.decimal]:this.encodeDecimal,[i.double]:this.encodeDouble,[i.float]:this.encodeFloat,[i.int]:this.encodeInt,[i.text]:this.encodeUtf8String,[i.timestamp]:this.encodeTimestamp,[i.uuid]:this.encodeUuid,[i.varchar]:this.encodeUtf8String,[i.varint]:this.encodeVarint,[i.timeuuid]:this.encodeUuid,[i.inet]:this.encodeInet,[i.date]:this.encodeDate,[i.time]:this.encodeTime,[i.smallint]:this.encodeSmallint,[i.tinyint]:this.encodeTinyint,[i.list]:this.encodeList,[i.map]:this.encodeMap,[i.set]:this.encodeSet,[i.udt]:this.encodeUdt,[i.tuple]:this.encodeTuple}}.call(this),this.encodingOptions.copyBuffer?this.handleBuffer=k:this.handleBuffer=x}function T(t){if(!t)return f;const e=h.allocBufferUnsafe(2);return"number"==typeof t?e.writeUInt16BE(t,0):e.writeUInt16BE(t.length,0),e}function S(t){if(!t)return d;const e=h.allocBufferUnsafe(4);return"number"==typeof t?e.writeInt32BE(t,0):e.writeInt32BE(t.length,0),e}function k(t){return null===t?null:h.copyBuffer(t)}function x(t){return t}function C(t,e){return t.readInt32BE(e)}function B(t,e){return t.readUInt16BE(e)}function N(t,e,n,r,o){r=r||"(",o=o||")";const i=[];let s=e,a=0;for(let c=e;c<e+n;c++){const e=t[c];e===r&&a++,e===o&&a--,0===a&&","===e&&(i.push(t.substr(s,c-s)),s=c+1)}return i.push(t.substr(s,n-(s-e))),i}function I(t,e){if(0===e)return null;if(1===t.length)return t[0];const n=h.allocBufferUnsafe(e);let r=0;for(let e=0;e<t.length;e++){const o=t[e];n.writeUInt16BE(o.length,r),r+=2,o.copy(n,r),n[r+=o.length]=0,r++}return n}E.prototype.decode=function(t,e){if(null===t)return null;const n=this.decoders[e.code];if(!n)throw new Error("Unknown data type: "+e.code);return n.call(this,t,e.info)},E.prototype.encode=function(t,e){if(void 0===t&&(t=null,this.encodingOptions.useUndefinedAsUnset&&this.protocolVersion>=4&&(t=o.unset)),null===t)return t;if(t===o.unset){if(!o.protocolVersion.supportsUnset(this.protocolVersion))throw new TypeError("Unset value can not be used for this version of Cassandra, protocol version: "+this.protocolVersion);return t}let n={code:null,info:null};if(e){if("number"==typeof e?n.code=e:"string"==typeof e&&(n=i.getByName(e)),"number"==typeof e.code&&(n.code=e.code,n.info=e.info),"number"!=typeof n.code)throw new TypeError("Type information not valid, only String and Number values are valid hints")}else if(!(n=E.guessDataType(t)))throw new TypeError("Target data type could not be guessed, you should use prepared statements for accurate type mapping. Value: "+r.inspect(t));const s=this.encoders[n.code];if(!s)throw new Error("Type not supported "+n.code);return s.call(this,t,n.info)},E.guessDataType=function(t){let e=null,n=null;const u=typeof t;return"number"===u?e=i.double:"string"===u?(e=i.text,36===t.length&&p.test(t)&&(e=i.uuid)):"boolean"===u?e=i.boolean:t instanceof Buffer?e=i.blob:t instanceof Date?e=i.timestamp:t instanceof s?e=i.bigint:t instanceof a?e=i.varint:t instanceof c?e=i.decimal:t instanceof o.Uuid?e=i.uuid:t instanceof o.InetAddress?e=i.inet:t instanceof o.Tuple?e=i.tuple:t instanceof o.LocalDate?e=i.date:t instanceof o.LocalTime?e=i.time:t instanceof o.Duration?(e=i.custom,n=_):r.isArray(t)&&(e=i.list),null===e?null:{code:e,info:n}},t.exports=E},function(t,e,n){"use strict";const r=n(6),o=new i(1,0,0,0);function i(t,e,n,r){this._arr=[65535&t,65535&e,65535&n,65535&r]}i.fromNumber=function(t){if(isNaN(t)||!isFinite(t))return new i;if(t<0)return i.fromNumber(-t).negate();const e=t%4294967296,n=t/4294967296;return i.fromBits(e,n)},i.fromBits=function(t,e){return new i(t,t>>>16,e,e>>>16)},i.fromString=function(t,e){if("string"!=typeof t)throw new Error("String format is not valid: "+t);if(0===t.length)throw Error("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return new i;if((e=e||10)<2||e>36)throw Error("radix out of range: "+e);let n;if((n=t.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+t);if(0===n)return i.fromString(t.substring(1),e).negate();const r=i.fromNumber(Math.pow(e,8)),o=new i;for(let n=0;n<t.length;n+=8){const s=Math.min(8,t.length-n),a=parseInt(t.substring(n,n+s),e);if(s<8){const t=i.fromNumber(Math.pow(e,s));o.multiply(t).add(i.fromNumber(a));break}o.multiply(r),o.add(i.fromNumber(a))}return o},i.prototype.toString=function(){return this.toImmutable().toString()},i.prototype.compare=function(t){const e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this._compareBits(t)},i.prototype._compareBits=function(t){for(let e=3;e>=0;e--){if(this._arr[e]>t._arr[e])return 1;if(this._arr[e]<t._arr[e])return-1}return 0},i.prototype.getUint16=function(t){return this._arr[t]},i.prototype.getLowBitsUnsigned=function(){return(this._arr[0]|(65535&this._arr[1])<<16)>>>0},i.prototype.getHighBitsUnsigned=function(){return(this._arr[2]|this._arr[3]<<16)>>>0},i.prototype.toNumber=function(){return 4294967296*(this._arr[3]<<16|this._arr[2])+((this._arr[1]<<16|this._arr[0])>>>0)},i.prototype.not=function(){return this._arr[0]=65535&~this._arr[0],this._arr[1]=65535&~this._arr[1],this._arr[2]=65535&~this._arr[2],this._arr[3]=65535&~this._arr[3],this},i.prototype.add=function(t){let e=0,n=0,r=0,o=0;return o+=this._arr[0]+t._arr[0],this._arr[0]=65535&o,r+=o>>>16,r+=this._arr[1]+t._arr[1],this._arr[1]=65535&r,n+=r>>>16,n+=this._arr[2]+t._arr[2],this._arr[2]=65535&n,e+=n>>>16,e+=this._arr[3]+t._arr[3],this._arr[3]=65535&e,this},i.prototype.shiftLeft=function(t){if(0===t)return this;if(t>=64)return this.toZero();const e=t%16,n=Math.floor(t/16);return n>0&&(this._arr[3]=this._arr[3-n],this._arr[2]=n>2?0:this._arr[2-n],this._arr[1]=n>1?0:this._arr[0],this._arr[0]=0),e>0&&(this._arr[3]=65535&(this._arr[3]<<e|this._arr[2]>>>16-e),this._arr[2]=65535&(this._arr[2]<<e|this._arr[1]>>>16-e),this._arr[1]=65535&(this._arr[1]<<e|this._arr[0]>>>16-e),this._arr[0]=this._arr[0]<<e&65535),this},i.prototype.shiftRightUnsigned=function(t){if(0===t)return this;if(t>=64)return this.toZero();const e=t%16,n=Math.floor(t/16);return n>0&&(this._arr[0]=this._arr[n],this._arr[1]=n>2?0:this._arr[1+n],this._arr[2]=n>1?0:this._arr[3],this._arr[3]=0),e>0&&(this._arr[0]=this._arr[0]>>>e|this._arr[1]<<16-e&65535,this._arr[1]=this._arr[1]>>>e|this._arr[2]<<16-e&65535,this._arr[2]=this._arr[2]>>>e|this._arr[3]<<16-e&65535,this._arr[3]=this._arr[3]>>>e),this},i.prototype.or=function(t){return this._arr[0]|=t._arr[0],this._arr[1]|=t._arr[1],this._arr[2]|=t._arr[2],this._arr[3]|=t._arr[3],this},i.prototype.xor=function(t){return this._arr[0]^=t._arr[0],this._arr[1]^=t._arr[1],this._arr[2]^=t._arr[2],this._arr[3]^=t._arr[3],this},i.prototype.clone=function(){return new i(this._arr[0],this._arr[1],this._arr[2],this._arr[3])},i.prototype.multiply=function(t){if(this.isZero()||t.isZero())return this.toZero();if(this.isNegative())return t.isNegative()?this.negate().multiply(t.clone().negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.clone().negate()).negate();let e=0,n=0,r=0,o=0;return r+=(o+=this._arr[0]*t._arr[0])>>>16,n+=(r+=this._arr[1]*t._arr[0])>>>16,r&=65535,n+=(r+=this._arr[0]*t._arr[1])>>>16,e+=(n+=this._arr[2]*t._arr[0])>>>16,n&=65535,e+=(n+=this._arr[1]*t._arr[1])>>>16,n&=65535,e+=(n+=this._arr[0]*t._arr[2])>>>16,e+=this._arr[3]*t._arr[0]+this._arr[2]*t._arr[1]+this._arr[1]*t._arr[2]+this._arr[0]*t._arr[3],this._arr[0]=65535&o,this._arr[1]=65535&r,this._arr[2]=65535&n,this._arr[3]=65535&e,this},i.prototype.toZero=function(){return this._arr[3]=this._arr[2]=this._arr[1]=this._arr[0]=0,this},i.prototype.isZero=function(){return 0===this._arr[3]&&0===this._arr[2]&&0===this._arr[1]&&0===this._arr[0]},i.prototype.isNegative=function(){return(32768&this._arr[3])>0},i.prototype.negate=function(){return this.not().add(o)},i.prototype.equals=function(t){return t instanceof i&&(this._arr[0]===t._arr[0]&&this._arr[1]===t._arr[1]&&this._arr[2]===t._arr[2]&&this._arr[3]===t._arr[3])},i.prototype.toImmutable=function(){return r.fromBits(this.getLowBitsUnsigned(),this.getHighBitsUnsigned(),!1)},t.exports=i},function(t,e,n){"use strict";const r=n(0),o=n(3),i=n(1),s=n(24);class a{constructor(t,e){this._client=t,this._loadBalancing=e,this.logEmitter=t.options.logEmitter,this.log=i.log}static getPrepared(t,e,n,r,o){const i=t.metadata.getPreparedInfo(r,n);if(i.queryId)return o(null,i.queryId,i.meta);i.once("prepared",o),i.preparing||new a(t,e)._prepare(i,n,r)}static getPreparedMultiple(t,e,n,r,s){const c=new Array(n.length);i.forEachOf(n,function(n,s,u){let h;if(n&&(h="string"==typeof n?n:n.query),"string"!=typeof h)return u(new o.ArgumentError("Query item should be a string"));a.getPrepared(t,e,h,r,function(t,e,r){if(t)return u(t);c[s]={query:h,params:i.adaptNamedParamsPrepared(n.params,r.columns),queryId:e,meta:r},u()})},function(t){if(t)return s(t);s(null,c)})}_prepare(t,e,n){t.preparing=!0;const r=this;this._loadBalancing.newQueryPlan(n,null,function(o,i){if(o)return t.preparing=!1,t.emit("prepared",o);r._prepareWithQueryPlan(t,i,null,e,n)})}_prepareWithQueryPlan(t,e,n,r,o){n=n||{};const i=this;s.borrowNextConnection(e,n,this._client.profileManager,o,function(s,a,c){if(s)return i._onPrepareError(s,c,n,t,e,r,o);a.prepareOnce(r,function(s,a){return s?i._onPrepareError(s,c,n,t,e,r,o):i._client.options.prepareOnAllHosts?i._prepareOnAllHosts(t,a,c,e,r,o):void i._onPrepareSuccess(t,a)})})}_onPrepareSuccess(t,e){t.preparing=!1,t.queryId=e.id,t.meta=e.meta,this._client.metadata.setPreparedById(t),t.emit("prepared",null,t.queryId,t.meta)}_onPrepareError(t,e,n,r,i,s,a){if(t.isSocketError||t instanceof o.OperationTimedOutError){const o=this;return n[e.address]=t,o._prepareWithQueryPlan(r,i,n,s,a)}return r.preparing=!1,t.query=s,r.emit("prepared",t)}static prepareAllQueries(t,e,n){const r=[],o={};e.forEach(function(t){let e=r;t.keyspace&&(e=o[t.keyspace]=o[t.keyspace]||[]),e.push(t.query)}),i.eachSeries(Object.keys(o),function(e,n){a._borrowAndPrepare(t,e,o[e],n)},function(e){if(e)return n(e);a._borrowAndPrepare(t,null,r,n)})}static _borrowAndPrepare(t,e,n,r){if(0===n.length)return r();s.borrowFromHost(t,e,function(t,e){if(t)return r(t);i.each(n,function(t,n){e.prepareOnce(t,n)},r)})}_prepareOnAllHosts(t,e,n,o,a,c){const u=this;i.each(i.iteratorToArray(o),function(t,e){if(t.address===n.address)return e();s.borrowFromHost(t,c,function(n,o){if(n)return e();o.prepareOnce(a,function(n){return n&&u.log("verbose",r.format("Unexpected error while preparing query (%s) on %s",a,t.address)),e()})})},function(){u._onPrepareSuccess(t,e)})}}t.exports=a},function(t,e,n){"use strict";const r=n(0),o=n(3),i=n(2),s=n(1),a=n(58);class c{constructor(t,e,n){this.client=n,this.loadBalancingPolicy=e.executionProfile.loadBalancing,this.retryPolicy=e.retry,this._speculativeExecutionPlan=n.options.policies.speculativeExecution.newPlan(n.keyspace,t.query||t.queries),this.logEmitter=n.options.logEmitter,this.log=s.log,this.request=t,this.requestOptions=e,this.stackContainer=null,this.triedHosts={},this.speculativeExecutions=-1,this._hostIterator=null,this._callback=null,this._newExecutionTimeout=null,this._executions=[]}static borrowNextConnection(t,e,n,r,i){e=e||{};const s=c._getNextHost(t,n,e);if(null===s)return i(new o.NoHostAvailableError(e));c.borrowFromHost(s,r,function(o,a){if(o)return e[s.address]=o,a&&s.removeFromPool(a),process.nextTick(()=>c.borrowNextConnection(t,e,n,r,i));e[s.address]=null,i(null,a,s)})}static borrowFromHost(t,e,n){t.borrowConnection(function(t,r){return t?n(t):e&&e!==r.keyspace?void r.changeKeyspace(e,function(t){if(t)return n(t,r);n(null,r)}):n(null,r)})}static _getNextHost(t,e,n){let r;for(;;){const o=t.next();if(o.done)return null;if(r=o.value,e.getDistance(r)!==i.distance.ignored){if(r.isUp())break;n[r.address]="Host considered as DOWN"}}return r}static send(t,e,n,r){new c(t,e,n).send(r)}getNextConnection(t){c.borrowNextConnection(this._hostIterator,this.triedHosts,this.client.profileManager,this.client.keyspace,t)}send(t){this.requestOptions.captureStackTrace&&Error.captureStackTrace(this.stackContainer={});const e=this;this.loadBalancingPolicy.newQueryPlan(this.client.keyspace,this.requestOptions,function(n,r){if(n)return t(n);e._hostIterator=r,e._callback=t,e._startNewExecution()})}_startNewExecution(){const t=new a(this);this._executions.push(t);const e=this;t.start(function(n){if(!e.requestOptions.isIdempotent)return;const r=e._speculativeExecutionPlan.nextExecution(n);return"number"!=typeof r||r<0?void 0:0===r?process.nextTick(function(){t.wasCancelled()||e._startNewExecution()}):void(e._newExecutionTimeout=setTimeout(()=>e._startNewExecution(),r))})}static setKeyspace(t,e){let n;const r=t.hosts.values();for(let t=0;t<r.length;t++){if(n=r[t].getActiveConnection())break}if(!n)return e(new o.DriverInternalError("No active connection found"));n.changeKeyspace(t.keyspace,e)}setCompleted(t,e){null!==this._newExecutionTimeout&&clearTimeout(this._newExecutionTimeout);for(let t=0;t<this._executions.length;t++)this._executions[t].cancel();if(t)return this.requestOptions.captureStackTrace&&s.fixStack(this.stackContainer.stack,t),this._callback(t);e.info.warnings&&e.info.warnings.forEach(function(t,e,n){this.log("warning",r.format('Received warning (%d of %d) "%s" for "%s"',e+1,n.length,t,this.request.query||"batch"))},this),this._callback(null,e)}handleNoHostAvailable(t,e){const n=this._executions.indexOf(e);this._executions.splice(n,1),0===this._executions.length&&this.setCompleted(t)}}t.exports=c},function(t,e,n){"use strict";const r=n(4),o=n(0),i=n(59),s=n(1),a=n(3),c=n(2),u=n(5),h=n(60),l=n(7).TokenRange;function p(t,e){if(!t)throw new a.ArgumentError("Options are not defined");Object.defineProperty(this,"options",{value:t,enumerable:!1,writable:!1}),Object.defineProperty(this,"controlConnection",{value:e,enumerable:!1,writable:!1}),this.keyspaces={},this.initialized=!1,this._schemaParser=h.getByVersion(e,this.getUdt.bind(this));const n=this;this._preparedQueries=new f(t.maxPrepared,function(){n.log.apply(n,arguments)})}function f(t,e){this.length=0,this._maxPrepared=t,this._mapByKey={},this._mapById={},this._logger=e}p.prototype.setCassandraVersion=function(t){this._schemaParser=h.getByVersion(this.controlConnection,this.getUdt.bind(this),t,this._schemaParser)},p.prototype.setPartitioner=function(t){return/RandomPartitioner$/.test(t)?this.tokenizer=new i.RandomTokenizer:/ByteOrderedPartitioner$/.test(t)?this.tokenizer=new i.ByteOrderedTokenizer:this.tokenizer=new i.Murmur3Tokenizer},p.prototype.buildTokens=function(t){if(!this.tokenizer)return this.log("error","Tokenizer could not be determined");const e=[],n={},r=t.values(),o=this.tokenizer.stringify,i={};r.forEach(t=>{if(!t.tokens)return;t.tokens.forEach(r=>{const i=this.tokenizer.parse(r);s.insertSorted(e,i,(t,e)=>t.compare(e)),n[o(i)]=t});let r=i[t.datacenter];r||(r=i[t.datacenter]={hostLength:0,racks:new s.HashSet}),r.hostLength++,r.racks.add(t.rack)}),this.primaryReplicas=n,this.ring=e;const a=new Set;if(1===this.ring.length){const t=this.tokenizer.minToken();a.add(new l(t,t,this.tokenizer))}else for(let t=0;t<this.ring.length;t++){const e=this.ring[t],n=this.ring[(t+1)%this.ring.length];a.add(new l(e,n,this.tokenizer))}this.tokenRanges=a,this.ringTokensAsStrings=new Array(e.length);for(let t=0;t<e.length;t++)this.ringTokensAsStrings[t]=o(e[t]);this.datacenters=i},p.prototype.refreshKeyspace=function(t,e){return s.promiseWrapper.call(this,this.options,e,function(e){this._refreshKeyspaceCb(t,e)})},p.prototype._refreshKeyspaceCb=function(t,e){if(!this.initialized)return e(this._uninitializedError(),null);this.log("info",o.format("Retrieving keyspace %s metadata",t));const n=this;this._schemaParser.getKeyspace(t,function(r,o){return r?(n.log("error","There was an error while trying to retrieve keyspace information",r),e(r)):o?(n.keyspaces[o.name]=o,void e(null,o)):(delete n.keyspaces[t],e())})},p.prototype.refreshKeyspaces=function(t,e){return"function"!=typeof t&&void 0!==t||(e=t,t=!0),this._refreshKeyspaces(t,!1,e)},p.prototype._refreshKeyspaces=function(t,e,n){return s.promiseWrapper.call(this,this.options,n,function(n){this._refreshKeyspacesCb(t,e,n)})},p.prototype._refreshKeyspacesCb=function(t,e,n){if(!e&&!this.initialized)return n(this._uninitializedError(),null);this.log("info","Retrieving keyspaces metadata");const r=this;this._schemaParser.getKeyspaces(t,function(t,e){if(t)return r.log("error","There was an error while trying to retrieve keyspaces information",t),n(t);r.keyspaces=e,n(null,e)})},p.prototype._getKeyspaceReplicas=function(t){return t.replicas||(t.replicas=t.tokenToReplica(this.tokenizer,this.ringTokensAsStrings,this.primaryReplicas,this.datacenters)),t.replicas},p.prototype.getReplicas=function(t,e){if(!this.ring)return null;let n;if(Buffer.isBuffer(e)&&(e=this.tokenizer.hash(e)),e instanceof l&&(e=e.end),t&&!(n=this.keyspaces[t]))return null;let r=s.binarySearch(this.ring,e,(t,e)=>t.compare(e));r<0&&(r=~r),r>=this.ring.length&&(r%=this.ring.length);const o=this.ringTokensAsStrings[r];return t?this._getKeyspaceReplicas(n)[o]:[this.primaryReplicas[o]]},p.prototype.getTokenRanges=function(){return this.tokenRanges},p.prototype.getTokenRangesForHost=function(t,e){if(!this.ring)return null;let n;if(t&&!(n=this.keyspaces[t]))return null;if(1===this.ring.length)return this.getTokenRanges();const r=this._getKeyspaceReplicas(n),o=new Set;return this.tokenRanges.forEach(t=>{-1!==r[this.tokenizer.stringify(t.end)].indexOf(e)&&o.add(t)}),o},p.prototype.newToken=function(t){if(!this.tokenizer)throw new Error("Partitioner not established.  This should only happen if metadata was disabled or you have not connected yet.");return o.isArray(t)?this.tokenizer.hash(Buffer.concat(t)):o.isString(t)?this.tokenizer.parse(t):this.tokenizer.hash(t)},p.prototype.newTokenRange=function(t,e){if(!this.tokenizer)throw new Error("Partitioner not established.  This should only happen if metadata was disabled or you have not connected yet.");return new l(t,e,this.tokenizer)},p.prototype.log=s.log,p.prototype.getPreparedInfo=function(t,e){return this._preparedQueries.getOrAdd(t,e)},p.prototype.clearPrepared=function(){this._preparedQueries.clear()},p.prototype.getPreparedById=function(t){return this._preparedQueries.getById(t)},p.prototype.setPreparedById=function(t){return this._preparedQueries.setById(t)},p.prototype.getAllPrepared=function(){return this._preparedQueries.getAll()},p.prototype._uninitializedError=function(){return new Error("Metadata has not been initialized.  This could only happen if you have not connected yet.")},p.prototype.getUdt=function(t,e,n){return s.promiseWrapper.call(this,this.options,n,function(n){this._getUdtCb(t,e,n)})},p.prototype._getUdtCb=function(t,e,n){if(!this.initialized)return n(this._uninitializedError(),null);let r;if(this.options.isMetadataSyncEnabled){const e=this.keyspaces[t];if(!e)return n(null,null);r=e.udts}this._schemaParser.getUdt(t,e,r,n)},p.prototype.getTable=function(t,e,n){return s.promiseWrapper.call(this,this.options,n,function(n){this._getTableCb(t,e,n)})},p.prototype._getTableCb=function(t,e,n){if(!this.initialized)return n(this._uninitializedError(),null);let r;if(this.options.isMetadataSyncEnabled){const e=this.keyspaces[t];if(!e)return n(null,null);r=e.tables}this._schemaParser.getTable(t,e,r,n)},p.prototype.getFunctions=function(t,e,n){return s.promiseWrapper.call(this,this.options,n,function(n){this._getFunctionsCb(t,e,n)})},p.prototype._getFunctionsCb=function(t,e,n){if("function"!=typeof n)throw new a.ArgumentError("Callback is not a function");if(!t||!e)return n(new a.ArgumentError("You must provide the keyspace name and cql function name to retrieve the metadata"));this._getFunctions(t,e,!1,function(t,e){if(t)return n(t,null);n(null,s.objectValues(e))})},p.prototype.getFunction=function(t,e,n,r){return s.promiseWrapper.call(this,this.options,r,function(r){this._getSingleFunctionCb(t,e,n,!1,r)})},p.prototype.getAggregates=function(t,e,n){return s.promiseWrapper.call(this,this.options,n,function(n){this._getAggregatesCb(t,e,n)})},p.prototype._getAggregatesCb=function(t,e,n){if("function"!=typeof n)throw new a.ArgumentError("Callback is not a function");if(!t||!e)return n(new a.ArgumentError("You must provide the keyspace name and cql aggregate name to retrieve the metadata"));this._getFunctions(t,e,!0,function(t,e){if(t)return n(t,null);n(null,s.objectValues(e))})},p.prototype.getAggregate=function(t,e,n,r){return s.promiseWrapper.call(this,this.options,r,function(r){this._getSingleFunctionCb(t,e,n,!0,r)})},p.prototype.getMaterializedView=function(t,e,n){return s.promiseWrapper.call(this,this.options,n,function(n){this._getMaterializedViewCb(t,e,n)})},p.prototype._getMaterializedViewCb=function(t,e,n){if(!this.initialized)return n(this._uninitializedError(),null);let r;if(this.options.isMetadataSyncEnabled){const e=this.keyspaces[t];if(!e)return n(null,null);r=e.views}this._schemaParser.getMaterializedView(t,e,r,n)},p.prototype._getFunctions=function(t,e,n,r){if(!this.initialized)return r(this._uninitializedError(),null);let o;if(this.options.isMetadataSyncEnabled){const e=this.keyspaces[t];if(!e)return r(null,null);o=n?e.aggregates:e.functions}this._schemaParser.getFunctions(t,e,n,o,r)},p.prototype._getSingleFunctionCb=function(t,e,n,r,i){if("function"!=typeof i)throw new a.ArgumentError("Callback is not a function");if(!t||!e)return i(new a.ArgumentError("You must provide the keyspace name and cql function name to retrieve the metadata"));if(!o.isArray(n))return i(new a.ArgumentError("Signature must be an array of types"));try{n=n.map(function(t){return"string"==typeof t?t:c.getDataTypeNameByCode(t)})}catch(t){return i(t)}this._getFunctions(t,e,r,function(t,e){if(t)return i(t,null);let r;e&&(r=e["("+n.join(",")+")"]),i(null,r||null)})},p.prototype.getTrace=function(t,e,n){return n||"function"!=typeof e||(n=e,e=null),s.promiseWrapper.call(this,this.options,n,function(n){this._getTraceCb(t,e,n)})},p.prototype._getTraceCb=function(t,e,n){if(!this.initialized)return n(this._uninitializedError(),null);let r,i=0;const a={consistency:e},c=new u.QueryRequest(o.format("SELECT * FROM system_traces.sessions WHERE session_id=%s",t),null,a),h=new u.QueryRequest(o.format("SELECT * FROM system_traces.events WHERE session_id=%s",t),null,a),l=this;s.whilst(function(){return!r&&i++<5},function(t){l.controlConnection.query(c,function(e,n){if(e)return t(e);const o=n.rows[0];if(!o||!o.duration)return setTimeout(t,200);r={requestType:o.request,coordinator:o.coordinator,parameters:o.parameters,startedAt:o.started_at,duration:o.duration,clientAddress:o.client,events:[]},l.controlConnection.query(h,function(e,n){if(e)return t(e);n.rows.forEach(function(t){r.events.push({id:t.event_id,activity:t.activity,source:t.source,elapsed:t.source_elapsed,thread:t.thread})}),t()})})},function(e){e||r||(e=new Error(o.format("Trace %s could not fully retrieved after %d attempts",t,5))),n(e,r)})},p.prototype.adaptUserHints=function(t,e,n){if(!o.isArray(e))return n();const r=[];function i(e){if(e.code!==c.dataTypes.udt){if(e.info)return e.code===c.dataTypes.list||e.code===c.dataTypes.set?i(e.info):void(e.code===c.dataTypes.map&&(i(e.info[0]),i(e.info[1])))}else{const n=e.info.split(".");if(e.info={keyspace:n[0],name:n[1]},!e.info.name){if(!t)throw new TypeError("No keyspace specified for udt: "+n.join("."));e.info.name=e.info.keyspace,e.info.keyspace=t}r.push(e)}}for(let t=0;t<e.length;t++){const r=e[t];if("string"==typeof r)try{const o=c.dataTypes.getByName(r);i(o),e[t]=o}catch(t){return n(t)}}const a=this;s.each(r,function(t,e){a.getUdt(t.info.keyspace,t.info.name,function(n,r){return n?e(n):r?(t.info=r,void e()):e(new TypeError("User defined type not found: "+t.info.keyspace+"."+t.info.name))})},n)},p.prototype.getLocalSchemaVersion=function(t,e){const n=new u.QueryRequest("SELECT schema_version FROM system.local",null,null);t.sendStream(n,s.emptyObject,function(t,n){let r;!t&&n&&n.rows&&1===n.rows.length&&(r=n.rows[0].schema_version),e(t,r)})},p.prototype.getPeersSchemaVersions=function(t,e){const n=new u.QueryRequest("SELECT schema_version FROM system.peers",null,null);t.sendStream(n,s.emptyObject,function(t,n){const r=[];if(!t&&n&&n.rows)for(let t=0;t<n.rows.length;t++){const e=n.rows[t].schema_version;e&&r.push(e)}e(t,r)})},f.prototype._getKey=function(t,e){return(t||"")+e},f.prototype.getOrAdd=function(t,e){const n=this._getKey(t,e);let o=this._mapByKey[n];return o||(this._validateOverflow(),(o=new r.EventEmitter).setMaxListeners(0),o.query=e,o.keyspace=t,this._mapByKey[n]=o,this.length++,o)},f.prototype._validateOverflow=function(){if(this.length<this._maxPrepared)return;const t=[];this._logger("warning","Prepared statements exceeded maximum. This could be caused by preparing queries that contain parameters");const e=Object.keys(this._mapByKey);for(let n=0;n<e.length&&this.length-t.length<this._maxPrepared;n++){const r=this._mapByKey[e[n]];r.queryId&&t.push(r)}t.forEach(function(t){delete this._mapByKey[t.query],delete this._mapById[t.queryId],this.length--},this)},f.prototype.setById=function(t){this._mapById[t.queryId.toString("hex")]=t},f.prototype.getById=function(t){return this._mapById[t.toString("hex")]},f.prototype.clear=function(){this._mapByKey={},this._mapById={},this.length=0},f.prototype.getAll=function(){return s.objectValues(this._mapByKey).filter(function(t){return!!t.queryId})},t.exports=p},function(t,e,n){"use strict";const r=n(0),o=n(4);function i(t){o.EventEmitter.call(this),this.setMaxListeners(0),Object.defineProperty(this,"loading",{value:!1,enumerable:!1,writable:!0}),Object.defineProperty(this,"loaded",{value:!1,enumerable:!1,writable:!0}),this.name=t,this.bloomFilterFalsePositiveChance=0,this.caching=null,this.comment=null,this.gcGraceSeconds=0,this.compactionClass=null,this.compactionOptions=null,this.compression=null,this.localReadRepairChance=0,this.readRepairChance=0,this.extensions=null,this.crcCheckChance=null,this.populateCacheOnFlush=!1,this.defaultTtl=0,this.speculativeRetry="NONE",this.minIndexInterval=128,this.maxIndexInterval=2048,this.columns=null,this.columnsByName=null,this.partitionKeys=[],this.clusteringKeys=[],this.clusteringOrder=[]}r.inherits(i,o.EventEmitter),t.exports=i},function(t,e,n){"use strict";function r(){}function o(){}r.prototype.newAuthenticator=function(t,e){throw new Error("This is an abstract class, you must implement newAuthenticator method or use another auth provider that inherits from this class")},o.prototype.initialResponse=function(t){t(new Error("Not implemented"))},o.prototype.evaluateChallenge=function(t,e){e(new Error("Not implemented"))},o.prototype.onAuthenticationSuccess=function(t){},e.AuthProvider=r,e.Authenticator=o},function(t,e,n){t.exports=n(29)},function(t,e,n){const r=n(30);let o={contactPoints:process.env.sunbird_cassandra_urls?process.env.sunbird_cassandra_urls.split(","):["localhost"]};const i=new r.Client(o);let s=[],a={created_on:new Date};i.execute("Select last_modified_on,created_on From qmzbm_form_service.form_data;").then(t=>{console.log("nothing to migrate"),process.exit(1)}).catch(t=>{console.log("migrating form data");i.execute("SELECT * FROM sunbird.tenant_preference").then(t=>{console.log("no. of records to migrate:",t.rows.length),t.rows.forEach(t=>{if(t&&t.key&&3===t.key.split(".").length){let e=Object.assign({},a);if(e.root_org=t.orgid,t.key&&t.key.length?(e.type=t.key.split(".")[0],e.subtype=t.key.split(".")[1],e.action=t.key.split(".")[2]):(e.type="*",e.subtype="*",e.action="*"),e.component="*",t.data){if("string"==typeof t.data)try{t.data=JSON.parse(t.data)}catch(e){console.log("JSON parse error! :"),console.log("row.key",t.key),console.log("row.orgid",t.orgid),console.log("row.data",t.data)}"object"==typeof t.data?Object.keys(t.data).forEach(n=>{e.framework="default"===n?"*":n,e.data=t.data[n],s.push({...e})}):(e.data=t.data,e.framework="*",s.push(e))}}})}).then(async t=>{await i.execute("DROP KEYSPACE IF EXISTS qmzbm_form_service"),await i.execute("CREATE KEYSPACE IF NOT EXISTS qmzbm_form_service WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 }"),await i.execute("CREATE TABLE IF NOT EXISTS qmzbm_form_service.form_data (\n      root_org text,\n      framework text,\n      type text,\n      subtype text,\n      action text,\n      component text,\n      created_on timestamp,\n      data text,\n      last_modified_on timestamp,\n      PRIMARY KEY ((root_org, framework, type, subtype, action, component)))   \n    ");for(const t of s){let e="INSERT INTO qmzbm_form_service.form_data(root_org, framework, type, subtype, action, component, created_on, last_modified_on, data) values(?,?,?,?,?,?,?,?,?)";await i.execute(e,[t.root_org,t.framework,t.type,t.subtype,t.action,t.component,t.created_on,t.last_modified_on,JSON.stringify(t.data)],{prepare:!0})}console.log("no. of records migrated after denorm:",s.length),process.exit(1)}).catch(t=>{console.log(t),process.exit(1)})}),process.on("unhandledRejection",(t,e)=>{console.log("Unhandled Rejection at: Promise",e,"reason:",t)})},function(t,e,n){"use strict";const r=n(8);e.Client=n(48),e.ExecutionProfile=n(17).ExecutionProfile,e.types=n(2),e.errors=n(3),e.policies=n(11),e.auth=n(67);const o=n(7);e.token={Token:o.Token,TokenRange:o.TokenRange};const i=n(25);e.metadata={Metadata:i},e.Encoder=n(21),e.defaultOptions=function(){return r.defaultOptions()},e.version=n(10).version},function(t,e,n){"use strict";const r=n(12),o=n(0),i=n(1);function s(){}function a(){}s.prototype.translate=function(t,e,n){n(t+":"+e)},o.inherits(a,s),a.prototype.translate=function(t,e,n){let o=t;const s=this;let a;i.series([function(e){r.reverse(t,function(t,n){return t?e(t):n?(a=n[0],void e()):e()})},function(t){if(!a)return t();r.lookup(a,function(e,n){if(e)return t(e);o=n,t()})}],function(r){r&&s.logError(t,r),n(o+":"+e)})},a.prototype.logError=function(t,e){},e.AddressTranslator=s,e.EC2MultiRegionTranslator=a},function(t,e,n){"use strict";const r=n(0),o=n(2),i=n(1),s=n(3),a=Object.freeze({done:!0});function c(){}function u(){this.index=0}function h(t,e){this.localDc=t,this.usedHostsPerRemoteDc=e||0,this.index=0,this.localHostsArray=null,this.remoteHostsArray=null}function l(t){if(!t)throw new Error("You must specify a child load balancing policy");this.childPolicy=t}function p(t,e,n,r){this.keyspace=t,this.childPolicy=r,this.queryOptions=e,this.localReplicas=[],this.replicaIndex=0,this.replicaMap={},this.childIterator=null;for(let t=0;t<n.length;t++){const e=n[t];this.childPolicy.getDistance(e)===o.distance.local&&(this.replicaMap[e.address]=!0,this.localReplicas.push(e))}this.startIndex=Math.floor(Math.random()*this.localReplicas.length)}function f(t,e){if(!t)throw new Error("You must specify a child load balancing policy");if(!r.isArray(e))throw new Error("You must provide the white list of host addresses");this.childPolicy=t;const n={};e.forEach(function(t){n[t]=!0}),this.whiteList=n}c.prototype.init=function(t,e,n){this.client=t,this.hosts=e,n()},c.prototype.getDistance=function(t){return o.distance.local},c.prototype.newQueryPlan=function(t,e,n){n(new Error("You must implement a query plan for the LoadBalancingPolicy class"))},r.inherits(u,c),u.prototype.newQueryPlan=function(t,e,n){if(!this.hosts)return n(new Error("Load balancing policy not initialized"));const r=this.hosts.values(),o=this;let s=0,c=o.index%r.length;o.index+=1,o.index>=i.maxInt&&(o.index=0),n(null,{next:function(){return++s>r.length?a:{value:r[c++%r.length],done:!1}}})},r.inherits(h,c),h.prototype.init=function(t,e,n){if(this.client=t,this.hosts=e,e.on("add",this._cleanHostCache.bind(this)),e.on("remove",this._cleanHostCache.bind(this)),!this.localDc){const r=e.values();let o;for(let t=0;t<r.length;t++){const e=r[t];if(e.datacenter){this.localDc=e.datacenter,o=e;break}}if(!this.localDc)return n(new s.DriverInternalError("Local datacenter could not be determined"));t.log("warning","No local Data Center was provided with DCAwareRoundRobinPolicy.  Using discovered DC '"+this.localDc+"' from host "+o.address+".  Future releases will require local DC to be specified.")}n()},h.prototype.getDistance=function(t){return t.datacenter?t.datacenter===this.localDc?o.distance.local:o.distance.remote:o.distance.ignored},h.prototype._cleanHostCache=function(){this.localHostsArray=null,this.remoteHostsArray=null},h.prototype._sliceNodesByDc=function(){const t=this.hosts.values();if(this.remoteHostsArray)return;const e={};this.localHostsArray=[],this.remoteHostsArray=[],t.forEach(function(t){if(!t.datacenter)return;if(t.datacenter===this.localDc)return void this.localHostsArray.push(t);if(0===this.usedHostsPerRemoteDc)return;let n=e[t.datacenter];n||(e[t.datacenter]=n=[]),n.length<this.usedHostsPerRemoteDc&&(n.push(t),this.remoteHostsArray.push(t))},this)},h.prototype.newQueryPlan=function(t,e,n){if(!this.hosts)return n(new Error("Load balancing policy not initialized"));this.index+=1,this.index>=i.maxInt&&(this.index=0),this._sliceNodesByDc();const r=this.localHostsArray,o=this.remoteHostsArray;let s=this.index,c=this.index,u=0,h=0;n(null,{next:function(){let t;return u++<r.length?{value:t=r[s++%r.length],done:!1}:h++<o.length?{value:t=o[c++%o.length],done:!1}:a}})},r.inherits(l,c),l.prototype.init=function(t,e,n){this.client=t,this.hosts=e,this.childPolicy.init(t,e,n)},l.prototype.getDistance=function(t){return this.childPolicy.getDistance(t)},l.prototype.newQueryPlan=function(t,e,n){let r,o;if(e&&(r=e.routingKey,e.keyspace&&(t=e.keyspace)),r&&(o=this.client.getReplicas(t,r)),!r||!o)return this.childPolicy.newQueryPlan(t,e,n);new p(t,e,o,this.childPolicy).iterate(n)},p.prototype.iterate=function(t){const e=this;this.childPolicy.newQueryPlan(this.keyspace,this.queryOptions,function(n,r){if(n)return t(n);e.childIterator=r,t(null,{next:function(){return e.computeNext()}})})},p.prototype.computeNext=function(){let t,e;if(this.replicaIndex<this.localReplicas.length)return{value:t=this.localReplicas[(this.startIndex+this.replicaIndex++)%this.localReplicas.length],done:!1};for(;(e=this.childIterator.next())&&!e.done;)if(!this.replicaMap[e.value.address])return e;return a},r.inherits(f,c),f.prototype.init=function(t,e,n){this.childPolicy.init(t,e,n)},f.prototype.getDistance=function(t){return this._contains(t)?this.childPolicy.getDistance(t):o.distance.ignored},f.prototype._contains=function(t){return!!this.whiteList[t.address]},f.prototype.newQueryPlan=function(t,e,n){const r=this;this.childPolicy.newQueryPlan(t,e,function(t,e){if(t)return n(t);n(null,r._filter(e))})},f.prototype._filter=function(t){const e=this;return{next:function(){const n=t.next();return n.done||e._contains(n.value)?n:this.next()}}},e.DCAwareRoundRobinPolicy=h,e.LoadBalancingPolicy=c,e.RoundRobinPolicy=u,e.TokenAwarePolicy=l,e.WhiteListPolicy=f},function(t,e,n){"use strict";const r=n(0),o=n(9),i=n(6),s=n(13),a=n(1),c=122192928e5,u=1e4;let h=0,l=0,p=0;function f(t,e,n,r){let o;if(t instanceof Buffer){if(16!==t.length)throw new Error("Buffer for v1 uuid not valid");o=t}else o=function(t,e,n,r){const o=function(t,e){if(!(t instanceof Date)||isNaN(t.getTime())){const n=(t=new Date).getTime();(++l>u||n>p)&&(l=0,p=n),e=l}return{time:t.getTime(),ticks:function(t){("number"!=typeof t||t>=u)&&(++h>=u&&(h=0),t=h);return t}(e)}}(t,e);n=function(t){let e=t;"string"==typeof t&&(e=a.allocBufferFromString(t,"ascii"));if(e instanceof Buffer){if(6!==e.length)throw new Error("Node identifier must have 6 bytes")}else e=d(6);return e}(n),r=function(t){let e=t;"string"==typeof t&&(e=a.allocBufferFromString(t,"ascii"));if(e instanceof Buffer){if(2!==e.length)throw new Error("Clock identifier must have 2 bytes")}else e=d(2);return e}(r);const s=a.allocBufferUnsafe(16);return function(t,e,n){const r=i.fromNumber(e+c).multiply(i.fromNumber(1e4)).add(i.fromNumber(n)),o=r.getHighBitsUnsigned();t.writeUInt32BE(r.getLowBitsUnsigned(),0),t.writeUInt16BE(65535&o,4),t.writeUInt16BE(o>>>16&65535,6)}(s,o.time,o.ticks),r.copy(s,8,0),n.copy(s,10,0),s[6]=15&s[6],s[6]=16|s[6],s[8]=63&s[8],s[8]=128|s[8],s}(t,e,n,r);s.call(this,o)}function d(t){return o.randomBytes(t)}r.inherits(f,s),f.fromDate=function(t,e,n,r){return new f(t,e,n,r)},f.fromString=function(t){return new f(s.fromString(t).getBuffer())},f.min=function(t,e){return new f(t,e,a.allocBufferFromString("808080808080","hex"),a.allocBufferFromString("8080","hex"))},f.max=function(t,e){return new f(t,e,a.allocBufferFromString("7f7f7f7f7f7f","hex"),a.allocBufferFromString("7f7f","hex"))},f.now=function(t,e){return new f(null,null,t,e)},f.prototype.getDatePrecision=function(){const t=this.buffer.readUInt32BE(0);let e=0;e|=(255&this.buffer[4])<<8,e|=255&this.buffer[5],e|=(15&this.buffer[6])<<24,e|=(255&this.buffer[7])<<16;const n=i.fromBits(t,e),r=i.fromNumber(u),o=n.modulo(r),s=n.div(r).subtract(i.fromNumber(c));return{date:new Date(s.toNumber()),ticks:o.toNumber()}},f.prototype.getDate=function(){return this.getDatePrecision().date},f.prototype.getNodeId=function(){return this.buffer.slice(10)},f.prototype.getNodeIdString=function(){return this.buffer.slice(10).toString("ascii")},t.exports=f},function(t,e,n){"use strict";const r=n(1),o=n(35),i=o.parse("2.0.0"),s=o.parse("2.1.0"),a=o.parse("2.2.0"),c=o.parse("3.0.0"),u={v1:1,v2:2,v3:3,v4:4,v5:5,maxSupported:4,minSupported:1,isSupported:function(t){return t<=4&&t>=1},supportsPreparedPartitionKey:function(t){return t>=this.v4},supportsSchemaChangeFullMetadata:function(t){return t>=this.v3},supportsPaging:function(t){return t>=this.v2},supportsTimestamp:function(t){return t>=this.v3},supportsNamedParameters:function(t){return t>=this.v3},supportsUnset:function(t){return t>=this.v4},uses2BytesStreamIds:function(t){return t>=this.v3},uses4BytesCollectionLength:function(t){return t>=this.v3},canStartupResponseErrorBeWrapped:function(t){return t>=this.v4},getLowerSupported:function(t){return t>=this.v5?this.v4:t<=this.v1?0:t-1},getHighestCommon:function(t,e){const n=t.log?t.log.bind(t):r.noop;let u=t.protocolVersion,h=!1,l=u;if(e.forEach(t=>{if(t.cassandraVersion&&0!==t.cassandraVersion.length)try{const e=o.parse(t.cassandraVersion);n("verbose","Encountered host "+t.address+" with cassandra version "+e),e.compare(c)>=0?(h=!0,u=Math.min(this.v4,u),l=u):e.compare(a)>=0?(u=Math.min(this.v4,u),l=u):e.compare(s)>=0?(u=Math.min(this.v3,u),l=u):u=e.compare(i)>=0?Math.min(this.v2,u):this.v1}catch(e){n("warning","Encountered host "+t.address+" with unparseable cassandra version "+t.cassandraVersion+" skipping as part of protocol version evaluation")}else n("warning","Encountered host "+t.address+" with no cassandra version, skipping as part of protocol version evaluation")}),h&&u<this.v3){const e=". This should not be possible as nodes within a cluster can't be separated by more than one major version";l<this.v3?n("error","Detected hosts that require at least protocol version 0x3, but currently connected to "+t.address+":"+t.port+" using protocol version 0x"+l+". Will not be able to connect to these hosts"+e):n("error","Detected hosts with maximum protocol version of 0x"+u.toString(16)+" but there are some hosts that require at least version 0x3. Will not be able to connect to these older hosts"+e),u=l}return n("verbose","Resolved protocol version 0x"+u.toString(16)+" as the highest common protocol version among hosts"),u}};t.exports=u},function(t,e,n){"use strict";const r=/(\d+)\.(\d+)(?:\.(\d+))?(?:\.(\d+)?)?(?:[-~]([\w+]*(?:-\w[.\w]*)*))?(?:\+([.\w]+))?/;class o{constructor(t,e,n,r,o,i){this.major=t,this.minor=e,this.patch=n,this.dsePatch=r,this.preReleases=o,this.build=i}toString(){let t=this.major+"."+this.minor;return void 0!==this.patch&&(t+="."+this.patch),void 0!==this.dsePatch&&(t+="."+this.dsePatch),void 0!==this.preReleases&&this.preReleases.forEach(e=>{t+="-"+e}),this.build&&(t+="+"+this.build),t}compare(t){if(this.major<t.major)return-1;if(this.major>t.major)return 1;if(this.minor<t.minor)return-1;if(this.minor>t.minor)return 1;const e=this.patch||0,n=t.patch||0;if(e<n)return-1;if(e>n)return 1;if(void 0===this.dsePatch){if(void 0!==t.dsePatch)return-1}else{if(void 0===t.dsePatch)return 1;if(this.dsePatch<t.dsePatch)return-1;if(this.dsePatch>t.dsePatch)return 1}if(void 0===this.preReleases){if(void 0!==t.preReleases)return 1}else if(void 0===t.preReleases)return-1;return 0}static parse(t){if(!t)return null;const e=t.match(r);if(e){const t=parseInt(e[1],10),n=parseInt(e[2],10),r=e[3]?parseInt(e[3],10):void 0,i=e[4]?parseInt(e[4],10):void 0,s=e[5]?e[5].split("-"):void 0,a=e[6];return new o(t,n,r,i,s,a)}throw new TypeError("Could not extract version from '"+t+"'")}}t.exports=o},function(t,e,n){"use strict";const r=n(14),o=n(1);function i(t,e){"number"==typeof t&&(t=r.fromNumber(t)),this._intVal=t,this._scale=e}i.fromBuffer=function(t){const e=t.readInt32BE(0);return new i(r.fromBuffer(t.slice(4)),e)},i.toBuffer=function(t){const e=r.toBuffer(t._intVal),n=o.allocBufferUnsafe(4);return n.writeInt32BE(t._scale,0),Buffer.concat([n,e],n.length+e.length)},i.fromString=function(t){if(!t)throw new TypeError("Invalid null or undefined value");const e=(t=t.trim()).indexOf(".");let n=0;return e>=0&&(n=t.length-1-e,t=t.substr(0,e)+t.substr(e+1)),new i(r.fromString(t),n)},i.fromNumber=function(t){if(isNaN(t))return new i(r.ZERO,0);let e=t.toString();return e.indexOf("e")>=0&&(e=t.toFixed(20)),i.fromString(e)},i.prototype.equals=function(t){return t instanceof i&&0===this.compare(t)},i.prototype.inspect=function(){return this.constructor.name+": "+this.toString()},i.prototype.notEquals=function(t){return!this.equals(t)},i.prototype.compare=function(t){const e=this.subtract(t);return e.isNegative()?-1:e.isZero()?0:1},i.prototype.subtract=function(t){const e=this;if(e._scale===t._scale)return new i(e._intVal.subtract(t._intVal),e._scale);let n,o;return e._scale<t._scale?(n=t._scale-e._scale,new i(o=e._intVal.multiply(r.fromNumber(Math.pow(10,n))).subtract(t._intVal),t._scale)):(n=e._scale-t._scale,new i(o=e._intVal.subtract(t._intVal.multiply(r.fromNumber(Math.pow(10,n)))),e._scale))},i.prototype.add=function(t){const e=this;if(e._scale===t._scale)return new i(e._intVal.add(t._intVal),e._scale);let n,o;return e._scale<t._scale?(n=t._scale-e._scale,new i(o=e._intVal.multiply(r.fromNumber(Math.pow(10,n))).add(t._intVal),t._scale)):(n=e._scale-t._scale,new i(o=e._intVal.add(t._intVal.multiply(r.fromNumber(Math.pow(10,n)))),e._scale))},i.prototype.greaterThan=function(t){return 1===this.compare(t)},i.prototype.isNegative=function(){return this._intVal.isNegative()},i.prototype.isZero=function(){return this._intVal.isZero()},i.prototype.toString=function(){let t=this._intVal.toString();if(0===this._scale)return t;let e="";"-"===t.charAt(0)&&(e="-",t=t.substr(1));let n=t.length-this._scale;return n<=0&&(n=(t=o.stringRepeat("0",1-n)+t).length-this._scale),e+t.substr(0,n)+"."+t.substr(n)},i.prototype.toNumber=function(){return parseFloat(this.toString())},i.prototype.toJSON=function(){return this.toString()},t.exports=i},function(t,e,n){"use strict";const r=n(6),o=n(0),i=n(1),s={months:i.allocBuffer(9),days:i.allocBuffer(9),nanoseconds:i.allocBuffer(9)},a=r.fromInt(1e3),c=a,u=a.multiply(c),h=a.multiply(u),l=r.fromInt(60).multiply(h),p=r.fromInt(60).multiply(l),f=/(\d+)(y|mo|w|d|h|s|ms|us|s|ns|m)/gi,d=/P((\d+)Y)?((\d+)M)?((\d+)D)?(T((\d+)H)?((\d+)M)?((\d+)S)?)?/,m=/P(\d+)W/,g=/P(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/;function y(t,e,n){this.months=t,this.days=e,this.nanoseconds="number"==typeof n?r.fromNumber(n):n}function w(t){this._isNegative=t,this._unitIndex=0,this._months=0,this._days=0,this._nanoseconds=r.ZERO,this._addMethods={y:this.addYears,mo:this.addMonths,w:this.addWeeks,d:this.addDays,h:this.addHours,m:this.addMinutes,s:this.addSeconds,ms:this.addMillis,"s":this.addMicros,us:this.addMicros,ns:this.addNanos},this._unitByIndex=[null,"years","months","weeks","days","hours","minutes","seconds","milliseconds","microseconds","nanoseconds"]}y.prototype.equals=function(t){return t instanceof y&&(this.months===t.months&&this.days===t.days&&this.nanoseconds.equals(t.nanoseconds))},y.prototype.toBuffer=function(){const t=_.writeVInt(r.fromNumber(this.months),s.months),e=_.writeVInt(r.fromNumber(this.days),s.days),n=_.writeVInt(this.nanoseconds,s.nanoseconds),o=i.allocBufferUnsafe(t+e+n);s.months.copy(o,0,0,t);let a=t;return s.days.copy(o,a,0,e),a+=e,s.nanoseconds.copy(o,a,0,n),o},y.prototype.toString=function(){let t="";function e(e,n,r){return 0===e||e<n?e:(t+=(e/n).toFixed(0)+r,e%n)}function n(e,n,o){return e.equals(r.ZERO)||e.lessThan(n)?e:(t+=e.divide(n).toString()+o,e.modulo(n))}(this.months<0||this.days<0||this.nanoseconds.isNegative())&&(t="-");let o=e(Math.abs(this.months),12,"y");if(e(o,1,"mo"),e(Math.abs(this.days),1,"d"),!this.nanoseconds.equals(r.ZERO)){n(o=n(o=n(o=n(o=n(o=n(this.nanoseconds.isNegative()?this.nanoseconds.negate():this.nanoseconds,p,"h"),l,"m"),h,"s"),u,"ms"),c,"us"),r.ONE,"ns")}return t},y.fromBuffer=function(t){const e={value:0};return new y(_.readVInt(t,e).toNumber(),_.readVInt(t,e).toNumber(),_.readVInt(t,e))},y.fromString=function(t){const e="-"===t.charAt(0),n=e?t.substr(1):t;return"P"===n.charAt(0)?"W"===n.charAt(n.length-1)?function(t,e){const n=m.exec(e);if(!n||n[0]!==e)throw new TypeError(o.format("Unable to convert '%s' to a duration",e));return new w(t).addWeeks(n[1]).build()}(e,n):n.indexOf("-")>0?function(t,e){const n=g.exec(e);if(!n||n[0]!==e)throw new TypeError(o.format("Unable to convert '%s' to a duration",e));return new w(t).addYears(n[1]).addMonths(n[2]).addDays(n[3]).addHours(n[4]).addMinutes(n[5]).addSeconds(n[6]).build()}(e,n):function(t,e){const n=d.exec(e);if(!n||n[0]!==e)throw new TypeError(o.format("Unable to convert '%s' to a duration",e));const r=new w(t);n[1]&&r.addYears(n[2]);n[3]&&r.addMonths(n[4]);n[5]&&r.addDays(n[6]);n[7]&&(n[8]&&r.addHours(n[9]),n[10]&&r.addMinutes(n[11]),n[12]&&r.addSeconds(n[13]));return r.build()}(e,n):function(t,e){const n=new w(t);let r;f.lastIndex=0;for(;(r=f.exec(e))&&r.length<=3;)n.add(r[1],r[2]);return n.build()}(e,n)},w.prototype._validateOrder=function(t){if(t===this._unitIndex)throw new TypeError(o.format("Invalid duration. The %s are specified multiple times",this._getUnitName(t)));if(t<=this._unitIndex)throw new TypeError(o.format("Invalid duration. The %s should be after %s",this._getUnitName(this._unitIndex),this._getUnitName(t)));this._unitIndex=t},w.prototype._validateMonths=function(t,e){this._validate32(t,(2147483647-this._months)/e,"months")},w.prototype._validateDays=function(t,e){this._validate32(t,(2147483647-this._days)/e,"days")},w.prototype._validateNanos=function(t,e){this._validate64(t,r.MAX_VALUE.subtract(this._nanoseconds).divide(e),"nanoseconds")},w.prototype._validate32=function(t,e,n){if(t>e)throw new TypeError(o.format("Invalid duration. The total number of %s must be less or equal to %s",n,2147483647))},w.prototype._validate64=function(t,e,n){if(t.greaterThan(e))throw new TypeError(o.format("Invalid duration. The total number of %s must be less or equal to %s",n,r.MAX_VALUE.toString()))},w.prototype._getUnitName=function(t){const e=this._unitByIndex[+t];if(!e)throw new Error("unknown unit index: "+t);return e},w.prototype.add=function(t,e){const n=this._addMethods[e.toLowerCase()];if(!n)throw new TypeError(o.format("Unknown duration symbol '%s'",e));return n.call(this,t)},w.prototype.addYears=function(t){const e=+t;return this._validateOrder(1),this._validateMonths(e,12),this._months+=12*e,this},w.prototype.addMonths=function(t){const e=+t;return this._validateOrder(2),this._validateMonths(e,1),this._months+=e,this},w.prototype.addWeeks=function(t){const e=+t;return this._validateOrder(3),this._validateDays(e,7),this._days+=7*e,this},w.prototype.addDays=function(t){const e=+t;return this._validateOrder(4),this._validateDays(e,1),this._days+=e,this},w.prototype.addHours=function(t){const e="string"==typeof t?r.fromString(t):t;return this._validateOrder(5),this._validateNanos(e,p),this._nanoseconds=this._nanoseconds.add(e.multiply(p)),this},w.prototype.addMinutes=function(t){const e="string"==typeof t?r.fromString(t):t;return this._validateOrder(6),this._validateNanos(e,l),this._nanoseconds=this._nanoseconds.add(e.multiply(l)),this},w.prototype.addSeconds=function(t){const e="string"==typeof t?r.fromString(t):t;return this._validateOrder(7),this._validateNanos(e,h),this._nanoseconds=this._nanoseconds.add(e.multiply(h)),this},w.prototype.addMillis=function(t){const e="string"==typeof t?r.fromString(t):t;return this._validateOrder(8),this._validateNanos(e,u),this._nanoseconds=this._nanoseconds.add(e.multiply(u)),this},w.prototype.addMicros=function(t){const e="string"==typeof t?r.fromString(t):t;return this._validateOrder(9),this._validateNanos(e,c),this._nanoseconds=this._nanoseconds.add(e.multiply(c)),this},w.prototype.addNanos=function(t){const e="string"==typeof t?r.fromString(t):t;return this._validateOrder(10),this._validateNanos(e,r.ONE),this._nanoseconds=this._nanoseconds.add(e),this},w.prototype.build=function(){return this._isNegative?new y(-this._months,-this._days,this._nanoseconds.negate()):new y(this._months,this._days,this._nanoseconds)};const _=function(){return{readVInt:function(t,e){return function(t){return t.shiftRightUnsigned(1).xor(t.and(r.ONE).negate())}(function(t,e){const n=t[e.value++];if(0==(128&n))return r.fromInt(n);const o=function(t){return t>127?t-256:t}(n),i=function(t){return function(t){if(0===t)return 32;let e=1;return t>>>16==0&&(e+=16,t<<=16),t>>>24==0&&(e+=8,t<<=8),t>>>28==0&&(e+=4,t<<=4),t>>>30==0&&(e+=2,t<<=2),e-=t>>>31}(~t)-24}(o);let s=r.fromInt(o&function(t){return 255>>t}(i));for(let n=0;n<i;n++){const n=r.fromInt(t[e.value++]);s=s.shiftLeft(8).or(n)}return s}(t,e))},writeVInt:function(t,e){return function(t,e){const n=function(t){return 639-9*function(t){if(t.equals(r.ZERO))return 64;let e=1,n=t.getHighBits();return 0===n&&(e+=32,n=t.getLowBits()),n>>>16==0&&(e+=16,n<<=16),n>>>24==0&&(e+=8,n<<=8),n>>>28==0&&(e+=4,n<<=4),n>>>30==0&&(e+=2,n<<=2),e-=n>>>31}(t.or(r.ONE))>>6}(t);return 1===n?(e[0]=t.getLowBits(),1):(function(t,e,n){const r=e-1;let o,i=t.getLowBits(),s=4;for(o=r;o>=0&&s-- >0;o--)n[o]=255&i,i>>=8;for(i=t.getHighBits();o>=0;o--)n[o]=255&i,i>>=8;n[0]|=function(t){return~(255>>t)}(r)}(t,n,e),n)}(function(t){return t.toUnsigned().shiftLeft(1).xor(t.shiftRight(63))}(t),e)}}}();t.exports=y},function(t,e,n){"use strict";const r=n(1);function o(t){if(!(t instanceof Buffer)||4!==t.length&&16!==t.length)throw new TypeError("The ip address must contain 4 or 16 bytes");this.buffer=t,this.length=t.length,this.version=4===t.length?4:6}o.fromString=function(t){if(!t)return new o(r.allocBufferFromArray([0,0,0,0]));const e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;let n;if(e.test(t))return n=t.split("."),new o(r.allocBufferFromArray(n));if(!/^[\da-f:.]+$/i.test(t))throw new TypeError("Value could not be parsed as InetAddress: "+t);if((n=t.split(":")).length<3)throw new TypeError("Value could not be parsed as InetAddress: "+t);const i=r.allocBufferUnsafe(16);let s=8-n.length+1,a=!1,c=0;const u=e.test(n[n.length-1]);function h(t){i.writeUInt8(+t,c++)}u&&(s-=1);for(let t=0;t<n.length;t++){const e=n[t];if(e){if(u&&t===n.length-1){e.split(".").forEach(h);break}i.writeUInt16BE(parseInt(e,16),c),c+=2}else{a&&(s=1),a=!0;for(let t=0;t<s;t++)i[c++]=0,i[c++]=0}}if(u&&!function(t){for(let e=0;e<t.length-6;e++)if(0!==t[e])return!1;return!(255!==t[10]||255!==t[11])}(i))throw new TypeError("Only IPv4-Mapped IPv6 addresses are allowed as IPv6 address with embedded IPv4 address");return new o(i)},o.prototype.equals=function(t){return t instanceof o&&(this.buffer.length===t.buffer.length&&this.buffer.toString("hex")===t.buffer.toString("hex"))},o.prototype.getBuffer=function(){return this.buffer},o.prototype.inspect=function(){return this.constructor.name+": "+this.toString()},o.prototype.toString=function(t){if("hex"===t)return this.buffer.toString("hex");if(4===this.buffer.length)return this.buffer[0]+"."+this.buffer[1]+"."+this.buffer[2]+"."+this.buffer[3];let e=-1;const n={length:0,start:-1};function r(t){if(e>=0){const r=t-e;r>n.length&&(n.length=r,n.start=e,e=-1)}}for(let t=0;t<this.buffer.length;t+=2)0!==this.buffer[t]||0!==this.buffer[t+1]?r(t):(e<0&&(e=t),t===this.buffer.length-2&&r(t+2));let o="";for(let t=0;t<this.buffer.length;t+=2)t!==n.start?t<n.start+n.length&&t>n.start||(o.length>0&&(o+=":"),o+=(this.buffer[t]<<8|this.buffer[t+1]).toString(16)):o+=":";return":"===o.charAt(o.length-1)&&(o+=":"),o},o.prototype.toJSON=function(){return this.toString()},t.exports=o},function(t,e,n){"use strict";const r=n(0),o=n(1),i=864e5,s=Math.pow(2,31);function a(t,e,n){if("number"==typeof t&&"number"==typeof e&&"number"==typeof n){if(this.date=new Date,this.date.setUTCHours(0,0,0,0),this.date.setUTCFullYear(t,e-1,n),isNaN(this.date.getTime()))throw new Error(r.format("%d-%d-%d does not form a valid ES5 date!",t,e,n))}else if(void 0===e&&void 0===n&&"number"==typeof t){if(t<-2147483648||t>2147483647)throw new Error("You must provide a valid value for days since epoch (-2147483648 <= value <= 2147483647).");this.date=new Date(t*i)}if(void 0===this.date)throw new Error("You must provide a valid year, month and day");this._value=isNaN(this.date.getTime())?t:null,this.year=this.date.getUTCFullYear(),this.month=this.date.getUTCMonth()+1,this.day=this.date.getUTCDate()}function c(t,e){return t.length>=e?t:o.stringRepeat("0",e-t.length)+t}a.now=function(){return a.fromDate(new Date)},a.utcNow=function(){return new a(Date.now())},a.fromDate=function(t){if(isNaN(t.getTime()))throw new TypeError("Invalid date: "+t);return new a(t.getFullYear(),t.getMonth()+1,t.getDate())},a.fromString=function(t){if((t.match(/-/g)||[]).length>=2){let e=1;"-"===t[0]&&(t=t.substring(1),e=-1);const n=t.split("-");return new a(e*parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10))}if(t.match(/^-?\d+$/))return new a(parseInt(t,10));throw new Error("Invalid input '"+t+"'.")},a.fromBuffer=function(t){return new a(t.readUInt32BE(0)-s)},a.prototype.compare=function(t){const e=(isNaN(this.date.getTime())?this._value*i:this.date.getTime())-(isNaN(t.date.getTime())?t._value*i:t.date.getTime());return e<0?-1:e>0?1:0},a.prototype.equals=function(t){return t instanceof a&&0===this.compare(t)},a.prototype.inspect=function(){return this.constructor.name+": "+this.toString()},a.prototype.toBuffer=function(){const t=(isNaN(this.date.getTime())?this._value:Math.floor(this.date.getTime()/i))+s,e=o.allocBufferUnsafe(4);return e.writeUInt32BE(t,0),e},a.prototype.toString=function(){let t;return isNaN(this.date.getTime())?this._value.toString():(t=this.year<0?"-"+c((-1*this.year).toString(),4):c(this.year.toString(),4),t+="-"+c(this.month.toString(),2)+"-"+c(this.day.toString(),2))},a.prototype.toJSON=function(){return this.toString()},t.exports=a},function(t,e,n){"use strict";const r=n(6),o=n(0),i=n(1),s=r.fromString("86399999999999"),a=r.fromNumber(1e9),c=r.fromNumber(1e6);function u(t){if(!(t instanceof r))throw new Error("You must specify a Long value as totalNanoseconds");if(t.lessThan(r.ZERO)||t.greaterThan(s))throw new Error("Total nanoseconds out of range");this.value=t,this.hour=this._getParts()[0],this.minute=this._getParts()[1],this.second=this._getParts()[2],this.nanosecond=this._getParts()[3]}u.fromString=function(t){if("string"!=typeof t)throw new Error("Argument type invalid: "+o.inspect(t));const e=t.split(":");let n,r=36e5*parseInt(e[0],10)+6e4*parseInt(e[1],10);if(3===e.length){const t=e[2].split(".");r+=1e3*parseInt(t[0],10),2===t.length&&(n=t[1],n+=i.stringRepeat("0",9-n.length))}return u.fromMilliseconds(r,parseInt(n,10)||0)},u.now=function(t){return u.fromDate(new Date,t)},u.fromDate=function(t,e){if(!o.isDate(t))throw new Error("Not a valid date");const n=(t.getTime()+-6e4*t.getTimezoneOffset())%864e5;return u.fromMilliseconds(n,e)},u.fromMilliseconds=function(t,e){return"number"!=typeof e&&(e=0),new u(r.fromNumber(t).multiply(c).add(r.fromNumber(e)))},u.fromBuffer=function(t){if(!(t instanceof Buffer))throw new TypeError("Expected Buffer, obtained "+o.inspect(t));return new u(new r(t.readInt32BE(4),t.readInt32BE(0)))},u.prototype.compare=function(t){return this.value.compare(t.value)},u.prototype.equals=function(t){return t instanceof u&&0===this.compare(t)},u.prototype.getTotalNanoseconds=function(){return this.value},u.prototype.inspect=function(){return this.constructor.name+": "+this.toString()},u.prototype.toBuffer=function(){const t=i.allocBufferUnsafe(8);return t.writeUInt32BE(this.value.getHighBitsUnsigned(),0),t.writeUInt32BE(this.value.getLowBitsUnsigned(),4),t},u.prototype.toString=function(){return function(t){let e;e=t[0]<10?"0"+t[0]+":":t[0]+":";t[1]<10?e+="0"+t[1]+":":e+=t[1]+":";t[2]<10?e+="0"+t[2]:e+=t[2];if(t[3]>0){let n,r=t[3].toString();r.length<9&&(r=i.stringRepeat("0",9-r.length)+r);for(let t=r.length-1;t>0&&"0"===r[t];t--)n=t;n&&(r=r.substring(0,n)),e+="."+r}return e}(this._getParts())},u.prototype.toJSON=function(){return this.toString()},u.prototype._getParts=function(){if(!this._partsCache){const t=[0,0,0,0],e=this.value.div(a);t[3]=this.value.subtract(e.multiply(a)).toNumber(),t[2]=e.toNumber(),t[2]>=60&&(t[1]=Math.floor(t[2]/60),t[2]=t[2]%60),t[1]>=60&&(t[0]=Math.floor(t[1]/60),t[1]=t[1]%60),this._partsCache=t}return this._partsCache},t.exports=u},function(t,e,n){"use strict";const r=n(1);function o(t,e,n,r,o){-1===r&&(r=0),this.info={queriedHost:e,triedHosts:n,speculativeExecutions:r,achievedConsistency:o,traceId:null,warnings:null,customPayload:null},t.flags&&(this.info.traceId=t.flags.traceId,this.info.warnings=t.flags.warnings,this.info.customPayload=t.flags.customPayload),this.rows=t.rows,this.rowLength=this.rows?this.rows.length:t.rowLength,this.columns=null,this.pageState=null,this.nextPage=void 0;const i=t.meta;i&&(this.columns=i.columns,i.pageState&&(this.pageState=i.pageState.toString("hex"))),t.id?(Object.defineProperty(this,"id",{value:t.id,enumerable:!1}),Object.defineProperty(this,"meta",{value:t.meta,enumerable:!1})):null!==this.pageState&&Object.defineProperty(this,"meta",{value:t.meta,enumerable:!1})}o.prototype.first=function(){return this.rows&&this.rows.length?this.rows[0]:null},o.prototype.getPageState=function(){return this.pageState},o.prototype.getColumns=function(){return this.columns},o.prototype.wasApplied=function(){if(!this.rows||0===this.rows.length)return!0;const t=this.rows[0]["[applied]"];return"boolean"!=typeof t||t},o.prototype[Symbol.iterator]=function(){return this.rows?this.rows[Symbol.iterator]():r.emptyArray[Symbol.iterator]()},t.exports=o},function(t,e,n){"use strict";const r=n(0),o=n(15);function i(t){o.Readable.call(this,t),this.buffer=[],this.paused=!0}r.inherits(i,o.Readable),i.prototype._read=function(){for(this.paused=!1,0===this.buffer.length&&(this._readableState.reading=!1);!this.paused&&this.buffer.length>0;)this.paused=!this.push(this.buffer.shift());this.paused||this.buffer.length||!this._readNext||(this._readNext(),this._readNext=null)},i.prototype._valve=function(t){this._readNext=null,t&&(this.paused||this.buffer.length?this._readNext=t:t())},i.prototype.add=function(t){this.buffer.push(t),this.read(0)},t.exports=i},function(t,e,n){"use strict";function r(t){if(!t)throw new Error("Columns not defined");Object.defineProperty(this,"__columns",{value:t,enumerable:!1,writable:!1})}r.prototype.get=function(t){return"number"==typeof t?this[this.__columns[t].name]:this[t]},r.prototype.values=function(){const t=[];return this.forEach(function(e){t.push(e)}),t},r.prototype.keys=function(){const t=[];return this.forEach(function(e,n){t.push(n)}),t},r.prototype.forEach=function(t){for(const e in this)this.hasOwnProperty(e)&&t(this[e],e)},t.exports=r},function(t,e,n){"use strict";const r=n(0);function o(){let t=Array.prototype.slice.call(arguments);if(0===t.length)throw new TypeError("Tuple must contain at least one value");1===t.length&&r.isArray(t)&&(t=t[0]),this.elements=t,this.length=this.elements.length}o.fromArray=function(t){return new o(t.slice(0))},o.prototype.get=function(t){return this.elements[t||0]},o.prototype.toString=function(){return"("+this.elements.reduce(function(t,e,n){return t+(n>0?",":"")+e.toString()},"")+")"},o.prototype.toJSON=function(){return this.elements},o.prototype.values=function(){return this.elements.slice(0)},t.exports=o},function(t,e,n){"use strict";const r=n(0);function o(){}function i(t){this.delay=t}function s(t,e,n){this.baseDelay=t,this.maxDelay=e,this.startWithNoDelay=n}o.prototype.newSchedule=function(){throw new Error("You must implement a new schedule for the Reconnection class")},r.inherits(i,o),i.prototype.newSchedule=function(){const t=this;return{next:function(){return{value:t.delay,done:!1}}}},r.inherits(s,o),s.prototype.newSchedule=function(){const t=this;let e=this.startWithNoDelay?-1:0;return{next:function(){let n=0;return++e>64?n=t.maxDelay:0!==e&&(n=Math.min(Math.pow(2,e)*t.baseDelay,t.maxDelay)),{value:n,done:!1}}}},e.ReconnectionPolicy=o,e.ConstantReconnectionPolicy=i,e.ExponentialReconnectionPolicy=s},function(t,e,n){"use strict";const r=n(0),o=n(3);function i(){}function s(){this._plan={nextExecution:function(){return-1}}}function a(t,e){if(!(t>=0))throw new o.ArgumentError("delay must be a positive number or zero");if(!(e>0))throw new o.ArgumentError("maxSpeculativeExecutions must be a positive number");this._delay=t,this._maxSpeculativeExecutions=e}i.prototype.init=function(t){},i.prototype.shutdown=function(){},i.prototype.newPlan=function(t,e){throw new Error("You must implement newPlan() method in the SpeculativeExecutionPolicy")},r.inherits(s,i),s.prototype.newPlan=function(){return this._plan},r.inherits(a,i),a.prototype.newPlan=function(){let t=0;const e=this;return{nextExecution:function(){return t++<e._maxSpeculativeExecutions?e._delay:-1}}},e.NoSpeculativeExecutionPolicy=s,e.SpeculativeExecutionPolicy=i,e.ConstantSpeculativeExecutionPolicy=a},function(t,e,n){"use strict";const r=n(0),o=n(2).Long,i=n(3),s=o.fromInt(1e3);function a(){}function c(t,e){if(t<0)throw new i.ArgumentError("warningThreshold can not be lower than 0");this._warningThreshold=t||1e3,this._minLogInterval=1e3,"number"==typeof e&&(this._minLogInterval=e),this._micros=-1,this._lastDate=0,this._lastLogDate=0}a.prototype.next=function(t){throw new Error("next() must be implemented")},r.inherits(c,a),c.prototype.getDate=function(){return Date.now()},c.prototype.next=function(t){let e=this.getDate(),n=0;if(e>this._lastDate)return this._micros=0,this._lastDate=e,this._generateMicroseconds();e<this._lastDate&&(n=this._lastDate-e,e=this._lastDate),1e3==++this._micros&&(this._micros=0,e===this._lastDate&&(e++,n++));const o=this._lastDate;this._lastDate=e;const i=this._generateMicroseconds();if(n>=this._warningThreshold){const e=Date.now();if(this._minLogInterval>0&&this._lastLogDate+this._minLogInterval<=e){const s=r.format("Timestamp generated using current date was %d milliseconds behind the last generated timestamp (which millisecond portion was %d), the returned value (%s) is being artificially incremented to guarantee monotonicity.",n,o,i);this._lastLogDate=e,t.log("warning",s)}}return i},c.prototype._generateMicroseconds=function(){return this._lastDate<9007199254740?1e3*this._lastDate+this._micros:o.fromNumber(this._lastDate).multiply(s).add(o.fromInt(this._micros))},e.TimestampGenerator=a,e.MonotonicTimestampGenerator=c},function(t,e,n){"use strict";const r=n(4),o=n(0),i=n(1),s=n(3),a=n(2),c=n(17).ProfileManager,u=n(5),h=n(8),l=n(49),p=n(10).description,f=n(10).version;let d=n(50),m=n(24),g=n(23);function y(t){r.EventEmitter.call(this),this.options=h.extend({logEmitter:this.emit.bind(this)},t),Object.defineProperty(this,"profileManager",{value:new c(this.options)}),Object.defineProperty(this,"controlConnection",{value:new d(this.options,this.profileManager),writable:!0}),this.setMaxListeners(0),this.connected=!1,this.isShuttingDown=!1,this.keyspace=t.keyspace,this.metadata=this.controlConnection.metadata,this.hosts=this.controlConnection.hosts}o.inherits(y,r.EventEmitter),y.prototype.connect=function(t){return i.promiseWrapper.call(this,this.options,t,this._connectCb)},y.prototype._connectCb=function(t){if(this.connected)return t();if(this.isShuttingDown)return t(new s.NoHostAvailableError(null,"Connecting after shutdown is not supported"));if(this.once("connected",t),this.connecting)return;this.connecting=!0;const e=this;this.log("info",o.format("Connecting to cluster using '%s' version %s",p,f)),i.series([function(t){e.controlConnection.init(t)},function(t){e.hosts=e.controlConnection.hosts,e.profileManager.init(e,e.hosts,t)},function(t){if(!e.keyspace)return t();m.setKeyspace(e,t)},function(t){if(h.setProtocolDependentDefaults(e.options,e.controlConnection.protocolVersion),!e.options.pooling.warmup)return t();e._warmup(t)}],function(t){if(t)return e.controlConnection.reset(function(){e.connected=!1,e.connecting=!1,e.emit("connected",t)});e._setHostListeners(),e.profileManager.getDistance(e.controlConnection.host),e.connected=!0,e.connecting=!1,e.emit("connected")})},y.prototype.execute=function(t,e,n,r){return"function"==typeof(r=r||n||e)&&(e="function"!=typeof e?e:null),i.promiseWrapper.call(this,this.options,r,function(r){n=h.createQueryOptions(this,n),this._innerExecute(t,e,n,r)})},y.prototype.eachRow=function(t,e,n,r,o){!o&&r&&"function"==typeof n?(o=i.validateFn(r,"rowCallback"),r=n):(o=o||i.noop,r=i.validateFn(r||n||e,"rowCallback")),e="function"!=typeof e?e:null,n=h.createQueryOptions(this,n,r);const s=this;let a=0;function c(){s._innerExecute(t,e,n,u)}function u(t,e){if(t)return o(t);if(a+=e.rowLength,e.meta&&e.meta.pageState){if(n.pageState=e.meta.pageState,n.autoPage)return c();e.nextPage=c}e.rowLength=a,o(null,e)}this._innerExecute(t,e,n,u)},y.prototype.stream=function(t,e,n,r){r=r||i.noop;const o=new a.ResultStream({objectMode:1});function s(t,e){t&&o.emit("error",t),e&&e.nextPage?o._valve(function(){try{e.nextPage()}catch(t){o.emit("error",t)}}):(o._valve(null),o.add(null),r(t))}let c=!0;return this.eachRow(t,e,n,function(t,e){o.add(e)},function(t,e){if(c)return setImmediate(function(){s(t,e)});s(t,e)}),c=!1,o},y.prototype.batch=function(t,e,n){return n=n||e,i.promiseWrapper.call(this,this.options,n,function(n){this._batchCb(t,e,n)})},y.prototype._batchCb=function(t,e,n){if(!Array.isArray(t))throw new s.ArgumentError("Queries should be an Array");if(0===t.length)return n(new s.ArgumentError("Queries array can not be empty"));if((e=h.createQueryOptions(this,e,null,!0)).message&&e instanceof Error)return n(e);let r,a;i.series([t=>this.connect(t),n=>{if(e.prepare)return g.getPreparedMultiple(this,e.executionProfile.loadBalancing,t,this.keyspace,function(t,e){r=e,n(t)});r=new Array(t.length);for(let e=0;e<t.length;e++){const i=t[e];if(!i)return n(new s.ArgumentError(o.format("Invalid query at index %d",e)));const a="string"==typeof i?i:i.query;if(!a)return n(s.ArgumentError(o.format("Invalid query at index %d",e)));r[e]={query:a,params:i.params}}n()},t=>this._createBatchRequest(r,e,(e,n)=>{a=n,t(e)}),t=>m.send(a,e,this,t)],n)},y.prototype.getReplicas=function(t,e){return this.metadata.getReplicas(t,e)},y.prototype.getState=function(){return l.from(this)},y.prototype.log=i.log,y.prototype.shutdown=function(t){return i.promiseWrapper.call(this,this.options,t,this._shutdownCb)},y.prototype._shutdownCb=function(t){const e=this;function n(){e.connected=!1,e.isShuttingDown=!0;const n=e.hosts.values();e.controlConnection.shutdown(),e.options.policies.speculativeExecution.shutdown(),i.each(n,(t,e)=>t.shutdown(!1,e),t)}return this.log("info","Shutting down"),t=t||i.noop,this.hosts&&this.connected?this.connecting?(this.log("warning","Shutting down while connecting"),this.once("connected",n)):void n():(this.connected=!1,t())},y.prototype._waitForSchemaAgreement=function(t,e){if(1===this.hosts.length)return setImmediate(e);const n=this,r=new Date,o=1e3*this.options.protocolOptions.maxSchemaAgreementWaitSeconds;let s,a;this.log("info","Waiting for schema agreement"),i.whilst(()=>!s&&new Date-r<o,function(e){i.series([function(e){n.metadata.getPeersSchemaVersions(t,function(t,n){a=n,e(t)})},function(e){n.metadata.getLocalSchemaVersion(t,e)}],function(t,r){if(t)return e(t);s=!0,r=r.toString();for(let t=0;t<a.length;t++)if(a[t].toString()!==r){s=!1;break}s&&n.log("info","Schema versions match"),setTimeout(e,500)})},e)},y.prototype.handleSchemaAgreementAndRefresh=function(t,e,n){const r=this;this._waitForSchemaAgreement(t,function(t){if(t&&r.log("warning","There was an error while waiting for the schema agreement between nodes",t),!r.options.isMetadataSyncEnabled)return n();r.controlConnection.handleSchemaChange(e,!0,n)})},y.prototype._innerExecute=function(t,e,n,r){if(n.message&&n instanceof Error)return r(n);const c=this.controlConnection.protocolVersion;if(!n.prepare&&e&&!o.isArray(e)&&!a.protocolVersion.supportsNamedParameters(c))return r(new s.ArgumentError("Named parameters for simple statements are not supported, use prepare flag"));let u;i.series([t=>this.connect(t),r=>{if(!n.prepare)return this._createQueryRequest(t,n,e,(t,e)=>{u=e,r(t)});const o=n.executionProfile.loadBalancing;g.getPrepared(this,o,t,this.keyspace,(o,i,s)=>{if(o)return r(o);this._createExecuteRequest(t,i,n,e,s,(t,e)=>{u=e,r(t)})})},t=>m.send(u,n,this,t)],r)},y.prototype._setHostListeners=function(){function t(t,e){return()=>t.emit("hostUp",e)}function e(t,e){return()=>t.emit("hostDown",e)}const n=this;this.hosts.on("add",function(r){r.on("up",t(n,r)),r.on("down",e(n,r)),n.emit("hostAdd",r)}),this.hosts.on("remove",function(t){t.removeAllListeners(),n.emit("hostRemove",t)}),this.hosts.forEach(function(r){r.on("up",t(n,r)),r.on("down",e(n,r))})},y.prototype._warmup=function(t){const e=this,n=this.hosts.values();i.timesLimit(n.length,32,function(t,r){const i=n[t];if(e.profileManager.getDistance(i)!==a.distance.local)return r();i.warmupPool(function(t){t&&e.log("warning",o.format("Connection pool to host %s could not be created: %s",i.address,t)),r()})},t)},y.prototype._getEncoder=function(){const t=this.controlConnection.getEncoder();if(!t)throw new s.DriverInternalError("Encoder is not defined");return t},y.prototype._createBatchRequest=function(t,e,n){const r=t[0];if(!r.meta)return n(null,new u.BatchRequest(t,e));this._setRoutingInfo(e,r.params,r.meta,function(r){if(r)return n(r);n(null,new u.BatchRequest(t,e))})},y.prototype._createExecuteRequest=function(t,e,n,r,o,s){try{r=i.adaptNamedParamsPrepared(r,o.columns)}catch(t){return s(t)}this._setRoutingInfo(n,r,o,i=>{if(i)return s(i);s(null,new u.ExecuteRequest(t,e,r,n,o))})},y.prototype._createQueryRequest=function(t,e,n,r){this.metadata.adaptUserHints(this.keyspace,e.hints,o=>{if(o)return r(o);let s;try{s=i.adaptNamedParamsWithHints(n,e),this._getEncoder().setRoutingKeyFromUser(s.params,e,s.keyIndexes)}catch(o){return r(o)}r(null,new u.QueryRequest(t,s.params,e,s.namedParameters))})},y.prototype._setRoutingInfo=function(t,e,n,r){const i=this;function s(o){const s=i._getEncoder();try{o?s.setRoutingKeyFromUser(e,t):s.setRoutingKeyFromMeta(n,e,t)}catch(t){return r(t)}r()}return!t.keyspace&&n.keyspace&&(t.keyspace=n.keyspace),t.routingKey?s(!0):o.isArray(n.partitionKeys)?(t.routingIndexes=n.partitionKeys,s()):void this.metadata.getTable(n.keyspace,n.table,(e,i)=>e?(this.log("warning",o.format("Table %s.%s metadata could not be retrieved",n.keyspace,n.table)),r()):i?(t.routingIndexes=i.partitionKeys.map(t=>n.columnsByName[t.name]),n.partitionKeys=t.routingIndexes,void s()):r())},t.exports=y},function(t,e,n){"use strict";const r=n(0),o=n(3);function i(t,e,n){this._hosts=t,this._openConnections=e,this._inFlightQueries=n}i.from=function(t){const e={},n={},r=[];return t.hosts.forEach(function(t){0!==t.pool.connections.length&&(r.push(t),e[t.address]=t.pool.connections.length,n[t.address]=t.pool.connections.reduce(function(t,e){return t+e.getInFlight()},0))}),new i(r,e,n)},i.prototype.getConnectedHosts=function(){return this._hosts},i.prototype.getOpenConnections=function(t){if(!t)throw new o.ArgumentError("Host is not defined");return this._openConnections[t.address]||0},i.prototype.getInFlightQueries=function(t){if(!t)throw new o.ArgumentError("Host is not defined");return this._inFlightQueries[t.address]||0},i.prototype.toString=function(){return r.format('{"hosts": %j, "openConnections": %j, "inFlightQueries": %j}',this._hosts.map(function(t){return t.address}),this._openConnections,this._inFlightQueries)},t.exports=i},function(t,e,n){"use strict";const r=n(4),o=n(0),i=n(19),s=n(3),a=n(20).Host,c=n(20).HostMap,u=n(25),h=n(66),l=n(5),p=n(1),f=n(2),d=o.format;let m=n(12);const g="DROPPED";function y(t,e,n){this.protocolVersion=null,this.hosts=new c,this.setMaxListeners(0),Object.defineProperty(this,"options",{value:t,enumerable:!1,writable:!1}),this.metadata=new u(this.options,this),this.addressTranslator=this.options.policies.addressResolution,this.reconnectionPolicy=this.options.policies.reconnection,this.reconnectionSchedule=this.reconnectionPolicy.newSchedule(),this.initialized=!1,this.isShuttingDown=!1,this.host=null,this.connection=null,this.encoder=null,this.debouncer=new h(t.refreshSchemaDelay,this.log.bind(this)),this.profileManager=e,this.topologyChangeTimeout=null,this.nodeStatusChangeTimeout=null,this.reconnectionTimeout=null,this.hostIterator=null,this.triedHosts=null,n&&n.borrowHostConnection&&(this.borrowHostConnection=n.borrowHostConnection)}o.inherits(y,r.EventEmitter),y.prototype.init=function(t){if(this.initialized)return t();const e=this;function n(t,n,r){const o=t+":"+(n||e.options.protocolOptions.port),i=new a(o,e.protocolVersion,e.options,e.metadata);e.hosts.set(o,i),e.log("info","Adding host "+o),r&&r()}p.series([function(t){p.each(e.options.contactPoints,function(t,r){if(0===t.indexOf("[")&&t.indexOf("]:")>1){const e=t.lastIndexOf("]:");return n(t.substr(1,e-1),t.substr(e+2),r)}let o=t,s=null;if(t.indexOf(":")>0){const e=t.split(":");2===e.length&&(o=e[0],s=e[1])}if(i.isIP(o))return n(o,s,r);!function(t,e){const n=[];p.parallel([function(e){m.resolve4(t,function(t,r){r&&n.push.apply(n,r),e()})},function(e){m.resolve6(t,function(t,r){r&&n.push.apply(n,r),e()})}],function(){if(0===n.length)return m.lookup(t,function(t,r){if(t)return e(t);n.push(r),e(null,n)});e(null,n)})}(o,function(t,i){if(t)return e.log("error","Host with name "+o+" could not be resolved",t),r();i.forEach(function(t){n(t,s)}),r()})},function(n){n||0!==e.hosts.length||(n=new s.NoHostAvailableError(null,"No host could be resolved")),t(n)})},function(t){e.refresh(!1,t)}],function(n){e.initialized=!n,t(n)})},y.prototype.setHealthListeners=function(){const t=this.host,e=this.connection,n=this;let r=0;function o(o){0==r++&&(t.removeListener("down",i),t.removeListener("ignore",i),e.removeListener("socketClose",s),n.isShuttingDown||(o?n.log("warning",d("Host %s used by the ControlConnection DOWN",t.address)):n.log("warning",d("Connection to %s used by the ControlConnection was closed",t.address)),n.host=null,n.connection=null,n.refresh()))}function i(){o(!0)}function s(){o(!1)}t.once("down",i),t.once("ignore",i),e.once("socketClose",s)},y.prototype.borrowAConnection=function(t){const e=this;let n,r=null;p.whilst(function(){if(r)return!1;const t=e.hostIterator.next();return n=t.value,!t.done},function(t){if(e.initialized){const r=e.profileManager.getDistance(n);if(!n.isUp()||r===f.distance.ignored)return t()}e.borrowHostConnection(n,function(o,i){e.triedHosts[n.address]=o,r=i,t()})},function(){if(!r)return t(new s.NoHostAvailableError(e.triedHosts));e.initialized||(e.protocolVersion=r.protocolVersion,e.encoder=r.encoder),e.host=n,e.connection=r,t()})},y.prototype.borrowHostConnection=function(t,e){t.borrowConnection(e)},y.prototype.refreshHosts=function(t,e){if(e=e||p.noop,!this.connection)return void e();const n=this;this.log("info","Refreshing local and peers info");const r=this.connection,o=this.host;n.host.protocolVersion||n.host.setProtocolVersion(n.protocolVersion),p.series([function(t){const e=new l.QueryRequest("SELECT * FROM system.local WHERE key='local'",null,null);r.sendStream(e,null,function(e,o){n.setLocalInfo(r.endpoint,o),t(e)})},function(e){const o=new l.QueryRequest("SELECT * FROM system.peers",null,null);r.sendStream(o,null,function(r,o){n.setPeersInfo(t,r,o,e)})},function(t){if(!n.initialized){const e=f.protocolVersion.getHighestCommon(r,n.hosts),o=e!==n.protocolVersion;if(n.protocolVersion=e,n.hosts.forEach(t=>t.setProtocolVersion(n.protocolVersion)),o)return n.log("info","Reconnecting since the protocol version changed to 0x"+e.toString(16)),r.decreaseVersion(n.protocolVersion),void r.close(()=>r.open(t))}t()},function(t){if(n.metadata.setCassandraVersion(o.getCassandraVersion()),n.metadata.buildTokens(n.hosts),!n.options.isMetadataSyncEnabled)return n.metadata.initialized=!0,t();n.metadata._refreshKeyspaces(!1,!0,()=>{n.metadata.initialized=!0,t()})}],e)},y.prototype.refresh=function(t,e){const n=!this.initialized;e=e||p.noop,this.host=null;const r=this;p.series([function(e){return t?e():(r.triedHosts={},n?(r.log("info","Getting first connection"),r.hostIterator=p.arrayIterator(r.hosts.values()),e()):(r.log("info","Trying to acquire a connection to a new host"),void r.profileManager.getDefaultLoadBalancing().newQueryPlan(null,null,function(t,n){if(t)return r.log("error","ControlConnection could not retrieve a query plan to determine which hosts to use",t),e(t);r.hostIterator=n,e()})))},function(t){r.borrowAConnection(t)},function(t){n?r.log("info",d("ControlConnection using protocol version 0x%s, connected to %s",r.protocolVersion.toString(16),r.host.address)):r.log("info",d("ControlConnection connected to %s",r.host.address)),r.refreshHosts(n,t)},function(t){r.connection.on("nodeTopologyChange",r.nodeTopologyChangeHandler.bind(r)),r.connection.on("nodeStatusChange",r.nodeStatusChangeHandler.bind(r)),r.connection.on("nodeSchemaChange",r.nodeSchemaChangeHandler.bind(r));const e=new l.RegisterRequest(["TOPOLOGY_CHANGE","STATUS_CHANGE","SCHEMA_CHANGE"]);r.connection.sendStream(e,null,t)}],function(t){return t?r.host?(r.log("error","ControlConnection failed to retrieve topology and keyspaces information",t),r.triedHosts[r.host.address]=t,t&&t.isSocketError&&r.host.removeFromPool(r.connection),r.connection=null,void r.refresh(!0,e)):(r.log("error","ControlConnection failed to acquire a connection",t),n||r.noOpenConnectionHandler(),r.emit("newConnection",t),e(t)):r.connection.connected?(r.setHealthListeners(),r.reconnectionSchedule=r.reconnectionPolicy.newSchedule(),r.emit("newConnection",null,r.connection,r.host),r.log("info",d("ControlConnection connected to %s and up to date",r.host.address)),e()):(r.log("info",d("Connection to %s was closed before finishing refresh",r.host.address)),r.refresh(!1,e))})},y.prototype.noOpenConnectionHandler=function(){const t=this.reconnectionSchedule.next().value;this.log("warning",d("ControlConnection could not reconnect, scheduling reconnection in %dms",t));const e=this;setTimeout(()=>e.refresh(),t)},y.prototype.log=p.log,y.prototype.nodeTopologyChangeHandler=function(t){this.log("info","Received topology change",t);const e=this;clearTimeout(this.topologyChangeTimeout),this.topologyChangeTimeout=setTimeout(()=>e.scheduleRefreshHosts(),1e3)},y.prototype.nodeStatusChangeHandler=function(t){const e=this,n=t.inet.address.toString(),r=this.options.protocolOptions.port;this.addressTranslator.translate(n,r,function(r){const o=e.hosts.get(r);if(!o)return void e.log("warning","Received status change event but host was not found: "+n);const i=e.profileManager.getDistance(o);return t.up?i===f.distance.ignored?o.setUp(!0):(clearTimeout(e.nodeStatusChangeTimeout),void(e.nodeStatusChangeTimeout=setTimeout(()=>o.checkIsUp(),1e3))):i===f.distance.ignored?o.setDown():void e.log("warning","Received status change to DOWN for host "+o.address)})},y.prototype.nodeSchemaChangeHandler=function(t){this.log("info","Schema change",t),this.options.isMetadataSyncEnabled&&this.handleSchemaChange(t,!1)},y.prototype.handleSchemaChange=function(t,e,n){const r=this;let o,i;if(t.isKeyspace)return t.schemaChangeType===g?(o=function(){delete r.metadata.keyspaces[t.keyspace]},this.scheduleObjectRefresh(o,t.keyspace,null,e,n)):this.scheduleKeyspaceRefresh(t.keyspace,e,n);const s=this.metadata.keyspaces[t.keyspace];s&&(t.table?(i=t.table,o=function(){delete s.tables[t.table],delete s.views[t.table]}):t.udt?(i=t.udt,o=function(){delete s.udts[t.udt]}):t.functionName?(i=t.functionName,o=function(){delete s.functions[t.functionName]}):t.aggregate&&(i=t.aggregate,o=function(){delete s.aggregates[t.aggregate]}),o&&this.scheduleObjectRefresh(o,t.keyspace,i,e,n))},y.prototype.scheduleObjectRefresh=function(t,e,n,r,o){this.debouncer.eventReceived({handler:t,keyspace:e,cqlObject:n,callback:o},r)},y.prototype.scheduleKeyspaceRefresh=function(t,e,n){this.debouncer.eventReceived({handler:e=>this.metadata.refreshKeyspace(t,e),keyspace:t,callback:n},e)},y.prototype.scheduleRefreshHosts=function(t){this.debouncer.eventReceived({handler:t=>this.refreshHosts(!1,t),all:!0,callback:t},!1)},y.prototype.setLocalInfo=function(t,e){if(!e||!e.rows||!e.rows.length)return void this.log("warning","No local info provided");const n=e.rows[0],r=this.hosts.get(t);r?(r.datacenter=n.data_center,r.rack=n.rack,r.tokens=n.tokens,r.cassandraVersion=n.release_version,this.metadata.setPartitioner(n.partitioner),this.log("info","Local info retrieved")):this.log("error","Localhost could not be found")},y.prototype.setPeersInfo=function(t,e,n,r){if(!n||!n.rows||e)return r(e);const o=this,i={},s=this.options.protocolOptions.port;p.eachSeries(n.rows,function(e,n){o.getAddressForPeerHost(e,s,function(r){if(!r)return n();i[r]=!0;let s=o.hosts.get(r);s||(s=new a(r,o.protocolVersion,o.options,o.metadata),t||s.setDown(),o.log("info","Adding host "+r),o.hosts.set(r,s)),s.datacenter=e.data_center,s.rack=e.rack,s.tokens=e.tokens,s.cassandraVersion=e.release_version,n()})},function(t){if(t)return r(t);if(o.hosts.length>n.rows.length+1){o.log("info","Removing nodes from the pool");const t=[];o.hosts.forEach(function(e){i[e.address]||e===o.host||(o.log("info","Removing host "+e.address),t.push(e.address),e.shutdown(!0))}),o.hosts.removeMultiple(t)}o.log("info","Peers info retrieved"),r()})},y.prototype.getAddressForPeerHost=function(t,e,n){let r=t.rpc_address;const o=t.peer;if(!r)return this.log("error",d("No rpc_address found for host %s in %s's peers system table. %s will be ignored.",o,this.host.address,o)),n(null);"0.0.0.0"===r.toString()&&(this.log("warning",d("Found host with 0.0.0.0 as rpc_address, using listen_address (%s) to contact it instead. If this is incorrect you should avoid the use of 0.0.0.0 server side.",o)),r=o),this.addressTranslator.translate(r.toString(),e,n)},y.prototype.waitForReconnection=function(t){let e;const n=this;function r(n){clearTimeout(e),t(n)}this.once("newConnection",r),e=setTimeout(function(){n.removeListener("newConnection",r),t(new s.OperationTimedOutError("A connection could not be acquired before timeout."))},2e3)},y.prototype.query=function(t,e,n){const r=this;function o(){const e="string"==typeof t?new l.QueryRequest(t,null,null):t;r.connection.sendStream(e,null,n)}if("function"==typeof e&&(n=e,e=!0),!this.connection)return e?this.waitForReconnection(function(t){if(t)return n(t);o()}):n(new s.NoHostAvailableError(null));o()},y.prototype.getEncoder=function(){if(!this.encoder)throw new s.DriverInternalError("Encoder is not defined");return this.encoder},y.prototype.shutdown=function(){this.isShuttingDown=!0,this.debouncer.shutdown(),this.emit("newConnection",new s.DriverError("ControlConnection is being shutdown")),clearTimeout(this.topologyChangeTimeout),clearTimeout(this.nodeStatusChangeTimeout),clearTimeout(this.reconnectionTimeout)},y.prototype.reset=function(t){const e=this.hosts.clear();this.isShuttingDown=!0;const n=this;p.each(e,(t,e)=>t.shutdown(!1,()=>e()),function(){n.initialized=!1,n.isShuttingDown=!1,t()})},t.exports=y},function(t,e,n){"use strict";const r=n(0),o=n(4),i=n(52),s=n(1),a=n(3),c=n(8).defaultOptions();let u=0;const h=Math.pow(2,15),l={initial:0,closing:1,shuttingDown:2,shutDown:4};class p extends o.EventEmitter{constructor(t,e){super(),this._address=t.address,this._newConnectionTimeout=null,this._creating=!1,this._state=l.initial,this.options=t.options,this.protocolVersion=e,this.coreConnectionsLength=1,this.connections=s.emptyArray,this.setMaxListeners(0),this.log=s.log}borrowConnection(t){this.create(!1,e=>{if(e)return t(e);if(0===this.connections.length)return t(new Error("No connection available"));const n=this.options.pooling.maxRequestsPerConnection,r=p.minInFlight(this.connections,n);if(r.getInFlight()>=n)return t(new a.BusyConnectionError(this._address,n,this.connections.length));t(null,r)})}static minInFlight(t,e){const n=t.length;if(1===n)return t[0];let r;++u>=h&&(u=0);for(let o=u;o<u+n;o++){r=t[o%n];const i=t[(o+1)%n];if(i.getInFlight()<r.getInFlight()&&(r=i),r.getInFlight()<e)break}return r}create(t,e){if(this.isClosing())return e(new Error("Pool is being closed when calling create"));if(this.connections.length>=this.coreConnectionsLength)return e();if(!t&&this.connections.length>0)return this.increaseSize(),e();if(this.once("creation",e),this._creating)return;this._creating=!0;let n=this.coreConnectionsLength;t||(n=1);const o=this;s.whilst(function(){return o.connections.length<n},function(t){o._attemptNewConnection(t)},function(t){if(o._creating=!1,t)return o.isClosing()?(o.log("info","Connection pool created but it was being closed"),o._closeAllConnections(),t=new Error("Pool is being closed")):o.log("warning",r.format("Connection pool to host %s could not be created",o._address),t),o.emit("creation",t);o.log("info",r.format("Connection pool to host %s created with %d connection(s)",o._address,o.connections.length)),o.emit("creation"),o.increaseSize()})}_createConnection(){const t=new i(this._address,this.protocolVersion,this.options),e=this;function n(){e.remove(t)}return t.on("idleRequestError",n),t.on("socketClose",n),t}clearNewConnectionAttempt(){this._newConnectionTimeout&&(clearTimeout(this._newConnectionTimeout),this._newConnectionTimeout=null)}_attemptNewConnection(t){const e=this._createConnection(),n=this;this.once("open",t),this._opening||(this._opening=!0,e.open(function(t){if(n._opening=!1,t)return n.log("warning",r.format("Connection to %s could not be created: %s",n._address,t),t),e.close(),n.emit("open",t);if(n.isClosing())return n.log("info",r.format("Connection to %s opened successfully but pool was being closed",n._address)),e.close(),n.emit("open",new Error("Connection closed"));const o=n.connections.slice(0);o.push(e),n.connections=o,n.log("info",r.format("Connection to %s opened successfully",n._address)),n.emit("open",null,e)}))}attemptNewConnectionImmediate(){const t=this;function e(){t.clearNewConnectionAttempt(),t.scheduleNewConnectionAttempt(0)}return this._state===l.initial?e():this._state===l.closing?this.once("close",e):void 0}remove(t){const e=this.connections.indexOf(t);if(e<0)return;const n=this.connections.slice(0);n.splice(e,1),this.connections=n,setImmediate(function(){t.close()}),this.emit("remove")}scheduleNewConnectionAttempt(t){if(this.isClosing())return;const e=this;this._newConnectionTimeout=setTimeout(function(){e._newConnectionTimeout=null,e.connections.length>=e.coreConnectionsLength||e._attemptNewConnection(s.noop)},t)}hasScheduledNewConnection(){return!!this._newConnectionTimeout||this._opening}increaseSize(){this.connections.length<this.coreConnectionsLength&&!this.hasScheduledNewConnection()&&this.scheduleNewConnectionAttempt(0)}isClosing(){return this._state!==l.initial}drainAndShutdown(){if(this.isClosing())return;this._state=l.closing,this.clearNewConnectionAttempt();const t=this;if(0===this.connections.length)return this._afterClosing();const e=this.connections;this.connections=s.emptyArray;let n=0;this.log("info",r.format("Draining and closing %d connections to %s",e.length,this._address));let o,i=!1;for(let t=0;t<e.length;t++){const n=e[t];0!==n.getInFlight()?(n.emitDrain=!0,n.once("drain",a(n))):a(n)()}function a(r){return function(){r.close(),++n<e.length||i||(i=!0,o&&clearTimeout(o),t._afterClosing())}}const u=(this.options.socketOptions.readTimeout||c.socketOptions.readTimeout)+100;o=setTimeout(function(){i=!0,e.forEach(function(t){t.close()}),t._afterClosing()},u)}_afterClosing(){const t=this;function e(){t._state===l.shuttingDown?t._state=l.shutDown:t._state=l.initial,t.emit("close")}return this._creating?this.once("creation",e):this._opening?this.once("open",e):void e()}shutdown(t){if(this.clearNewConnectionAttempt(),!this.connections.length)return this._state=l.shutDown,t();const e=this._state;if(this._state=l.shuttingDown,e===l.closing)return this.once("close",t);if(this.once("shutdown",t),e===l.shuttingDown)return;const n=this;this._closeAllConnections(function(){n._state=l.shutDown,n.emit("shutdown")})}_closeAllConnections(t){t=t||s.noop;const e=this.connections;if(this.connections=s.emptyArray,0===e.length)return t();this.log("info",r.format("Closing %d connections to %s",e.length,this._address)),s.each(e,function(t,e){t.close(function(){e()})},t)}}t.exports=p},function(t,e,n){"use strict";const r=n(4),o=n(0),i=n(53),s=n(21),a=n(18).WriteQueue,c=n(5),u=n(54),h=n(1),l=n(2),p=n(3),f=n(56),d=n(57);let m=n(19);function g(t,e,n){if(r.EventEmitter.call(this),this.setMaxListeners(0),!t||t.indexOf(":")<0)throw new Error("EndPoint must contain the ip address and port separated by : symbol");this.endpoint=t;const o=t.lastIndexOf(":");this.address=t.substr(0,o),this.port=t.substr(o+1),Object.defineProperty(this,"options",{value:n,enumerable:!1,writable:!1}),null===e&&(e=l.protocolVersion.maxSupported,n.protocolOptions.maxVersion&&(e=n.protocolOptions.maxVersion),this._checkingVersion=!0),this.protocolVersion=e,this._operations={},this._pendingWrites=[],this._preparing={},this._idleTimeout=null,this.timedOutOperations=0,this._streamIds=new f(this.protocolVersion),this.encoder=new s(e,n),this.keyspace=null,this.emitDrain=!1,this.connected=!1,this.isSocketOpen=!1}o.inherits(g,r.EventEmitter),g.prototype.log=h.log,g.prototype.bindSocketListeners=function(){this.netClient.removeAllListeners("connect"),this.netClient.removeAllListeners("timeout"),this.isSocketOpen=!0;const t=this;this.netClient.on("close",function(){t.log("info","Connection to "+t.endpoint+" closed"),t.isSocketOpen=!1;const e=t.connected;t.close(),e&&t.emit("socketClose")}),this.protocol=new u.Protocol({objectMode:!0}),this.parser=new u.Parser({objectMode:!0},this.encoder);const e=new u.ResultEmitter({objectMode:!0});e.on("result",this.handleResult.bind(this)),e.on("row",this.handleRow.bind(this)),e.on("frameEnded",this.freeStreamId.bind(this)),e.on("nodeEvent",this.handleNodeEvent.bind(this)),this.netClient.pipe(this.protocol).pipe(this.parser).pipe(e),this.writeQueue=new a(this.netClient,this.encoder,this.options)},g.prototype.open=function(t){const e=this;if(this.log("info","Connecting to "+this.address+":"+this.port),this.options.sslOptions){const n=h.extend({rejectUnauthorized:!1},this.options.sslOptions);this.netClient=i.connect(this.port,this.address,n,function(){e.log("verbose","Secure socket connected to "+e.address+":"+e.port),e.bindSocketListeners(),e.startup(t)}),this.netClient.setMaxSendFragment(this.options.socketOptions.coalescingThreshold)}else this.netClient=new m.Socket({highWaterMark:this.options.socketOptions.coalescingThreshold}),this.netClient.connect(this.port,this.address,function(){e.log("verbose","Socket connected to "+e.address+":"+e.port),e.bindSocketListeners(),e.startup(t)});this.netClient.once("error",function(n){e.errorConnecting(n,!1,t)}),this.netClient.once("timeout",function(){const n=new l.DriverError("Connection timeout");e.errorConnecting(n,!0,t)}),this.netClient.setTimeout(this.options.socketOptions.connectTimeout),this.options.socketOptions.keepAlive&&this.netClient.setKeepAlive(!0,this.options.socketOptions.keepAliveDelay),this.netClient.setNoDelay(!!this.options.socketOptions.tcpNoDelay)},g.prototype.startup=function(t){this._checkingVersion&&this.log("info","Trying to use protocol version 0x"+this.protocolVersion.toString(16));const e=this;function n(n){return n?e.errorConnecting(n,!1,t):e.connectionReady(t)}this.sendStream(new c.StartupRequest(null,this.options.protocolOptions.noCompact),null,function(r,o){if(r&&e._checkingVersion){let o=r instanceof p.ResponseError&&r.code===l.responseErrorCodes.protocolError&&r.message.indexOf("Invalid or unsupported protocol version")>=0;if(!o&&l.protocolVersion.canStartupResponseErrorBeWrapped(e.protocolVersion)&&(o=r instanceof p.ResponseError&&r.code===l.responseErrorCodes.serverError&&r.message.indexOf("ProtocolException: Invalid or unsupported protocol version")>0),o){let r=e.protocol.version;return r===e.protocolVersion&&(r=l.protocolVersion.getLowerSupported(e.protocolVersion)),r?(e.log("info","Protocol 0x"+e.protocolVersion.toString(16)+" not supported, using 0x"+r.toString(16)),e.decreaseVersion(r),void setImmediate(function(){e.close(function(){e.open(t)})})):n(new Error("Connection was unable to STARTUP using protocol version "+e.protocolVersion))}}if(o&&o.mustAuthenticate)return e.startAuthenticating(o.authenticatorName,n);n(r)})},g.prototype.errorConnecting=function(t,e,n){this.log("warning","There was an error when trying to connect to the host "+this.address,t),e&&this.netClient.destroy(),n(t)},g.prototype.connectionReady=function(t){this.emit("connected"),this.connected=!0,this.netClient.removeAllListeners("error"),this.netClient.on("error",this.handleSocketError.bind(this)),t()},g.prototype.decreaseVersion=function(t){this.protocolVersion=t,this.encoder.setProtocolVersion(t),this._streamIds.setVersion(t)},g.prototype.handleSocketError=function(t){this.clearAndInvokePending(t)},g.prototype.clearAndInvokePending=function(t){this._idleTimeout&&(clearTimeout(this._idleTimeout),this._idleTimeout=null),this._streamIds.clear(),this.emitDrain&&this.emit("drain");const e=new l.DriverError("Socket was closed");e.isSocketError=!0,t&&(e.innerError=t);const n=h.objectValues(this._operations);this._operations={},n.length>0&&this.log("info","Invoking "+n.length+" pending callbacks"),h.each(n,function(t,n){t.setResult(e),n()});const r=this._pendingWrites;this._pendingWrites=[],h.each(r,function(t,n){t.setResult(e),n()})},g.prototype.startAuthenticating=function(t,e){if(!this.options.authProvider)return e(new p.AuthenticationError("Authentication provider not set"));const n=this.options.authProvider.newAuthenticator(this.endpoint,t),r=this;n.initialResponse(function(t,o){if(t)return e(t);r.authenticate(n,o,e)})},g.prototype.authenticate=function(t,e,n){const r=this;let i=new c.AuthResponseRequest(e);if(1===this.protocolVersion){if(!t.username)return n(new p.AuthenticationError("Only plain text authenticator providers allowed under protocol v1"));i=new c.CredentialsRequest(t.username,t.password)}this.sendStream(i,null,function(e,i){if(e){if(e instanceof p.ResponseError&&e.code===l.responseErrorCodes.badCredentials){const t=new p.AuthenticationError(e.message);t.additionalInfo=e,e=t}return n(e)}return i.ready?(t.onAuthenticationSuccess(),n()):i.authChallenge?t.evaluateChallenge(i.token,function(e,o){if(e)return n(e);r.authenticate(t,o,n)}):void n(new p.DriverInternalError("Unexpected response from Cassandra: "+o.inspect(i)))})},g.prototype.changeKeyspace=function(t,e){if(!t||this.keyspace===t)return e();if(this.once("keyspaceChanged",e),this.toBeKeyspace===t)return;this.toBeKeyspace=t;const n=o.format('USE "%s"',t),r=this;this.sendStream(new c.QueryRequest(n,null,null),null,function(e){e?r.log("error",o.format("Connection to %s could not switch active keyspace",r.endpoint),e):r.keyspace=t,r.toBeKeyspace=null,r.emit("keyspaceChanged",e,t)})},g.prototype.prepareOnce=function(t,e){const n=(this.keyspace||"")+t;let o=this._preparing[n];if(this._preparing[n])return o.once("prepared",e);(o=new r.EventEmitter).setMaxListeners(0),o.once("prepared",e),this._preparing[n]=o;const i=this;this.sendStream(new c.PrepareRequest(t),null,function(t,e){o.emit("prepared",t,e),delete i._preparing[n]})},g.prototype.sendStream=function(t,e,n){const r=new d(t,e,n),o=this._getStreamId();return r.setRequestTimeout(this.options.socketOptions.readTimeout,this.endpoint,()=>this.timedOutOperations++,()=>this.timedOutOperations--),null===o?(this.log("info","Enqueuing "+this._pendingWrites.length+", if this message is recurrent consider configuring more connections per host or lowering the pressure"),this._pendingWrites.push(r),r):(this._write(r,o),r)},g.prototype._write=function(t,e){t.streamId=e;const n=this;this.writeQueue.push(t,function(r){if(r)return n._streamIds.push(e),t.setResult(r);n.log("verbose","Sent stream #"+e+" to "+n.endpoint),t.isByRow()&&n.parser.setOptions(e,{byRow:!0}),n._setIdleTimeout(),n._operations[e]=t})},g.prototype._setIdleTimeout=function(){if(!this.options.pooling.heartBeatInterval)return;const t=this,e=this._idleTimeout;t._idleTimeout=setTimeout(()=>t._idleTimeoutHandler(),t.options.pooling.heartBeatInterval),e&&clearTimeout(e)},g.prototype._idleTimeoutHandler=function(){const t=this;this.sendingIdleQuery?this._idleTimeout=setTimeout(function(){t._idleTimeoutHandler()},this.options.pooling.heartBeatInterval):(this.log("verbose","Connection idling, issuing a Request to prevent idle disconnects"),this.sendingIdleQuery=!0,this.sendStream(c.options,h.emptyObject,function(e){t.sendingIdleQuery=!1,e&&(t.log("warning","Received heartbeat request error",e),t.emit("idleRequestError",e,t))}))},g.prototype._getStreamId=function(){return this._streamIds.pop()},g.prototype.freeStreamId=function(t){const e=t.streamId;e<0||(delete this._operations[e],this._streamIds.push(e),this.emitDrain&&0===this._streamIds.inUse&&0===this._pendingWrites.length&&this.emit("drain"),this._writeNext())},g.prototype._writeNext=function(){if(0===this._pendingWrites.length)return;const t=this._getStreamId();if(null===t)return;const e=this;let n;for(;(n=this._pendingWrites.shift())&&!n.canBeWritten(););n?setImmediate(function(){e._write(n,t)}):this._streamIds.push(t)},g.prototype.getInFlight=function(){return this._streamIds.inUse},g.prototype.handleResult=function(t,e,n){const r=t.streamId;if(r<0)return this.log("verbose","event received",t);const o=this._operations[r];if(!o)return this.log("error","The server replied with a wrong streamId #"+r);this.log("verbose","Received frame #"+r+" from "+this.endpoint),o.setResult(e,n)},g.prototype.handleNodeEvent=function(t,e){switch(e.eventType){case l.protocolEvents.schemaChange:this.emit("nodeSchemaChange",e);break;case l.protocolEvents.topologyChange:this.emit("nodeTopologyChange",e);break;case l.protocolEvents.statusChange:this.emit("nodeStatusChange",e)}},g.prototype.handleRow=function(t,e,n,r,o){const i=t.streamId;if(i<0)return this.log("verbose","Event received",t);const s=this._operations[i];if(!s)return this.log("error","The server replied with a wrong streamId #"+i);s.setResultRow(e,n,r,o)},g.prototype.close=function(t){if(t=t||h.noop,!this.connected&&!this.isSocketOpen)return t();if(this.connected=!1,this.removeAllListeners("drain"),this.clearAndInvokePending(),!this.isSocketOpen)return t();this.isSocketOpen=!1,this.log("verbose","Closing connection to "+this.endpoint);const e=this,n=setTimeout(()=>{this.log("info",this.endpoint+" did not respond to connection close within "+this.options.socketOptions.connectTimeout+"ms, destroying connection"),this.netClient.destroy()},this.options.socketOptions.connectTimeout);this.netClient.once("close",function(r){clearTimeout(n),r&&e.log("info","The socket closed with a transmission error"),setImmediate(t)}),this.netClient.removeAllListeners("error"),this.netClient.on("error",h.noop),this.netClient.end()},t.exports=g},function(t,e){t.exports=require("tls")},function(t,e,n){"use strict";const r=n(0),o=n(15),i=o.Transform,s=o.Writable,a=n(2),c=n(1),u=n(3),h=a.FrameHeader,l=n(55).FrameReader;function p(t){i.call(this,t),this.header=null,this.bodyLength=0,this.clearHeaderChunks(),this.version=0,this.headerSize=0}function f(t,e){i.call(this,t),this.frames={},this.encoder=e}function d(t){s.call(this,t),this.rowBuffer={}}r.inherits(p,i),p.prototype._transform=function(t,e,n){let r=null;try{this.readItems(t)}catch(t){r=t}n(r)},p.prototype.readItems=function(t){if(!t||0===t.length)return;0===this.version&&(this.version=h.getProtocolVersion(t),this.headerSize=h.size(this.version));let e=0,n=this.header;if(this.header=null,0!==this.headerChunks.byteLength){if(this.headerChunks.parts.push(t),this.headerChunks.byteLength+t.length<this.headerSize)return void(this.headerChunks.byteLength+=t.length);n=h.fromBuffer(Buffer.concat(this.headerChunks.parts,this.headerSize)),e=this.headerSize-this.headerChunks.byteLength,this.clearHeaderChunks()}const r=[];for(;;){if(!n){if(this.headerSize>t.length-e){if(t.length-e<=0)break;const n=t.slice(e,t.length);this.headerChunks.parts.push(n),this.headerChunks.byteLength=n.length;break}n=h.fromBuffer(t,e),e+=this.headerSize}const o=t.length-e;if(n.bodyLength<=o+this.bodyLength)r.push({header:n,chunk:t,offset:e,frameEnded:!0}),e+=n.bodyLength-this.bodyLength,this.bodyLength=0;else if(o>=0){this.header=n,this.bodyLength+=o,o>0&&r.push({header:n,chunk:t,offset:e,frameEnded:!1});break}n=null}for(let t=0;t<r.length;t++)this.push(r[t])},p.prototype.clearHeaderChunks=function(){this.headerChunks={byteLength:0,parts:[]}},r.inherits(f,i),f.prototype._transform=function(t,e,n){const r=this.frameState(t);let o=null;try{this.parseBody(r,t)}catch(t){o=t}n(o),t.frameEnded&&(r.cellBuffer&&this.push({header:r.header,error:new u.DriverInternalError("There was an problem while parsing streaming frame, opcode "+r.header.opcode)}),this.push({header:r.header,frameEnded:!0}))},f.prototype.parseBody=function(t,e){if(t.isStreaming=t.byRow&&e.header.opcode===a.opcodes.result,!this.handleFrameBuffers(t,e))return;const n=new l(e.header,e.chunk,e.offset);if(void 0===t.flagsInfo){const e=n.offset;try{t.flagsInfo=n.readFlagsInfo()}catch(r){return this.handleParsingError(r,t,n,e)}}switch(e.header.opcode){case a.opcodes.result:return this.parseResult(t,n);case a.opcodes.ready:case a.opcodes.authSuccess:return this.push({header:t.header,ready:!0});case a.opcodes.authChallenge:return this.push({header:t.header,authChallenge:!0,token:n.readBytes()});case a.opcodes.authenticate:return this.push({header:t.header,mustAuthenticate:!0,authenticatorName:n.readString()});case a.opcodes.error:return this.push({header:t.header,error:n.readError()});case a.opcodes.supported:return this.push({header:t.header});case a.opcodes.event:return this.push({header:t.header,event:n.readEvent()});default:return this.push({header:t.header,error:new Error("Received invalid opcode: "+e.header.opcode)})}},f.prototype.handleFrameBuffers=function(t,e){if(!t.isStreaming){return(t.bufferLength||0)+e.chunk.length-e.offset<e.header.bodyLength?(this.addFrameBuffer(t,e),!1):(t.buffers&&(e.chunk=this.getFrameBuffer(t,e),e.offset=0),!0)}if(t.cellBuffer){if(0!==e.offset)throw new u.DriverInternalError("Following chunks can not have an offset greater than zero");if(t.cellBuffer.parts.push(e.chunk),!t.cellBuffer.expectedLength){if(2!==t.cellBuffer.parts.length)throw new u.DriverInternalError("Buffer for streaming frame can not contain more than 1 item");return e.chunk=Buffer.concat(t.cellBuffer.parts,t.cellBuffer.byteLength+e.chunk.length),t.cellBuffer=null,!0}if(t.cellBuffer.expectedLength>t.cellBuffer.byteLength+e.chunk.length)return t.cellBuffer.byteLength+=e.chunk.length,!1;e.chunk=Buffer.concat(t.cellBuffer.parts,t.cellBuffer.byteLength+e.chunk.length),t.cellBuffer=null}return!0},f.prototype.addFrameBuffer=function(t,e){if(!t.buffers)return t.buffers=[e.chunk.slice(e.offset)],void(t.bufferLength=e.chunk.length-e.offset);if(e.offset>0)throw new u.DriverInternalError("Following chunks can not have an offset greater than zero");t.buffers.push(e.chunk),t.bufferLength+=e.chunk.length},f.prototype.getFrameBuffer=function(t,e){t.buffers.push(e.chunk);const n=Buffer.concat(t.buffers,t.bodyLength);return t.buffers=null,n},f.prototype.parseResult=function(t,e){let n;const r=e.offset;try{if(!t.meta)switch(t.kind=e.readInt(),t.kind){case a.resultKind.voidResult:n={header:t.header,flags:t.flagsInfo};break;case a.resultKind.rows:t.meta=e.readMetadata(t.kind);break;case a.resultKind.setKeyspace:n={header:t.header,keyspaceSet:e.readString(),flags:t.flagsInfo};break;case a.resultKind.prepared:{const r=c.copyBuffer(e.readShortBytes());t.meta=e.readMetadata(t.kind),n={header:t.header,id:r,meta:t.meta,flags:t.flagsInfo};break}case a.resultKind.schemaChange:n={header:t.header,schemaChange:e.parseSchemaChange(),flags:t.flagsInfo};break;default:throw u.DriverInternalError("Unexpected result kind: "+t.kind)}}catch(n){return this.handleParsingError(n,t,e,r)}if(n){if(t.emitted)return;return t.emitted=!0,this.push(n)}e.remainingLength()>0&&this.parseRows(t,e)},f.prototype.parseRows=function(t,e){if(t.parsingError)return;if(void 0===t.rowLength)try{t.rowLength=e.readInt()}catch(n){return this.handleParsingError(n,t,e)}if(0===t.rowLength)return this.push({header:t.header,result:{rows:c.emptyArray,meta:t.meta,flags:t.flagsInfo}});const n=t.meta;t.rowIndex=t.rowIndex||0;for(let r=t.rowIndex;r<t.rowLength;r++){const o=e.offset,i=new a.Row(n.columns);let s;for(let a=0;a<n.columns.length;a++){const c=n.columns[a];try{s=e.readBytes()}catch(n){return this.handleParsingError(n,t,e,o,r)}try{i[c.name]=this.encoder.decode(s,c.type)}catch(e){return this.handleParsingError(e,t,null)}}this.push({header:t.header,row:i,meta:t.meta,byRow:t.byRow,length:t.rowLength,flags:t.flagsInfo})}},f.prototype.setOptions=function(t,e){if(this.frames[t.toString()])throw new a.DriverError("There was already state for this frame");this.frames[t.toString()]=e},f.prototype.frameState=function(t){let e=this.frames[t.header.streamId];return e?t.frameEnded&&delete this.frames[t.header.streamId]:(e={},t.frameEnded||(this.frames[t.header.streamId]=e)),e.header=t.header,e},f.prototype.handleParsingError=function(t,e,n,r,o){if(n&&e.isStreaming&&t instanceof RangeError)return this.bufferResultCell(e,n,r,o,t.expectedLength);e.parsingError=!0,e.cellBuffer=null,this.push({header:e.header,error:t})},f.prototype.bufferResultCell=function(t,e,n,r,o){n||0===n||(n=e.offset),t.rowIndex=r;const i=e.slice(n);t.cellBuffer={parts:[i],byteLength:i.length,expectedLength:o}},r.inherits(d,s),d.prototype._write=function(t,e,n){let r=null;try{this.each(t)}catch(t){r=t}n(r)},d.prototype.each=function(t){return t.error||t.result?this.emit("result",t.header,t.error,t.result):t.frameEnded?this.emit("frameEnded",t.header):t.byRow?this.emit("row",t.header,t.row,t.meta,t.length,t.flags):t.row?this.bufferAndEmit(t):t.event?this.emit("nodeEvent",t.header,t.event):this.emit("result",t.header,null,t)},d.prototype.bufferAndEmit=function(t){let e=this.rowBuffer[t.header.streamId];e||(e=this.rowBuffer[t.header.streamId]=[]),e.push(t.row),e.length===t.length&&(this.emit("result",t.header,null,{rows:e,meta:t.meta,flags:t.flags}),delete this.rowBuffer[t.header.streamId])},e.Protocol=p,e.Parser=f,e.ResultEmitter=d},function(t,e,n){"use strict";const r=n(0),o=n(1),i=n(2),s=n(3),a=1,c=2;function u(t,e,n){this.header=t,this.opcode=t.opcode,this.offset=n||0,this.buf=e}u.prototype.remainingLength=function(){return this.buf.length-this.offset},u.prototype.getBuffer=function(){return this.buf},u.prototype.slice=function(t,e){return void 0===e&&(e=this.buf.length),this.buf.slice(t,e)},u.prototype.unshift=function(t){if(this.offset>0)throw new Error("Can not modify the underlying buffer if already read");this.buf=Buffer.concat([t,this.buf],t.length+this.buf.length)},u.prototype.read=function(t){let e=this.buf.length;void 0!==t&&this.offset+t<this.buf.length&&(e=this.offset+t);const n=this.slice(this.offset,e);return this.offset=e,n},u.prototype.toEnd=function(){this.offset=this.buf.length},u.prototype.readInt=function(){const t=this.buf.readInt32BE(this.offset);return this.offset+=4,t},u.prototype.readShort=function(){const t=this.buf.readUInt16BE(this.offset);return this.offset+=2,t},u.prototype.readByte=function(){const t=this.buf.readUInt8(this.offset);return this.offset+=1,t},u.prototype.readString=function(){const t=this.readShort();this.checkOffset(t);const e=this.buf.toString("utf8",this.offset,this.offset+t);return this.offset+=t,e},u.prototype.checkOffset=function(t){if(this.offset+t>this.buf.length){const e=new RangeError("Trying to access beyond buffer length");throw e.expectedLength=t,e}},u.prototype.readStringList=function(){const t=this.readShort(),e=new Array(t);for(let n=0;n<t;n++)e[n]=this.readString();return e},u.prototype.readBytes=function(){const t=this.readInt();return t<0?null:(this.checkOffset(t),this.read(t))},u.prototype.readShortBytes=function(){const t=this.readShort();return t<0?null:(this.checkOffset(t),this.read(t))},u.prototype.readBytesMap=function(){const t=this.readShort();if(t<0)return null;const e={};for(let n=0;n<t;n++)e[this.readString()]=this.readBytes();return e},u.prototype.readType=function(){let t;const e={code:this.readShort(),type:null};switch(e.code){case i.dataTypes.custom:e.info=this.readString();break;case i.dataTypes.list:case i.dataTypes.set:e.info=this.readType();break;case i.dataTypes.map:e.info=[this.readType(),this.readType()];break;case i.dataTypes.udt:for(e.info={keyspace:this.readString(),name:this.readString(),fields:new Array(this.readShort())},t=0;t<e.info.fields.length;t++)e.info.fields[t]={name:this.readString(),type:this.readType()};break;case i.dataTypes.tuple:for(e.info=new Array(this.readShort()),t=0;t<e.info.length;t++)e.info[t]=this.readType()}return e},u.prototype.readInet=function(){const t=this.readByte(),e=this.read(t);return{address:new i.InetAddress(e),port:this.readInt()}},u.prototype.readFlagsInfo=function(){if(0===this.header.flags)return o.emptyObject;const t={};return this.header.flags&i.frameFlags.tracing&&(this.checkOffset(16),t.traceId=new i.Uuid(o.copyBuffer(this.read(16)))),this.header.flags&i.frameFlags.warning&&(t.warnings=this.readStringList()),this.header.flags&i.frameFlags.customPayload&&(t.customPayload=this.readBytesMap()),t},u.prototype.readMetadata=function(t){let e;const n=t===i.resultKind.prepared,r={},s=this.readInt(),u=this.readInt();if(i.protocolVersion.supportsPreparedPartitionKey(this.header.version)&&n)for(r.partitionKeys=new Array(this.readInt()),e=0;e<r.partitionKeys.length;e++)r.partitionKeys[e]=this.readShort();for(s&c&&(r.pageState=o.copyBuffer(this.readBytes())),s&a&&(r.global_tables_spec=!0,r.keyspace=this.readString(),r.table=this.readString()),r.columns=new Array(u),r.columnsByName=o.emptyObject,n&&(r.columnsByName={}),e=0;e<u;e++){const t={};r.global_tables_spec||(t.ksname=this.readString(),t.tablename=this.readString()),t.name=this.readString(),t.type=this.readType(),r.columns[e]=t,n&&(r.columnsByName[t.name]=e)}return r};u.prototype.readError=function(){const t=this.readInt(),e=this.readString(),n=new s.ResponseError(t,e);switch(t){case i.responseErrorCodes.unavailableException:n.consistencies=this.readShort(),n.required=this.readInt(),n.alive=this.readInt(),n.message=r.format("Not enough replicas available for query at consistency %s (%d required but only %d alive)",i.consistencyToString[n.consistencies],n.required,n.alive);break;case i.responseErrorCodes.readTimeout:case i.responseErrorCodes.readFailure:if(n.consistencies=this.readShort(),n.received=this.readInt(),n.blockFor=this.readInt(),t===i.responseErrorCodes.readFailure&&(n.failures=this.readInt()),n.isDataPresent=this.readByte(),t===i.responseErrorCodes.readTimeout){let t;t=n.received<n.blockFor?r.format("%d replica(s) responded over %d required",n.received,n.blockFor):n.isDataPresent?"timeout while waiting for repair of inconsistent replica":"the replica queried for the data didn't respond",n.message=r.format("Server timeout during read query at consistency %s (%s)",i.consistencyToString[n.consistencies],t)}else n.message=r.format("Server failure during read query at consistency %s (%d responses were required but only %d replicas responded, %d failed)",i.consistencyToString[n.consistencies],n.blockFor,n.received,n.failures);break;case i.responseErrorCodes.writeTimeout:case i.responseErrorCodes.writeFailure:if(n.consistencies=this.readShort(),n.received=this.readInt(),n.blockFor=this.readInt(),t===i.responseErrorCodes.writeFailure&&(n.failures=this.readInt()),n.writeType=this.readString(),t===i.responseErrorCodes.writeTimeout){const t="BATCH_LOG"===n.writeType?"Server timeout during batchlog write at consistency %s (%d peer(s) acknowledged the write over %d required)":"Server timeout during write query at consistency %s (%d peer(s) acknowledged the write over %d required)";n.message=r.format(t,i.consistencyToString[n.consistencies],n.received,n.blockFor)}else n.message=r.format("Server failure during write query at consistency %s (%d responses were required but only %d replicas responded, %d failed)",i.consistencyToString[n.consistencies],n.blockFor,n.received,n.failures);break;case i.responseErrorCodes.unprepared:n.queryId=o.copyBuffer(this.readShortBytes());break;case i.responseErrorCodes.functionFailure:n.keyspace=this.readString(),n.functionName=this.readString(),n.argTypes=this.readStringList();break;case i.responseErrorCodes.alreadyExists:{n.keyspace=this.readString();const t=this.readString();t.length>0&&(n.table=t);break}}return n},u.prototype.readEvent=function(){const t=this.readString();switch(t){case i.protocolEvents.topologyChange:return{added:"NEW_NODE"===this.readString(),inet:this.readInet(),eventType:t};case i.protocolEvents.statusChange:return{up:"UP"===this.readString(),inet:this.readInet(),eventType:t};case i.protocolEvents.schemaChange:return this.parseSchemaChange()}return{eventType:t}},u.prototype.parseSchemaChange=function(){let t;if(!i.protocolVersion.supportsSchemaChangeFullMetadata(this.header.version))return(t={eventType:i.protocolEvents.schemaChange,schemaChangeType:this.readString(),keyspace:this.readString(),table:this.readString()}).isKeyspace=!t.table,t;switch((t={eventType:i.protocolEvents.schemaChange,schemaChangeType:this.readString(),target:this.readString(),keyspace:this.readString(),table:null,udt:null,signature:null}).isKeyspace="KEYSPACE"===t.target,t.target){case"TABLE":t.table=this.readString();break;case"TYPE":t.udt=this.readString();break;case"FUNCTION":t.functionName=this.readString(),t.signature=this.readStringList();break;case"AGGREGATE":t.aggregate=this.readString(),t.signature=this.readStringList()}return t},e.FrameReader=u},function(t,e,n){"use strict";const r=n(2),o=128,i=7,s=4,a=256;let c=5e3;function u(t){const e=new Array(o),n=t+o-1;for(let t=0;t<o;t++)e[t]=n-t;return e}t.exports=class{constructor(t){this.currentGroup=u(0),this.groupIndex=0,this.groups=[this.currentGroup],this.releaseTimeout=null,this.setVersion(t),this.inUse=0}setVersion(t){this.maxGroups=r.protocolVersion.uses2BytesStreamIds(t)?a:1}pop(){let t=this.currentGroup.pop();if(void 0!==t)return this.inUse++,t;for(;this.groupIndex<this.groups.length-1;)if(this.currentGroup=this.groups[++this.groupIndex],void 0!==(t=this.currentGroup.pop()))return this.inUse++,t;return this._tryCreateGroup()}push(t){this.inUse--;const e=t>>i,n=this.groups[e];n.push(t),e<this.groupIndex&&(this.groupIndex=e,this.currentGroup=n),this._tryIssueRelease()}clear(){this.releaseTimeout&&(clearTimeout(this.releaseTimeout),this.releaseTimeout=null)}_tryCreateGroup(){return this.groups.length===this.maxGroups?null:(this.groupIndex=this.groups.length,this.currentGroup=u(this.groupIndex<<i),this.groups.push(this.currentGroup),this.inUse++,this.currentGroup.pop())}_tryIssueRelease(){if(this.releaseTimeout||this.groups.length<=s)return;const t=this;this.releaseTimeout=setTimeout(()=>t._releaseGroups(),c)}_releaseGroups(){let t=0,e=this.groups.length-1;for(;t++<s&&this.groups.length>s&&e>this.groupIndex&&this.groups[e].length===o;)this.groups.pop(),e--;this.releaseTimeout=null,this._tryIssueRelease()}}},function(t,e,n){"use strict";const r=n(0),o=n(1),i=n(3),s=n(5),a=s.ExecuteRequest,c=s.QueryRequest,u={init:0,completed:1,timedOut:2,cancelled:3};t.exports=class{constructor(t,e,n){this.request=t,this._options=e,this._rowCallback=e&&e.rowCallback,this._callback=n,this._timeout=null,this._state=u.init,this._rowIndex=0,this.streamId=-1}cancel(){this._state===u.init&&(null!==this._timeout&&clearTimeout(this._timeout),this._state=u.cancelled,this._callback=o.noop)}canBeWritten(){return this._state===u.init}isByRow(){return this._rowCallback&&(this.request instanceof a||this.request instanceof c)}setRequestTimeout(t,e,n,o){if(this._state!==u.init)return;const s=this._options&&void 0!==this._options.readTimeout?this._options.readTimeout:t;if(!(s>0))return;const a=this;this._timeout=setTimeout(function(){n();const t=r.format("The host %s did not reply before timeout %d ms",e,s);a._markAsTimedOut(new i.OperationTimedOutError(t),o)},s)}setResultRow(t,e,n,r){if(this._markAsCompleted(),!this._rowCallback)return this.setResult(new i.DriverInternalError("RowCallback not found for streaming frame handler"));this._rowCallback(this._rowIndex++,t,n),this._rowIndex===n&&this._swapCallbackAndInvoke(null,{rowLength:n,meta:e,flags:r})}_markAsTimedOut(t,e){this._state===u.init&&(this._state=u.timedOut,this._swapCallbackAndInvoke(t,null,e))}_markAsCompleted(){this._state===u.init&&(null!==this._timeout&&clearTimeout(this._timeout),this._state=u.completed)}setResult(t,e){this._markAsCompleted(),this._swapCallbackAndInvoke(t,e)}_swapCallbackAndInvoke(t,e,n){const r=this._callback;this._callback=n||o.noop,r(t,e)}}},function(t,e,n){"use strict";const r=n(0),o=n(3),i=n(5),s=n(16),a=n(2),c=n(1),u=Object.freeze({decision:s.RetryPolicy.retryDecision.retry,useCurrentHost:!1,consistency:void 0});t.exports=class{constructor(t){this._parent=t,this._operation=null,this._host=null,this._cancelled=!1,this._retryCount=0,this._request=this._parent.request}start(t){const e=this;t=t||c.noop,this._parent.getNextConnection(function(n,r,o){if(!e._cancelled){if(n)return e._parent.handleNoHostAvailable(n,e);e._connection=r,e._host=o,t(o),0===e._retryCount&&e._parent.speculativeExecutions++,e._sendOnConnection()}})}_sendOnConnection(){const t=this;this._operation=this._connection.sendStream(this._request,this._parent.requestOptions,function(e,n){if(t._cancelled)return;if(e)return t._handleError(e);const r=t._getResultSet(n);if(n.schemaChange)return t._parent.client.handleSchemaAgreementAndRefresh(t._connection,n.schemaChange,function(){t._cancelled||t._parent.setCompleted(null,r)});n.keyspaceSet&&(t._parent.client.keyspace=n.keyspaceSet),t._parent.setCompleted(null,r)})}_getResultSet(t){return new a.ResultSet(t,this._host.address,this._parent.triedHosts,this._parent.speculativeExecutions,this._request.consistency)}cancel(){this._cancelled=!0,null!==this._operation&&this._operation.cancel()}wasCancelled(){return this._cancelled}_handleError(t){if(this._parent.triedHosts[this._host.address]=t,t.coordinator=this._host.address,t.code===a.responseErrorCodes.unprepared&&t instanceof o.ResponseError)return this._prepareAndRetry(t.queryId);const e=this._getDecision(t);return t.isSocketError&&this._host.removeFromPool(this._connection),e&&e.decision!==s.RetryPolicy.retryDecision.rethrow?e.decision===s.RetryPolicy.retryDecision.ignore?this._parent.setCompleted(null,this._getResultSet(c.emptyObject)):this._retry(e.consistency,e.useCurrentHost):((this._request instanceof i.QueryRequest||this._request instanceof i.ExecuteRequest)&&(t.query=this._request.query),this._parent.setCompleted(t))}_getDecision(t){const e={query:this._request&&this._request.query,options:this._parent.requestOptions,nbRetry:this._retryCount,handler:this,request:this._request,retryOnTimeout:!1},n=this;function r(){return n._parent.retryPolicy.onRequestError(e,n._request.consistency,t)}if(t.isSocketError)return t.requestNotWritten?u:r();if(t instanceof o.OperationTimedOutError)return this._parent.log("warning",t.message),this._host.checkHealth(this._connection),e.retryOnTimeout=!1!==this._parent.requestOptions.retryOnTimeout,r();if(t instanceof o.ResponseError)switch(t.code){case a.responseErrorCodes.overloaded:case a.responseErrorCodes.isBootstrapping:case a.responseErrorCodes.truncateError:return r();case a.responseErrorCodes.unavailableException:return this._parent.retryPolicy.onUnavailable(e,t.consistencies,t.required,t.alive);case a.responseErrorCodes.readTimeout:return this._parent.retryPolicy.onReadTimeout(e,t.consistencies,t.received,t.blockFor,t.isDataPresent);case a.responseErrorCodes.writeTimeout:return this._parent.retryPolicy.onWriteTimeout(e,t.consistencies,t.received,t.blockFor,t.writeType)}return{decision:s.RetryPolicy.retryDecision.rethrow}}_retry(t,e){if(!this._cancelled){if(this._parent.log("info","Retrying request"),this._retryCount++,"number"==typeof t&&this._request.consistency!==t&&(this._request=this._request.clone(),this._request.consistency=t),!1!==e)return this._sendOnConnection();this.start()}}_prepareAndRetry(t){this._parent.log("info",r.format("Query 0x%s not prepared on host %s, preparing and retrying",t.toString("hex"),this._host.address));const e=this._parent.client.metadata.getPreparedById(t);if(!e)return this._parent.setCompleted(new o.DriverInternalError(r.format("Unprepared response invalid, id: %s",t.toString("hex"))));if(e.keyspace&&e.keyspace!==this._connection.keyspace)return this._parent.setCompleted(new Error(r.format("Query was prepared on keyspace %s, can't execute it on %s (%s)",e.keyspace,this._connection.keyspace,e.query)));const n=this;this._connection.prepareOnce(e.query,function(t){if(t)return!t.isSocketError&&t instanceof o.OperationTimedOutError&&n._parent.log("warning",r.format("Unexpected error when re-preparing query on host %s")),n._retry(void 0,!1);n._retry(void 0,!0)})}}},function(t,e,n){"use strict";const r=n(0),o=n(2),i=n(7),s=n(1),a=n(22),c=o.Integer,u=new a(21461,4418,31633,34755),h=new a(37759,10053,44355,19701),l=a.fromNumber(5),p=new a(36045,60757,45015,65361),f=new a(60499,6789,47614,50382),d=a.fromNumber(1390208809),m=a.fromNumber(944331445);class g{constructor(){}hash(t){throw new Error("You must implement a hash function for the tokenizer")}parse(t){throw new Error("You must implement a parse function for the tokenizer")}minToken(){throw new Error("You must implement a minToken function for the tokenizer")}split(t,e,n){throw new Error("You must implement a split function for the tokenizer")}splitBase(t,e,n,r,o){const i=c.fromInt(o),s=e.divide(i);let a=e.modulo(i);const u=[];let h=t;const l=s.add(c.ONE);for(let t=1;t<o;t++)h=a.greaterThan(c.ZERO)?h.add(l):h.add(s),r&&h.greaterThan(n)&&(h=h.subtract(r)),u.push(h),a=a.subtract(c.ONE);return u}stringify(t){return t.getValue().toString()}}function y(t){return t<128?new a(t,0,0,0):new a(t-256&65535,65535,65535,65535)}e.Murmur3Tokenizer=class extends g{constructor(){super()}hash(t){const e=t;let n=0;const r=e.length,o=r>>4,s=new a,c=new a;let p=new a,f=new a;for(let t=0;t<o;t++)p=this.getBlock(e,n,2*t),f=this.getBlock(e,n,2*t+1),p.multiply(u),this.rotl64(p,31),p.multiply(h),s.xor(p),this.rotl64(s,27),s.add(c),s.multiply(l).add(d),f.multiply(h),this.rotl64(f,33),f.multiply(u),c.xor(f),this.rotl64(c,31),c.add(s),c.multiply(l).add(m);switch(n+=16*o,p=new a,f=new a,15&r){case 15:f.xor(y(e[n+14]).shiftLeft(48));case 14:f.xor(y(e[n+13]).shiftLeft(40));case 13:f.xor(y(e[n+12]).shiftLeft(32));case 12:f.xor(y(e[n+11]).shiftLeft(24));case 11:f.xor(y(e[n+10]).shiftLeft(16));case 10:f.xor(y(e[n+9]).shiftLeft(8));case 9:f.xor(y(e[n+8])),f.multiply(h),this.rotl64(f,33),f.multiply(u),c.xor(f);case 8:p.xor(y(e[n+7]).shiftLeft(56));case 7:p.xor(y(e[n+6]).shiftLeft(48));case 6:p.xor(y(e[n+5]).shiftLeft(40));case 5:p.xor(y(e[n+4]).shiftLeft(32));case 4:p.xor(y(e[n+3]).shiftLeft(24));case 3:p.xor(y(e[n+2]).shiftLeft(16));case 2:p.xor(y(e[n+1]).shiftLeft(8));case 1:p.xor(y(e[n])),p.multiply(u),this.rotl64(p,31),p.multiply(h),s.xor(p)}return s.xor(a.fromNumber(r)),c.xor(a.fromNumber(r)),s.add(c),c.add(s),this.fmix(s),this.fmix(c),s.add(c),new i.Murmur3Token(s)}getBlock(t,e,n){const r=e+(n<<3);return new a(t[r]|t[r+1]<<8,t[r+2]|t[r+3]<<8,t[r+4]|t[r+5]<<8,t[r+6]|t[r+7]<<8)}rotl64(t,e){const n=t.clone().shiftLeft(e);t.shiftRightUnsigned(64-e).or(n)}fmix(t){t.xor(new a(t.getUint16(2)>>>1|t.getUint16(3)<<15&65535,t.getUint16(3)>>>1,0,0)),t.multiply(p);const e=new a(t.getUint16(2)>>>1|t.getUint16(3)<<15&65535,t.getUint16(3)>>>1,0,0);t.xor(e),t.multiply(f),t.xor(new a(t.getUint16(2)>>>1|t.getUint16(3)<<15&65535,t.getUint16(3)>>>1,0,0))}parse(t){return new i.Murmur3Token(a.fromString(t))}minToken(){return this._minToken||(this._minToken=this.parse("-9223372036854775808")),this._minToken}maxToken(){return this._maxToken||(this._maxToken=this.parse("9223372036854775807")),this._maxToken}maxValue(){return this._maxValue||(this._maxValue=c.fromString("9223372036854775807")),this._maxValue}minValue(){return this._minValue||(this._minValue=c.fromString("-9223372036854775808")),this._minValue}ringLength(){return this._ringLength||(this._ringLength=this.maxValue().subtract(this.minValue())),this._ringLength}split(t,e,n){t.equals(e)&&t.equals(this.minToken())&&(e=this.maxToken());const r=c.fromString(t.getValue().toString());let o=c.fromString(e.getValue().toString()).subtract(r);return o.isNegative()&&(o=o.add(this.ringLength())),this.splitBase(r,o,this.maxValue(),this.ringLength(),n).map(t=>this.parse(t.toString()))}stringify(t){const e=t.getValue();return e.getUint16(0)+","+e.getUint16(1)+","+e.getUint16(2)+","+e.getUint16(3)}},e.RandomTokenizer=class extends g{constructor(){super(),this._crypto=n(9)}hash(t){r.isArray(t)&&(t=s.allocBufferFromArray(t));const e=this._crypto.createHash("md5").update(t).digest();return new i.RandomToken(c.fromBuffer(e).abs())}parse(t){return new i.RandomToken(c.fromString(t))}minToken(){return this._minToken||(this._minToken=this.parse("-1")),this._minToken}maxValue(){return this._maxValue||(this._maxValue=c.fromNumber(Math.pow(2,127))),this._maxValue}maxToken(){return this._maxToken||(this._maxToken=new i.RandomToken(this.maxValue())),this._maxToken}ringLength(){return this._ringLength||(this._ringLength=this.maxValue().add(c.ONE)),this._ringLength}split(t,e,n){t.equals(e)&&t.equals(this.minToken())&&(e=this.maxToken());const r=t.getValue();let o=e.getValue().subtract(r);return o.lessThan(c.ZERO)&&(o=o.add(this.ringLength())),this.splitBase(r,o,this.maxValue(),this.ringLength(),n).map(t=>new i.RandomToken(t))}},e.ByteOrderedTokenizer=class extends g{constructor(){super()}hash(t){r.isArray(t)&&(t=s.allocBufferFromArray(t));let e=t.length;for(let n=t.length-1;n>0&&0===t[n];n--)e=n;return new i.ByteOrderedToken(t.slice(0,e))}stringify(t){return t.getValue().toString("hex")}parse(t){return this.hash(s.allocBufferFromString(t,"hex"))}minToken(){return this._minToken||(this._minToken=this.hash([])),this._minToken}_toNumber(t,e){let n=t;t.length!==e&&(n=Buffer.alloc(e),t.copy(n));const r=new Array(Math.ceil(n.length/4));for(let t=0;t<r.length;t++){let e,o=n.length-4*(t+1);if(o<0){o+=4,e=0;for(let t=0;t<o;t++)e|=n[t]<<8*(o-t-1)}else e=n.readInt32BE(o);r[t]=e}return new c(r,0)}_toBuffer(t,e){const n=c.toBuffer(t);if(n.length===e)return n;let r,o;0===n[0]?(r=1,o=n.length-1):(r=0,o=n.length);const i=Buffer.alloc(e);return n.copy(i,e-o,r,o+r),i}split(t,e,n){const r=t.compare(e);if(0===r&&t.equals(this.minToken()))throw new Error("Cannot split whole ring with ordered partitioner");let o,s,a,u,h;const l=c.fromNumber(n);let p=Math.max(t.getValue().length,e.getValue().length);if(r<0){let n=0;for(;o=this._toNumber(t.getValue(),p),a=(s=this._toNumber(e.getValue(),p)).subtract(o),!(4===n||a.compare(l)>=0);)p+=1,n+=1}else{let n=0;for(;o=this._toNumber(t.getValue(),p),s=this._toNumber(e.getValue(),p),h=(u=c.fromNumber(Math.pow(2,8*p))).subtract(c.ONE),a=s.subtract(o).add(u),!(4===n||a.compare(l)>=0);)p+=1,n+=1}return this.splitBase(o,a,h,u,n).map(t=>new i.ByteOrderedToken(this._toBuffer(t,p)))}}},function(t,e,n){"use strict";const r=n(0),o=n(4),i=n(2),s=n(1),a=n(3),c=n(61),u=n(62),h=n(63),l=n(64),p=n(65),f="SELECT * FROM system.schema_columnfamilies WHERE keyspace_name='%s' AND columnfamily_name='%s'",d="SELECT * FROM system_schema.tables WHERE keyspace_name='%s' AND table_name='%s'",m="SELECT * FROM system.schema_columns WHERE keyspace_name='%s' AND columnfamily_name='%s'",g="SELECT * FROM system_schema.columns WHERE keyspace_name='%s' AND table_name='%s'",y="SELECT * FROM system_schema.indexes WHERE keyspace_name='%s' AND table_name='%s'",w="SELECT * FROM system.schema_usertypes WHERE keyspace_name='%s' AND type_name='%s'",_="SELECT * FROM system_schema.types WHERE keyspace_name='%s' AND type_name='%s'",b="SELECT * FROM system.schema_functions WHERE keyspace_name = '%s' AND function_name = '%s'",v="SELECT * FROM system_schema.functions WHERE keyspace_name = '%s' AND function_name = '%s'",E="SELECT * FROM system.schema_aggregates WHERE keyspace_name = '%s' AND aggregate_name = '%s'",T="SELECT * FROM system_schema.aggregates WHERE keyspace_name = '%s' AND aggregate_name = '%s'";function S(t){this.cc=t,this.selectTable=null,this.selectColumns=null,this.selectIndexes=null,this.selectUdt=null,this.selectAggregates=null,this.selectFunctions=null}function k(t){S.call(this,t),this.selectTable=f,this.selectColumns=m,this.selectUdt=w,this.selectAggregates=E,this.selectFunctions=b}function x(t,e){S.call(this,t),this.udtResolver=e,this.selectTable=d,this.selectColumns=g,this.selectUdt=_,this.selectAggregates=T,this.selectFunctions=v,this.selectIndexes=y}function C(t,e,n,r){let o;for(o=0;o<t-e&&o<r.length;o++)n.push(r[o]);return o}function B(t,e,n){const r=Object.keys(t);for(let o=0;o<r.length;o++){const i=r[o],s=e[i];if(!s)continue;const a=Math.min(parseInt(t[i],10),s.hostLength);if(a>0&&(!n[i]||n[i]<a))return!1}return!0}S.prototype._createKeyspace=function(t,e,n,r){const o={name:t,durableWrites:e,strategy:n,strategyOptions:r,tokenToReplica:null,udts:{},tables:{},functions:{},aggregates:{},views:{}};return o.tokenToReplica=function(t,e){if(/SimpleStrategy$/.test(t)){const t=parseInt(e.replication_factor,10);if(t>1)return function(t){return function(e,n,r){const o=n.length,i=Math.min(t,o),s={};for(let t=0;t<o;t++){const e=n[t],a=[r[e]];for(let e=1;e<o&&a.length<i;e++){let i=t+e;i>=o&&(i%=o);const s=r[n[i]];-1===a.indexOf(s)&&a.push(s)}s[e]=a}return s}}(t)}if(/NetworkTopologyStrategy$/.test(t))return function(t){return function(e,n,r,o){const i={},a=n.length;for(let e=0;e<a;e++){const c=n[e],u=[],h={},l={},p=[];for(let i=0;i<a;i++){let c=e+i;c>=a&&(c%=a);const f=r[n[c]];if(-1!==u.indexOf(f))continue;const d=f.datacenter;let m=parseInt(t[d],10);if(!m)continue;m=Math.min(m,o[d].hostLength);let g=h[d]||0;if(g>=m)continue;let y=l[d];if(y||(y=l[d]=new s.HashSet),f.rack&&y.contains(f.rack)&&y.length<o[d].racks.length)p.length<m-g&&p.push(f);else if(h[f.datacenter]=++g,u.push(f),f.rack&&y.add(f.rack)&&y.length===o[d].racks.length&&(h[d]+=C(m,g,u,p)),B(t,o,h))break}i[c]=u}return i}}(e);return function(t,e,n){const r={};for(const t in n)n.hasOwnProperty(t)&&(r[t]=[n[t]]);return r}}(n,r),o},S.prototype.getKeyspace=function(t,e){},S.prototype.getKeyspaces=function(t,e){},S.prototype.getTable=function(t,e,n,o){let i,a,u,h=n&&n[e];if(h||(h=new c(e),n&&(n[e]=h)),h.loaded)return o(null,h);if(h.once("load",o),h.loading)return;h.loading=!0;const l=this;s.series([function(n){const o=r.format(l.selectTable,t,e);l.cc.query(o,function(t,e){if(t)return n(t);i=e.rows[0],n()})},function(n){if(!i)return n(null,null,null);const o=r.format(l.selectColumns,t,e);l.cc.query(o,function(t,e){if(t)return n(t);a=e.rows,n()})},function(n){if(!i||!l.selectIndexes)return n();const o=r.format(l.selectIndexes,t,e);l.cc.query(o,function(t,e){if(t)return n(t);u=e.rows,n()})}],function(t){if(t||!i)return h.loading=!1,h.emit("load",t,null);l._parseTableOrView(h,i,a,u,function(t){h.loading=!1,h.loaded=!t,h.emit("load",t,h)})})},S.prototype.getUdt=function(t,e,n,i){let s=n&&n[e];if(s||(s=new o.EventEmitter,n&&(n[e]=s),s.setMaxListeners(0),s.loading=!1,s.name=e,s.fields=null),s.fields)return i(null,s);if(s.once("load",i),s.loading)return;s.loading=!0;const a=r.format(this.selectUdt,t,e),c=this;this.cc.query(a,function(t,e){if(t)return s.emit("load",t);const n=e.rows[0];if(!n)return s.loading=!1,s.emit("load",null,null);c._parseUdt(s,n,function(t){return s.loading=!1,t?s.emit("load",t):s.emit("load",null,s)})})},S.prototype._parseUdt=function(t,e,n){},S.prototype._parseTableOrView=function(t,e,n,r,o){},S.prototype.getMaterializedView=function(t,e,n,r){},S.prototype.getFunctions=function(t,e,n,i,a){let c=this.selectFunctions,u=this._parseFunction.bind(this);n&&(c=this.selectAggregates,u=this._parseAggregate.bind(this));let h=i&&i[e];if(h||(h=new o.EventEmitter,i&&(i[e]=h),h.setMaxListeners(0)),h.values)return a(null,h.values);h.once("load",a),h.loading||(h.loading=!0,c=r.format(c,t,e),this.cc.query(c,function(t,e){if(h.loading=!1,t||0===e.rows.length)return h.emit("load",t,null);e.rows.length>0&&(h.values={}),s.each(e.rows,function(t,e){u(t,function(t,n){if(t)return e(t);h.values["("+n.signature.join(",")+")"]=n,e()})},function(t){if(t)return h.emit("load",t);h.emit("load",null,h.values)})}))},S.prototype._parseAggregate=function(t,e){},S.prototype._parseFunction=function(t,e){},r.inherits(k,S),k.prototype.getKeyspaces=function(t,e){const n=this,r={};this.cc.query("SELECT * FROM system.schema_keyspaces",t,function(t,o){if(t)return e(t);for(let t=0;t<o.rows.length;t++){const e=o.rows[t],i=n._createKeyspace(e.keyspace_name,e.durable_writes,e.strategy_class,JSON.parse(e.strategy_options||null));r[i.name]=i}e(null,r)})},k.prototype.getKeyspace=function(t,e){const n=this;this.cc.query(r.format("SELECT * FROM system.schema_keyspaces where keyspace_name = '%s'",t),function(t,r){if(t)return e(t);const o=r.rows[0];if(!o)return e(null,null);e(null,n._createKeyspace(o.keyspace_name,o.durable_writes,o.strategy_class,JSON.parse(o.strategy_options)))})},k.prototype._parseTableOrView=function(t,e,n,r,o){let i,a,c,u;const h=this.cc.getEncoder(),p={};let f=[],d=[];t.bloomFilterFalsePositiveChance=e.bloom_filter_fp_chance,t.caching=e.caching,t.comment=e.comment,t.compactionClass=e.compaction_strategy_class,t.compactionOptions=JSON.parse(e.compaction_strategy_options),t.compression=JSON.parse(e.compression_parameters),t.gcGraceSeconds=e.gc_grace_seconds,t.localReadRepairChance=e.local_read_repair_chance,t.readRepairChance=e.read_repair_chance,t.populateCacheOnFlush=e.populate_io_cache_on_flush||t.populateCacheOnFlush,t.memtableFlushPeriod=e.memtable_flush_period_in_ms||t.memtableFlushPeriod,t.defaultTtl=e.default_time_to_live||t.defaultTtl,t.speculativeRetry=e.speculative_retry||t.speculativeRetry,t.indexInterval=e.index_interval||t.indexInterval,void 0!==e.min_index_interval?(t.minIndexInterval=e.min_index_interval||t.minIndexInterval,t.maxIndexInterval=e.max_index_interval||t.maxIndexInterval):(t.minIndexInterval=null,t.maxIndexInterval=null),void 0!==e.replicate_on_write&&(t.replicateOnWrite=e.replicate_on_write),t.columns=[];try{!function(){for(i=0;i<n.length;i++){const e=n[i],r=h.parseFqTypeName(e.validator);switch(a={name:e.column_name,type:r},t.columns.push(a),p[a.name]=a,e.type){case"partition_key":f.push({c:a,index:e.component_index||0});break;case"clustering_key":d.push({c:a,index:e.component_index||0,order:a.type.options.reversed?"DESC":"ASC"})}}}(),f.length>0&&(t.partitionKeys=f.sort(s.propCompare("index")).map(function(t){return t.c}),d.sort(s.propCompare("index")),t.clusteringKeys=d.map(function(t){return t.c}),t.clusteringOrder=d.map(function(t){return t.order}));const r=0===t.partitionKeys.length;if(r&&e.key_aliases)for(f=JSON.parse(e.key_aliases),u=h.parseKeyTypes(e.key_validator).types,i=0;i<f.length;i++)c=f[i],(a=p[c])||(a={name:c,type:u[i]},t.columns.push(a)),t.partitionKeys.push(a);const m=h.parseKeyTypes(e.comparator);if(r&&e.column_aliases)for(d=JSON.parse(e.column_aliases),i=0;i<d.length;i++)c=d[i],(a=p[c])||(a={name:c,type:m.types[i]},t.columns.push(a)),t.clusteringKeys.push(a),t.clusteringOrder.push(a.type.options.reversed?"DESC":"ASC");t.isCompact=!!e.is_dense,t.isCompact||(t.isCompact=!m.isComposite||!m.hasCollections&&t.clusteringKeys.length!==m.types.length-1),c=e.value_alias,t.isCompact&&c&&!p[c]&&(a={name:c,type:h.parseFqTypeName(e.default_validator)},t.columns.push(a),p[c]=a),t.columnsByName=p,t.indexes=l.fromColumnRows(n,t.columnsByName)}catch(t){return o(t)}o()},k.prototype.getMaterializedView=function(t,e,n,r){r(new a.NotSupportedError("Materialized views are not supported on Cassandra versions below 3.0"))},k.prototype._parseAggregate=function(t,e){const n=this.cc.getEncoder(),r=new u;r.name=t.aggregate_name,r.keyspaceName=t.keyspace_name,r.signature=t.signature||s.emptyArray,r.stateFunction=t.state_func,r.finalFunction=t.final_func,r.initConditionRaw=t.initcond;try{r.argumentTypes=(t.argument_types||s.emptyArray).map(function(t){return n.parseFqTypeName(t)}),r.stateType=n.parseFqTypeName(t.state_type);const o=n.decode(r.initConditionRaw,r.stateType);null!==o&&void 0!==o&&(r.initCondition=o.toString()),r.returnType=n.parseFqTypeName(t.return_type)}catch(t){return e(t)}e(null,r)},k.prototype._parseFunction=function(t,e){const n=this.cc.getEncoder(),r=new h;r.name=t.function_name,r.keyspaceName=t.keyspace_name,r.signature=t.signature||s.emptyArray,r.argumentNames=t.argument_names||s.emptyArray,r.body=t.body,r.calledOnNullInput=t.called_on_null_input,r.language=t.language;try{r.argumentTypes=(t.argument_types||s.emptyArray).map(function(t){return n.parseFqTypeName(t)}),r.returnType=n.parseFqTypeName(t.return_type)}catch(t){return e(t)}e(null,r)},k.prototype._parseUdt=function(t,e,n){const r=this.cc.getEncoder(),o=e.field_names,i=e.field_types,s=new Array(o.length);try{for(let t=0;t<o.length;t++)s[t]={name:o[t],type:r.parseFqTypeName(i[t])}}catch(t){return n(t)}t.fields=s,n(null,t)},r.inherits(x,S),x.prototype.getKeyspaces=function(t,e){const n=this,r={};this.cc.query("SELECT * FROM system_schema.keyspaces",t,function(t,o){if(t)return e(t);for(let t=0;t<o.rows.length;t++){const e=n._parseKeyspace(o.rows[t]);r[e.name]=e}e(null,r)})},x.prototype.getKeyspace=function(t,e){const n=this;this.cc.query(r.format("SELECT * FROM system_schema.keyspaces where keyspace_name = '%s'",t),function(t,r){if(t)return e(t);const o=r.rows[0];if(!o)return e(null,null);e(null,n._parseKeyspace(o))})},x.prototype.getMaterializedView=function(t,e,n,o){let i,a,c=n&&n[e];if(c||(c=new p(e),n&&(n[e]=c)),c.loaded)return o(null,c);if(c.once("load",o),c.loading)return;c.loading=!0;const u=this;s.series([function(n){const o=r.format("SELECT * FROM system_schema.views WHERE keyspace_name = '%s' AND view_name = '%s'",t,e);u.cc.query(o,function(t,e){if(t)return n(t);i=e.rows[0],n()})},function(n){if(!i)return n();const o=r.format(u.selectColumns,t,e);u.cc.query(o,function(t,e){if(t)return n(t);a=e.rows,n()})}],function(t){if(c.loading=!1,t||!i)return c.emit("load",t,null);u._parseTableOrView(c,i,a,null,function(t){c.loading=!1,c.loaded=!t,c.emit("load",t,c)})})},x.prototype._parseKeyspace=function(t){const e=t.replication;let n,r;if(e){n=e.class,r={};for(const t in e)e.hasOwnProperty(t)&&"class"!==t&&(r[t]=e[t])}return this._createKeyspace(t.keyspace_name,t.durable_writes,n,r)},x.prototype._parseTableOrView=function(t,e,n,r,o){const a=this.cc.getEncoder(),c={},u=[],h=[],f=t instanceof p;t.bloomFilterFalsePositiveChance=e.bloom_filter_fp_chance,t.caching=JSON.stringify(e.caching),t.comment=e.comment;const d=e.compaction;if(d){t.compactionOptions={},t.compactionClass=d.class;for(const e in d)d.hasOwnProperty(e)&&"class"!==e&&(t.compactionOptions[e]=d[e])}if(t.compression=e.compression,t.gcGraceSeconds=e.gc_grace_seconds,t.localReadRepairChance=e.dclocal_read_repair_chance,t.readRepairChance=e.read_repair_chance,t.extensions=e.extensions,t.crcCheckChance=e.crc_check_chance,t.memtableFlushPeriod=e.memtable_flush_period_in_ms||t.memtableFlushPeriod,t.defaultTtl=e.default_time_to_live||t.defaultTtl,t.speculativeRetry=e.speculative_retry||t.speculativeRetry,t.minIndexInterval=e.min_index_interval||t.minIndexInterval,t.maxIndexInterval=e.max_index_interval||t.maxIndexInterval,!f){const n=e.cdc;void 0!==n&&(t.cdc=n)}const m=this;s.map(n,function(t,n){a.parseTypeName(e.keyspace_name,t.type,0,null,m.udtResolver,function(e,r){if(e)return n(e);const o={name:t.column_name,type:r,isStatic:!1};switch(c[o.name]=o,t.kind){case"partition_key":u.push({c:o,index:t.position||0});break;case"clustering":h.push({c:o,index:t.position||0,order:"desc"===t.clustering_order?"DESC":"ASC"});break;case"static":o.isStatic=!0}n(null,o)})},function(n,a){if(n)return o(n);if(t.columns=a,t.columnsByName=c,t.partitionKeys=u.sort(s.propCompare("index")).map(function(t){return t.c}),h.sort(s.propCompare("index")),t.clusteringKeys=h.map(function(t){return t.c}),t.clusteringOrder=h.map(function(t){return t.order}),f)return t.tableName=e.base_table_name,t.whereClause=e.where_clause,t.includeAllColumns=e.include_all_columns,o();t.indexes=l.fromRows(r);const p=e.flags,d=p.indexOf("dense")>=0,m=p.indexOf("super")>=0,g=p.indexOf("compound")>=0;t.isCompact=m||d||!g,!m&&!d&&!g?function(t){let e,n;for(e=0;e<t.clusteringKeys.length;e++){n=t.clusteringKeys[e];const r=t.columns.indexOf(n);t.columns.splice(r,1),delete t.columnsByName[n.name]}t.clusteringKeys=s.emptyArray,t.clusteringOrder=s.emptyArray,e=t.columns.length;for(;e--;)(n=t.columns[e]).isStatic||-1!==t.partitionKeys.indexOf(n)?n.isStatic=!1:(t.columns.splice(e,1),delete t.columnsByName[n.name])}(t):d&&function(t){let e=t.columns.length;for(;e--;){const n=t.columns[e];n.isStatic||n.type.code!==i.dataTypes.custom||"empty"!==n.type.info?n.isStatic=!1:(t.columns.splice(e,1),delete t.columnsByName[n.name])}}(t),o()})},x.prototype._parseAggregate=function(t,e){const n=this.cc.getEncoder(),r=new u;r.name=t.aggregate_name,r.keyspaceName=t.keyspace_name,r.signature=t.argument_types||s.emptyArray,r.stateFunction=t.state_func,r.finalFunction=t.final_func,r.initConditionRaw=t.initcond,r.initCondition=r.initConditionRaw;const o=this;s.series([function(e){s.map(t.argument_types||s.emptyArray,function(e,r){n.parseTypeName(t.keyspace_name,e,0,null,o.udtResolver,r)},function(t,n){r.argumentTypes=n,e(t)})},function(e){n.parseTypeName(t.keyspace_name,t.state_type,0,null,o.udtResolver,function(t,n){r.stateType=n,e(t)})},function(e){n.parseTypeName(t.keyspace_name,t.return_type,0,null,o.udtResolver,function(t,n){r.returnType=n,e(t)})}],function(t){if(t)return e(t);e(null,r)})},x.prototype._parseFunction=function(t,e){const n=this.cc.getEncoder(),r=new h;r.name=t.function_name,r.keyspaceName=t.keyspace_name,r.signature=t.argument_types||s.emptyArray,r.argumentNames=t.argument_names||s.emptyArray,r.body=t.body,r.calledOnNullInput=t.called_on_null_input,r.language=t.language;const o=this;s.series([function(e){s.map(t.argument_types||s.emptyArray,function(e,r){n.parseTypeName(t.keyspace_name,e,0,null,o.udtResolver,r)},function(t,n){r.argumentTypes=n,e(t)})},function(e){n.parseTypeName(t.keyspace_name,t.return_type,0,null,o.udtResolver,function(t,n){r.returnType=n,e(t)})}],function(t){if(t)return e(t);e(null,r)})},x.prototype._parseUdt=function(t,e,n){const r=this.cc.getEncoder(),o=e.field_types,i=e.keyspace_name,a=new Array(o.length),c=this;s.forEachOf(e.field_names,function(t,e,n){r.parseTypeName(i,o[e],0,null,c.udtResolver,function(r,o){if(r)return n(r);a[e]={name:t,type:o},n()})},function(e){if(e)return n(e);t.fields=a,n(null,t)})},e.getByVersion=function(t,e,n,r){let o=k;return n&&n[0]>=3&&(o=x),r&&r instanceof o?r:new o(t,e)}},function(t,e,n){"use strict";const r=n(0),o=n(26);function i(t){o.call(this,t),this.replicateOnWrite=!0,this.memtableFlushPeriod=0,this.indexInterval=null,this.isCompact=!1,this.indexes=null,this.cdc=null}r.inherits(i,o),t.exports=i},function(t,e,n){"use strict";t.exports=function(){this.name=null,this.keyspaceName=null,this.signature=null,this.argumentTypes=null,this.stateFunction=null,this.stateType=null,this.finalFunction=null,this.initConditionRaw=null,this.initCondition=null,this.returnType=null}},function(t,e,n){"use strict";t.exports=function(){this.name=null,this.keyspaceName=null,this.signature=null,this.argumentNames=null,this.argumentTypes=null,this.body=null,this.calledOnNullInput=null,this.language=null,this.returnType=null}},function(t,e,n){"use strict";const r=n(0),o=n(1),i=n(2),s={custom:0,keys:1,composites:2};function a(t,e,n,r){this.name=t,this.target=e,this.kind=n,this.options=r}function c(t){return t?s[t.toLowerCase()]:s.custom}a.prototype.isCompositesKind=function(){return this.kind===s.composites},a.prototype.isKeysKind=function(){return this.kind===s.keys},a.prototype.isCustomKind=function(){return this.kind===s.custom},a.fromRows=function(t){return t&&0!==t.length?t.map(function(t){const e=t.options;return new a(t.index_name,e.target,c(t.kind),e)}):o.emptyArray},a.fromColumnRows=function(t,e){const n=[];for(let o=0;o<t.length;o++){const s=t[o],u=s.index_name;if(!u)continue;const h=e[s.column_name];let l;const p=JSON.parse(s.index_options);l=null!==p&&void 0!==p.index_keys?r.format("keys(%s)",h.name):null!==p&&void 0!==p.index_keys_and_values?r.format("entries(%s)",h.name):!h.type.options.frozen||h.type.code!==i.dataTypes.map&&h.type.code!==i.dataTypes.list&&h.type.code!==i.dataTypes.set?h.name:r.format("full(%s)",h.name),n.push(new a(u,l,c(s.index_type),p))}return n},t.exports=a},function(t,e,n){"use strict";const r=n(0),o=n(26);function i(t){o.call(this,t),this.tableName=null,this.whereClause=null,this.includeAllColumns=!1}r.inherits(i,o),t.exports=i},function(t,e,n){"use strict";const r=n(0),o=n(1);function i(t,e){this._delay=t,this._logger=e,this._queue=null,this._timeout=null}i.prototype.eventReceived=function(t,e){t.callback=t.callback||o.noop,this._queue=this._queue||{callbacks:[],keyspaces:{}};const n=e?0:this._delay;if(t.all&&(this._queue.mainEvent=t),1e3===this._queue.callbacks.length&&this._logger("warn",r.format("Event debouncer queue exceeded %d events",1e3)),this._queue.callbacks.push(t.callback),this._queue.mainEvent)return this._slideDelay(n);let i=this._queue.keyspaces[t.keyspace];i||(i=this._queue.keyspaces[t.keyspace]={events:[]}),void 0===t.cqlObject&&(i.mainEvent=t),i.events.push(t),this._slideDelay(n)},i.prototype._slideDelay=function(t){const e=this;function n(){const t=e._queue;e._queue=null,e._timeout=null,function(t){if(t.mainEvent)return t.mainEvent.handler(function(e){for(let n=0;n<t.callbacks.length;n++)t.callbacks[n](e)});o.each(Object.keys(t.keyspaces),function(e,n){const r=t.keyspaces[e];if(r.mainEvent)return r.mainEvent.handler(function(t){for(let e=0;e<r.events.length;e++)r.events[e].callback(t);n()});r.events.forEach(function(t){t.handler(),t.callback()}),n()})}(t)}if(0===t)return this._timeout&&clearTimeout(this._timeout),n();const r=this._timeout;this._timeout=setTimeout(n,t),r&&clearTimeout(r)},i.prototype.shutdown=function(){this._queue&&(this._queue.callbacks.forEach(function(t){t()}),this._queue=null,clearTimeout(this._timeout),this._timeout=null)},t.exports=i},function(t,e,n){"use strict";const r=n(27);e.AuthProvider=r.AuthProvider,e.Authenticator=r.Authenticator,e.PlainTextAuthProvider=n(68)},function(t,e,n){"use strict";const r=n(0),o=n(27),i=n(1),s=o.AuthProvider,a=o.Authenticator;function c(t,e){this.username=t,this.password=e}function u(t,e){this.username=t,this.password=e}r.inherits(c,s),c.prototype.newAuthenticator=function(){return new u(this.username,this.password)},r.inherits(u,a),u.prototype.initialResponse=function(t){t(null,Buffer.concat([i.allocBufferFromArray([0]),i.allocBufferFromString(this.username,"utf8"),i.allocBufferFromArray([0]),i.allocBufferFromString(this.password,"utf8")]))},u.prototype.evaluateChallenge=function(t,e){e()},t.exports=c}]);