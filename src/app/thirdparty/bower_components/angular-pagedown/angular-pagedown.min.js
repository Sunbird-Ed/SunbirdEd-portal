var mdExtraOptions={extensions:"all",table_class:"table"};angular.module("ui.pagedown",[]).directive("pagedownEditor",["$compile","$timeout","$window","$q",function(n,e,t,i){var o=0,r=Markdown.getSanitizingConverter();return Markdown.Extra.init(r,mdExtraOptions),r.hooks.chain("preBlockGamut",function(n,e){return n.replace(/^ {0,3}""" *\n((?:.*?\n)+?) {0,3}""" *$/gm,function(n,t){return"<blockquote>"+e(t)+"</blockquote>\n"})}),{restrict:"E",scope:{content:"=",placeholder:"@",showPreview:"@",help:"&",insertImage:"&",editorClass:"=?",editorRows:"@",previewClass:"=?",previewContent:"=?"},link:function(a,s,l){var d;d=null==l.id?o++:l.id;var c="false"==a.showPreview?"display: none;":"",u=l.placeholder||"",w=l.editorRows||"10",p=n('<div><div class="wmd-panel"><div id="wmd-button-bar-'+d+'"></div><textarea id="wmd-input-'+d+'" placeholder="'+u+'" ng-model="content" rows="'+w+'" '+(a.editorClass?'ng-class="editorClass"':'class="wmd-input"')+'></textarea></div><div id="wmd-preview-'+d+'" style="'+c+'" '+(a.previewClass?'ng-class="previewClass"':'class="wmd-panel wmd-preview"')+"></div></div>")(a);s.append(p);var v=angular.isFunction(a.help)?a.help:function(){t.open("http://daringfireball.net/projects/markdown/syntax","_blank")},m=new Markdown.Editor(r,"-"+d,{handler:v});r.hooks.chain("postConversion",function(n){return a.previewContent=n,n});var h=angular.element(document.getElementById("wmd-input-"+d));"false"!=a.showPreview&&a.$watch("content",function(){m.refreshPreview()}),m.hooks.chain("onPreviewRefresh",function(){e(function(){a.content=h.val()})}),angular.isFunction(a.insertImage)&&m.hooks.set("insertImageDialog",function(n){var t=a.insertImage();return e(function(){t?i.when(t).then(function(e){n(e)},function(){n(null)}):n(null)}),!0}),m.run()}}}]).directive("pagedownViewer",["$compile","$sce",function(n,e){var t=Markdown.getSanitizingConverter();return Markdown.Extra.init(t,mdExtraOptions),{restrict:"E",scope:{content:"="},link:function(i,o){var r=function(){return i.content?void(i.sanitizedContent=e.trustAsHtml(t.makeHtml(i.content))):void(i.sanitizedContent="")};i.$watch("content",r),r();var a="<p ng-bind-html='sanitizedContent'></p>",s=n(a)(i);o.append(s)}}}]);